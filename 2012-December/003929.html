<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [X2go-Commits] x2goserver.git - build-main (branch) updated: 4.0.0.0
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/x2go-commits/2012-December/index.html" >
   <LINK REL="made" HREF="mailto:x2go-commits%40lists.berlios.de?Subject=Re%3A%20%5BX2go-Commits%5D%20x2goserver.git%20-%20build-main%20%28branch%29%20updated%3A%204.0.0.0&In-Reply-To=%3C20121230164230.3C6C85DB1A%40ymir%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="003928.html">
   <LINK REL="Next"  HREF="003930.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[X2go-Commits] x2goserver.git - build-main (branch) updated: 4.0.0.0</H1>
    <B>X2Go dev team</B> 
    <A HREF="mailto:x2go-commits%40lists.berlios.de?Subject=Re%3A%20%5BX2go-Commits%5D%20x2goserver.git%20-%20build-main%20%28branch%29%20updated%3A%204.0.0.0&In-Reply-To=%3C20121230164230.3C6C85DB1A%40ymir%3E"
       TITLE="[X2go-Commits] x2goserver.git - build-main (branch) updated: 4.0.0.0">git-admin at x2go.org
       </A><BR>
    <I>Sun Dec 30 17:42:30 CET 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="003928.html">[X2go-Commits] x2goserver.git - release/4.0.0.x (branch) updated:	3.1.1.9-17-g3bb58b5
</A></li>
        <LI>Next message: <A HREF="003930.html">[X2go-Commits] x2goclient.git - build-baikal (branch) created:	4.0.0.0-1-g7f58ba0
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3929">[ date ]</a>
              <a href="thread.html#3929">[ thread ]</a>
              <a href="subject.html#3929">[ subject ]</a>
              <a href="author.html#3929">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>The branch, build-main has been updated
       via  3bb58b5faea060b778de8a35d6f509f42a8a7e0d (commit)
       via  6c61d6eebd840b7fb9561ccdc96d925212b8004a (commit)
       via  258bd118ec2ea9652ed8559b7e0556186c4dd500 (commit)
       via  214bc14b65100bc223042901c96ad2e063891c9c (commit)
       via  d2ce99bd8a74b465711e8a0a775a632282224587 (commit)
       via  355c2a9cdba1acc5e373ae5401b8a6731c48bd6a (commit)
       via  23f6b25d1b586b9f82c17098f87c6b469b46d506 (commit)
       via  6199b60e71cd957a7bf49fbfde82f0bb399d0138 (commit)
       via  d38f6b8b69ee54e504446d8dd63bf78a1439a284 (commit)
       via  54ced06113c3e1d60d279d438ec485bbc040d310 (commit)
       via  961c61c1b70c53dbddea01f6cd6c5716691e3f98 (commit)
       via  a306e368163608e4e8c3f6b7bf462b67654908e4 (commit)
       via  5a0b2cacaf99cefe524fd398b072aecb0710bbd7 (commit)
       via  8292c49e91d6ab71826715e89ee09261e4acf670 (commit)
       via  1fe04071bb1b318dfe43fcbe48e985f554b2fb79 (commit)
       via  75798658a1934df1e9f5038ed140235b356b5f5c (commit)
       via  fccfdb6ad15add7b98e1c11af9f159b943899fa8 (commit)
      from  6d8d5d4779f8da210e0261c0bc7d9721a252c54f (commit)

Those revisions listed above that are new to this repository have
not appeared on any other notification email; so we list those
revisions in full, below.

- Log -----------------------------------------------------------------
-----------------------------------------------------------------------

Summary of changes:
 debian/changelog                                   |   49 ++++++++++++++++----
 debian/x2goserver.init                             |   30 ++++++++----
 x2goserver-compat/VERSION.x2goserver-compat        |    2 +-
 .../share/x2gofeature.d/x2goserver-compat.features |    2 +-
 .../VERSION.x2goserver-extensions                  |    2 +-
 .../bin/x2goserver-run-extensions                  |    4 +-
 .../man/man8/x2goserver-run-extensions.8           |    4 +-
 .../x2gofeature.d/x2goserver-extensions.features   |    2 +-
 .../VERSION.x2goserver-fmbindings                  |    2 +-
 .../x2gofeature.d/x2goserver-fmbindings.features   |    2 +-
 x2goserver-printing/VERSION.x2goserver-printing    |    2 +-
 .../x2gofeature.d/x2goserver-printing.features     |    2 +-
 x2goserver-pyhoca/VERSION.x2goserver-pyhoca        |    2 +-
 .../share/x2gofeature.d/x2goserver-pyhoca.features |    2 +-
 x2goserver-xsession/VERSION.x2goserver-xsession    |    2 +-
 x2goserver-xsession/etc/Xsession                   |    4 +-
 .../x2gofeature.d/x2goserver-xsession.features     |    2 +-
 x2goserver/Makefile                                |    6 ++-
 x2goserver/VERSION.x2goserver                      |    2 +-
 x2goserver/bin/x2gobasepath                        |   31 +------------
 x2goserver/bin/x2gocmdexitmessage                  |    2 +-
 x2goserver/bin/x2gofeature                         |    4 +-
 x2goserver/bin/x2gofeaturelist                     |    4 +-
 x2goserver/bin/x2gomountdirs                       |   13 +++---
 .../bin/x2gofm =&gt; x2goserver/bin/x2gopath          |   32 +++++++++----
 x2goserver/bin/x2goresume-session                  |    2 +-
 x2goserver/bin/x2goruncommand                      |   14 +++---
 x2goserver/bin/x2gosetkeyboard                     |    2 +-
 x2goserver/bin/x2gostartagent                      |   14 ++++--
 x2goserver/bin/x2gosuspend-session                 |    2 +-
 x2goserver/bin/x2goterminate-session               |    2 +-
 x2goserver/bin/x2goversion                         |    2 +-
 x2goserver/etc/x2goagent.options                   |   15 ++++++
 x2goserver/man/man8/x2gopath.8                     |   28 +++++++++++
 x2goserver/sbin/x2gocleansessions                  |    4 +-
 x2goserver/sbin/x2golistsessions_root              |    2 +-
 x2goserver/share/x2gofeature.d/x2goserver.features |    2 +-
 37 files changed, 196 insertions(+), 102 deletions(-)
 copy x2goserver-fmbindings/bin/x2gofm =&gt; x2goserver/bin/x2gopath (57%)
 create mode 100644 x2goserver/etc/x2goagent.options
 create mode 100644 x2goserver/man/man8/x2gopath.8

The diff of changes is:
diff --git a/debian/changelog b/debian/changelog
index 7263072..263eb22 100644
--- a/debian/changelog
+++ b/debian/changelog
@@ -1,3 +1,38 @@
+x2goserver (4.0.0.0-0~x2go1) unstable; urgency=low
+
+  [ Jan Engelhardt ]
+  * New upstream version (4.0.0.0):
+    - Replace script x2gobasepath by script x2gopath that makes it much easier
+      for distro packagers to tweak the installation paths of X2Go Server
+      components.
+
+  [ Mike Gabriel ]
+  * Bump version to 4.0.0.0 (for Baikal bundle release).
+  * New upstream version (4.0.0.0):
+    - Adapt Xinerama path in x2gopath: use $base for detecting the path to the
+      Xinerama libs, as well, as is done with all the other paths.
+    - Fix mounting of multiple paths, thanks to Pascal Vibet. (Fixes: #67).
+
+  [ Orion Poplawski ]
+  * New upstream version (4.0.0.0):
+    - Honour CFLAGS when compiling the server's sgid wrapper script (Fixes: #83).
+
+  [ Oleksandr Shneyder ]
+  * New upstream version (4.0.0.0):
+    - Fix SSHFS mounting from Ubuntu clients.
+    - Create /tmp/.X11-unix if not exists.
+
+  [ Reinhard Tartler ]
+  * New upstream version (4.0.0.0):
+    - Introduce /etc/x2go/x2goagent.options to allow overriding x2goagent
+      options. This new configuration file specifies default options
+      that clients can override.
+    - Disable XFIXES and GLX. Both are known to cause certain
+      problems. Hopefully we find better solutions so that we can reenable
+      them soon.
+
+ -- Mike Gabriel &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/x2go-commits">mike.gabriel at das-netzwerkteam.de</A>&gt;  Sun, 30 Dec 2012 17:39:44 +0100
+
 x2goserver (3.1.1.9-0~x2go1) unstable; urgency=low
 
   * New bugfix release (3.1.1.9):
@@ -36,13 +71,11 @@ x2goserver (3.1.1.5-0~x2go1) unstable; urgency=low
   [ St&#233;phane Graber ]
   * New upstream version (3.1.1.5):
     - Add a very basic SIGCHLD handler to x2gocleansessions. on SIGCHLD
-      let the script wait for cleaning up after its children. (Closes
-      upstream issue #38).
+      let the script wait for cleaning up after its children. (Fixes: #38).
 
   [ Mike Gabriel ]
   * New upstream version (3.1.1.5):
-    - Fix x2gogetapps when rendering multi-section .desktop files. (Closes
-      upstream issue #43).
+    - Fix x2gogetapps when rendering multi-section .desktop files. (Fixes: #43).
     - Remove redundant setting of loglevel in x2gogetapps.
     - Fix ,,Only extend LD_LIBRARY_PATH by Xrandr extension for KDE. Breaks
       GNOME.'' from last release.
@@ -69,9 +102,9 @@ x2goserver (3.1.1.4-0~x2go1) unstable; urgency=low
     - Add option ,,-r sound:local'' to rdesktop calls if pulse is enabled.
     - Proxy X2Go client-side shares into remote desktop session.
     - For applications inside of a session, use NX's Xrandr library instead
-      of Xorg's Xrandr library (partially closes #28).
+      of Xorg's Xrandr library (partially fixes #28).
     - Make sure when launching desktop session through the Xsession mechanism
-      that the LD_LIBRARY_PATH variable stays intact. Closes #29.
+      that the LD_LIBRARY_PATH variable stays intact. (Fixes: #29).
     - Only extend LD_LIBRARY_PATH by Xrandr extension for KDE. Breaks GNOME.
   * /debian/control:
     + Maintainer change in package: X2Go Developers &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/x2go-commits">x2go-dev at lists.berlios.de</A>&gt;.
@@ -366,7 +399,7 @@ x2goserver (3.0.99.6-0~x2go1) unstable; urgency=low
     - Add lxterminal as possible TERMINAL to x2goruncommand.
     - Add LibreOffice.org as possible OFFICE application to x2goruncommand.
     - Fix for TERMINAL command execution if konsole (KDE4) is installed on the
-      server (closes upstream issue #87).
+      server.
     - Silence x2golistsessions on missing session.log files.
     - Add x2goprint user creation information to INSTALL howto.
     - Add sanity checks to x2goprint, script can only be run as root.
@@ -424,7 +457,7 @@ x2goserver (3.0.99.6-0~x2go1) unstable; urgency=low
 
 
 
-  * React to bug #627990, prefer man2html-base over man2html.
+  * React to Debian bug #627990, prefer man2html-base over man2html.
   * Do not depend on package perlsuid anymore.
   * Use source format 3.0 (native).
   * Fix of Debian clean rules, fix of Makefile's clean rules.
diff --git a/debian/x2goserver.init b/debian/x2goserver.init
index b56a4cb..5ae86e4 100644
--- a/debian/x2goserver.init
+++ b/debian/x2goserver.init
@@ -9,21 +9,35 @@
 ### END INIT INFO
 
 PATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin
+XSOCKDIR=/tmp/.X11-unix
 
-case &quot;$1&quot; in
-	start)
+start()
+{
+		if [ ! -d $XSOCKDIR ]
+		then
+			mkdir $XSOCKDIR
+			chmod 1777 $XSOCKDIR
+		fi
 		echo &quot;Cleaning up stale X2Go sessions.&quot;
 		/usr/sbin/x2gocleansessions
-	;;
-	stop)
+}
+
+stop()
+{
 		# kill x2gocleansessions, ignore on failure
 		killall x2gocleansessions || true
+}
+
+case &quot;$1&quot; in
+	start)
+		start
+	;;
+	stop)
+		stop
 	;;
 	reload|force-reload|restart)
-		# kill x2gocleansessions, ignore on failure
-		killall x2gocleansessions || true
-		echo &quot;Cleaning up stale X2Go sessions.&quot;
-		/usr/sbin/x2gocleansessions
+		stop
+		start
 	;;
 	*)
 		N=/etc/init.d/x2goserver
diff --git a/x2goserver-compat/VERSION.x2goserver-compat b/x2goserver-compat/VERSION.x2goserver-compat
index 3a154d4..f69d489 100644
--- a/x2goserver-compat/VERSION.x2goserver-compat
+++ b/x2goserver-compat/VERSION.x2goserver-compat
@@ -1 +1 @@
-3.1.1.9
\ No newline at end of file
+4.0.0.0
\ No newline at end of file
diff --git a/x2goserver-compat/share/x2gofeature.d/x2goserver-compat.features b/x2goserver-compat/share/x2gofeature.d/x2goserver-compat.features
index d180d95..f4a9376 100755
--- a/x2goserver-compat/share/x2gofeature.d/x2goserver-compat.features
+++ b/x2goserver-compat/share/x2gofeature.d/x2goserver-compat.features
@@ -20,7 +20,7 @@
 # Copyright (C) 2011-2012  Oleksandr Shneyder &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/x2go-commits">oleksandr.shneyder at obviously-nice.de</A>&gt;
 # Copyright (C) 2011-2012  Heinz-Markus Graesing &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/x2go-commits">heinz-m.graesing at obviously-nice.de</A>&gt;
 
-X2GO_LIB_PATH=`echo -n \$(x2gobasepath)/lib/x2go`
+X2GO_LIB_PATH=&quot;$(x2gopath libexec)&quot;;
 
 $X2GO_LIB_PATH/x2gosyslog &quot;$0&quot; &quot;info&quot; &quot;$(basename $0) called with options: $@&quot;
 
diff --git a/x2goserver-extensions/VERSION.x2goserver-extensions b/x2goserver-extensions/VERSION.x2goserver-extensions
index 3a154d4..f69d489 100644
--- a/x2goserver-extensions/VERSION.x2goserver-extensions
+++ b/x2goserver-extensions/VERSION.x2goserver-extensions
@@ -1 +1 @@
-3.1.1.9
\ No newline at end of file
+4.0.0.0
\ No newline at end of file
diff --git a/x2goserver-extensions/bin/x2goserver-run-extensions b/x2goserver-extensions/bin/x2goserver-run-extensions
index 70636f6..f89515c 100755
--- a/x2goserver-extensions/bin/x2goserver-run-extensions
+++ b/x2goserver-extensions/bin/x2goserver-run-extensions
@@ -25,7 +25,7 @@ set -e
 
 test -z $2 &amp;&amp; { echo &quot;usage: $(basename $0) &lt;X2GO_SESSION_ID&gt; &lt;MODALITY&gt;&quot;; exit -1; }
 
-X2GO_LIB_PATH=`echo -n \$(x2gobasepath)/lib/x2go`
+X2GO_LIB_PATH=&quot;$(x2gopath libexec)&quot;;
 
 $X2GO_LIB_PATH/x2gosyslog &quot;$0&quot; &quot;info&quot; &quot;$(basename $0) called with options: $@&quot;
 
@@ -33,7 +33,7 @@ X2GO_SESSION=&quot;$1&quot;
 X2GO_MODALITY=&quot;$2&quot;
 
 # scan extensions and execute them
-find /usr/lib/x2go/extensions/${X2GO_MODALITY}.d/ -maxdepth 1 -mindepth 1 | egrep &quot;/[0-9]{3}_[[:alnum:]]+&quot; | sort | while read x2go_extension; do
+find &quot;$X2GO_LIB_PATH/extensions/$X2GO_MODALITY.d/&quot; -maxdepth 1 -mindepth 1 | egrep &quot;/[0-9]{3}_[[:alnum:]]+&quot; | sort | while read x2go_extension; do
 	$X2GO_LIB_PATH/x2gosyslog &quot;$0&quot; &quot;debug&quot; &quot;executing $x2go_extension with option $X2GO_SESSION&quot;
 	$x2go_extension &quot;$X2GO_SESSION&quot; &amp;&gt;/dev/null &amp;&amp; {
 		$X2GO_LIB_PATH/x2gosyslog &quot;$0&quot; &quot;info&quot; &quot;$x2go_extension ($(basename $0)) for session $X2GO_SESSION has finished sucessfully&quot;
diff --git a/x2goserver-extensions/man/man8/x2goserver-run-extensions.8 b/x2goserver-extensions/man/man8/x2goserver-run-extensions.8
index 9e3d86d..b8ae127 100644
--- a/x2goserver-extensions/man/man8/x2goserver-run-extensions.8
+++ b/x2goserver-extensions/man/man8/x2goserver-run-extensions.8
@@ -36,9 +36,9 @@ Calling X2Go Server core scripts currently are: \fBx2gostartagent(8)\fR, \fBx2go
 .PP
 The modality names all refer to a sub-directory of the path:
 
-  \fI&lt;INSTALL_PREFIX&gt;/lib/x2go/extensions\fR,
+  \fI&lt;libexecdir&gt;/x2go/extensions\fR,
 
-where &lt;INSTALL_PREFIX&gt; mostly is /usr on commonly-used GNU/Linux systems.
+where &lt;libexecdir&gt; is /usr/libexec/x2go or /usr/lib/x2go on commonly-used GNU/Linux systems.
 .PP
 In any of these sub-directories third-party X2Go extension packages can place scripts or binaries that will then get executed by the core X2Go server
 commands, either before or after the essential functionality (e.g. x2goagent startup, x2goagent suspension, x2goagent resumption, etc.) or on failure of that
diff --git a/x2goserver-extensions/share/x2gofeature.d/x2goserver-extensions.features b/x2goserver-extensions/share/x2gofeature.d/x2goserver-extensions.features
index 2a21cad..7f89a5c 100755
--- a/x2goserver-extensions/share/x2gofeature.d/x2goserver-extensions.features
+++ b/x2goserver-extensions/share/x2gofeature.d/x2goserver-extensions.features
@@ -20,7 +20,7 @@
 # Copyright (C) 2011-2012  Oleksandr Shneyder &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/x2go-commits">oleksandr.shneyder at obviously-nice.de</A>&gt;
 # Copyright (C) 2011-2012  Heinz-Markus Graesing &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/x2go-commits">heinz-m.graesing at obviously-nice.de</A>&gt;
 
-X2GO_LIB_PATH=`echo -n \$(x2gobasepath)/lib/x2go`
+X2GO_LIB_PATH=&quot;$(x2gopath libexec)&quot;;
 
 $X2GO_LIB_PATH/x2gosyslog &quot;$0&quot; &quot;info&quot; &quot;$(basename $0) called with options: $@&quot;
 
diff --git a/x2goserver-fmbindings/VERSION.x2goserver-fmbindings b/x2goserver-fmbindings/VERSION.x2goserver-fmbindings
index 3a154d4..f69d489 100644
--- a/x2goserver-fmbindings/VERSION.x2goserver-fmbindings
+++ b/x2goserver-fmbindings/VERSION.x2goserver-fmbindings
@@ -1 +1 @@
-3.1.1.9
\ No newline at end of file
+4.0.0.0
\ No newline at end of file
diff --git a/x2goserver-fmbindings/share/x2go/x2gofeature.d/x2goserver-fmbindings.features b/x2goserver-fmbindings/share/x2go/x2gofeature.d/x2goserver-fmbindings.features
index c1d5827..52f6111 100755
--- a/x2goserver-fmbindings/share/x2go/x2gofeature.d/x2goserver-fmbindings.features
+++ b/x2goserver-fmbindings/share/x2go/x2gofeature.d/x2goserver-fmbindings.features
@@ -20,7 +20,7 @@
 # Copyright (C) 2011  Oleksandr Shneyder &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/x2go-commits">oleksandr.shneyder at obviously-nice.de</A>&gt;
 # Copyright (C) 2011  Heinz-Markus Graesing &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/x2go-commits">heinz-m.graesing at obviously-nice.de</A>&gt;
 
-X2GO_LIB_PATH=`echo -n \$(x2gobasepath)/lib/x2go`
+X2GO_LIB_PATH=&quot;$(x2gopath libexec)&quot;;
 
 $X2GO_LIB_PATH/x2gosyslog &quot;$0&quot; &quot;info&quot; &quot;$(basename $0) called with options: $@&quot;
 
diff --git a/x2goserver-printing/VERSION.x2goserver-printing b/x2goserver-printing/VERSION.x2goserver-printing
index 3a154d4..f69d489 100644
--- a/x2goserver-printing/VERSION.x2goserver-printing
+++ b/x2goserver-printing/VERSION.x2goserver-printing
@@ -1 +1 @@
-3.1.1.9
\ No newline at end of file
+4.0.0.0
\ No newline at end of file
diff --git a/x2goserver-printing/share/x2gofeature.d/x2goserver-printing.features b/x2goserver-printing/share/x2gofeature.d/x2goserver-printing.features
index eb64533..bbe195c 100755
--- a/x2goserver-printing/share/x2gofeature.d/x2goserver-printing.features
+++ b/x2goserver-printing/share/x2gofeature.d/x2goserver-printing.features
@@ -20,7 +20,7 @@
 # Copyright (C) 2011-2012  Oleksandr Shneyder &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/x2go-commits">oleksandr.shneyder at obviously-nice.de</A>&gt;
 # Copyright (C) 2011-2012  Heinz-Markus Graesing &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/x2go-commits">heinz-m.graesing at obviously-nice.de</A>&gt;
 
-X2GO_LIB_PATH=`echo -n \$(x2gobasepath)/lib/x2go`
+X2GO_LIB_PATH=&quot;$(x2gopath libexec)&quot;;
 
 $X2GO_LIB_PATH/x2gosyslog &quot;$0&quot; &quot;info&quot; &quot;$(basename $0) called with options: $@&quot;
 
diff --git a/x2goserver-pyhoca/VERSION.x2goserver-pyhoca b/x2goserver-pyhoca/VERSION.x2goserver-pyhoca
index 3a154d4..f69d489 100644
--- a/x2goserver-pyhoca/VERSION.x2goserver-pyhoca
+++ b/x2goserver-pyhoca/VERSION.x2goserver-pyhoca
@@ -1 +1 @@
-3.1.1.9
\ No newline at end of file
+4.0.0.0
\ No newline at end of file
diff --git a/x2goserver-pyhoca/share/x2gofeature.d/x2goserver-pyhoca.features b/x2goserver-pyhoca/share/x2gofeature.d/x2goserver-pyhoca.features
index 2411c0e..8c3e4b5 100755
--- a/x2goserver-pyhoca/share/x2gofeature.d/x2goserver-pyhoca.features
+++ b/x2goserver-pyhoca/share/x2gofeature.d/x2goserver-pyhoca.features
@@ -20,7 +20,7 @@
 # Copyright (C) 2011-2012  Oleksandr Shneyder &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/x2go-commits">oleksandr.shneyder at obviously-nice.de</A>&gt;
 # Copyright (C) 2011-2012  Heinz-Markus Graesing &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/x2go-commits">heinz-m.graesing at obviously-nice.de</A>&gt;
 
-X2GO_LIB_PATH=`echo -n \$(x2gobasepath)/lib/x2go`
+X2GO_LIB_PATH=&quot;$(x2gopath libexec)&quot;;
 
 $X2GO_LIB_PATH/x2gosyslog &quot;$0&quot; &quot;info&quot; &quot;$(basename $0) called with options: $@&quot;
 
diff --git a/x2goserver-xsession/VERSION.x2goserver-xsession b/x2goserver-xsession/VERSION.x2goserver-xsession
index 3a154d4..f69d489 100644
--- a/x2goserver-xsession/VERSION.x2goserver-xsession
+++ b/x2goserver-xsession/VERSION.x2goserver-xsession
@@ -1 +1 @@
-3.1.1.9
\ No newline at end of file
+4.0.0.0
\ No newline at end of file
diff --git a/x2goserver-xsession/etc/Xsession b/x2goserver-xsession/etc/Xsession
index c241b41..9fd5104 100755
--- a/x2goserver-xsession/etc/Xsession
+++ b/x2goserver-xsession/etc/Xsession
@@ -8,6 +8,8 @@
 
 set -e
 
+X2GO_LIBEXEC_PATH=&quot;$(x2gopath libexec)&quot;;
+
 PROGNAME=XSession-x2go
 
 message () {
@@ -110,7 +112,7 @@ if [ -n &quot;$SESSIONFILES&quot; ]; then
 
     set +e
     for SESSIONFILE in $SESSIONFILES; do
-        /usr/lib/x2go/x2gosyslog &quot;$0&quot; &quot;info&quot; &quot;executing $SESSIONFILE&quot;
+        &quot;$X2GO_LIBEXEC_PATH/x2gosyslog&quot; &quot;$0&quot; &quot;info&quot; &quot;executing $SESSIONFILE&quot;
         . $SESSIONFILE
     done
     set -e
diff --git a/x2goserver-xsession/share/x2gofeature.d/x2goserver-xsession.features b/x2goserver-xsession/share/x2gofeature.d/x2goserver-xsession.features
index cc20f85..f4eb3dc 100755
--- a/x2goserver-xsession/share/x2gofeature.d/x2goserver-xsession.features
+++ b/x2goserver-xsession/share/x2gofeature.d/x2goserver-xsession.features
@@ -20,7 +20,7 @@
 # Copyright (C) 2011-2012  Oleksandr Shneyder &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/x2go-commits">oleksandr.shneyder at obviously-nice.de</A>&gt;
 # Copyright (C) 2011-2012  Heinz-Markus Graesing &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/x2go-commits">heinz-m.graesing at obviously-nice.de</A>&gt;
 
-X2GO_LIB_PATH=`echo -n \$(x2gobasepath)/lib/x2go`
+X2GO_LIB_PATH=&quot;$(x2gopath libexec)&quot;;
 
 $X2GO_LIB_PATH/x2gosyslog &quot;$0&quot; &quot;info&quot; &quot;$(basename $0) called with options: $@&quot;
 
diff --git a/x2goserver/Makefile b/x2goserver/Makefile
index 979283b..43fdccf 100755
--- a/x2goserver/Makefile
+++ b/x2goserver/Makefile
@@ -37,7 +37,7 @@ build: build-arch build-indep
 build-arch: build_setgidwrappers
 
 build_setgidwrappers:
-	gcc -fPIE -pie -o x2gosqlitewrapper x2gosqlitewrapper.c
+	gcc -fPIE -pie $(CFLAGS) -o x2gosqlitewrapper x2gosqlitewrapper.c
 
 build-indep: build_man2html
 
@@ -75,7 +75,11 @@ install_config:
 	$(INSTALL_DIR) $(DESTDIR)$(ETCDIR)/x2gosql
 	$(INSTALL_DIR) $(DESTDIR)$(ETCDIR)/x2gosql/passwords
 	$(INSTALL_FILE) etc/x2goserver.conf     $(DESTDIR)$(ETCDIR)/
+	$(INSTALL_FILE) etc/x2goagent.options   $(DESTDIR)$(ETCDIR)/
 	$(INSTALL_FILE) etc/x2gosql/sql         $(DESTDIR)$(ETCDIR)/x2gosql
+	$(INSTALL_DIR) $(DESTDIR)$(ETCDIR)/x2go_logout.d
+	$(INSTALL_FILE) etc/x2go_logout     $(DESTDIR)$(ETCDIR)/
+	$(INSTALL_FILE) etc/x2go_logout.d/* $(DESTDIR)$(ETCDIR)/x2go_logout.d/
 
 install_man:
 	$(INSTALL_DIR) $(DESTDIR)$(MANDIR)
diff --git a/x2goserver/VERSION.x2goserver b/x2goserver/VERSION.x2goserver
index 3a154d4..f69d489 100644
--- a/x2goserver/VERSION.x2goserver
+++ b/x2goserver/VERSION.x2goserver
@@ -1 +1 @@
-3.1.1.9
\ No newline at end of file
+4.0.0.0
\ No newline at end of file
diff --git a/x2goserver/bin/x2gobasepath b/x2goserver/bin/x2gobasepath
index 35f18bd..f6d8abc 100755
--- a/x2goserver/bin/x2gobasepath
+++ b/x2goserver/bin/x2gobasepath
@@ -1,30 +1,3 @@
-#!/usr/bin/perl
+#!/bin/sh
 
-# Copyright (C) 2007-2012 X2Go Project - <A HREF="http://wiki.x2go.org">http://wiki.x2go.org</A>
-#
-# This program is free software; you can redistribute it and/or modify
-# it under the terms of the GNU General Public License as published by
-# the Free Software Foundation; either version 2 of the License, or
-# (at your option) any later version.
-#
-# This program is distributed in the hope that it will be useful,
-# but WITHOUT ANY WARRANTY; without even the implied warranty of
-# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-# GNU General Public License for more details.
-#
-# You should have received a copy of the GNU General Public License
-# along with this program; if not, write to the
-# Free Software Foundation, Inc.,
-# 51 Franklin St, Fifth Floor, Boston, MA 02110-1301, USA.
-#
-# Copyright (C) 2007-2012  Mike Gabriel &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/x2go-commits">mike.gabriel at das-netzwerkteam.de</A>&gt;
-
-use strict;
-use Cwd;
-use Cwd q{abs_path};
-use File::Basename;
-
-my $dir = dirname($0);
-my $base_path = abs_path(&quot;$dir/..&quot;); 
-
-print &quot;$base_path&quot;;
+exec x2gopath base &quot;$@&quot;;
diff --git a/x2goserver/bin/x2gocmdexitmessage b/x2goserver/bin/x2gocmdexitmessage
index a17bb9f..1e6b022 100755
--- a/x2goserver/bin/x2gocmdexitmessage
+++ b/x2goserver/bin/x2gocmdexitmessage
@@ -20,7 +20,7 @@
 # Copyright (C) 2007-2012  Oleksandr Shneyder &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/x2go-commits">oleksandr.shneyder at obviously-nice.de</A>&gt;
 # Copyright (C) 2007-2012  Heinz-Markus Graesing &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/x2go-commits">heinz-m.graesing at obviously-nice.de</A>&gt;
 
-X2GO_LIB_PATH=`echo -n \$(x2gobasepath)/lib/x2go`
+X2GO_LIB_PATH=&quot;$(x2gopath libexec)&quot;;
 X2GO_ROOT=${HOME}/.x2go
 MESSAGE_FILE=$X2GO_ROOT/C-$1/cmdoutput
 
diff --git a/x2goserver/bin/x2gofeature b/x2goserver/bin/x2gofeature
index f379070..c2c851b 100755
--- a/x2goserver/bin/x2gofeature
+++ b/x2goserver/bin/x2gofeature
@@ -22,8 +22,8 @@
 
 [ -z $1 ] &amp;&amp; { echo usage: &quot;$(basename $0) &lt;X2GO_FEATURE_NAME&gt;&quot;; exit -2; }
 
-X2GO_LIB_PATH=`echo -n \$(x2gobasepath)/lib/x2go`
-X2GO_SHARE_PATH=`echo -n \$(x2gobasepath)/share/x2go`
+X2GO_LIB_PATH=&quot;$(x2gopath libexec)&quot;;
+X2GO_SHARE_PATH=&quot;$(x2gopath share)&quot;;
 
 $X2GO_LIB_PATH/x2gosyslog &quot;$0&quot; &quot;info&quot; &quot;$(basename $0) called with options: $@&quot;
 
diff --git a/x2goserver/bin/x2gofeaturelist b/x2goserver/bin/x2gofeaturelist
index 1258a77..44b3bfc 100755
--- a/x2goserver/bin/x2gofeaturelist
+++ b/x2goserver/bin/x2gofeaturelist
@@ -19,8 +19,8 @@
 #
 # Copyright (C) 2011-2012  Mike Gabriel &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/x2go-commits">mike.gabriel at das-netzwerkteam.de</A>&gt;
 
-X2GO_LIB_PATH=`echo -n \$(x2gobasepath)/lib/x2go`
-X2GO_SHARE_PATH=`echo -n \$(x2gobasepath)/share/x2go`
+X2GO_LIB_PATH=&quot;$(x2gopath libexec)&quot;;
+X2GO_SHARE_PATH=&quot;$(x2gopath share)&quot;;
 
 $X2GO_LIB_PATH/x2gosyslog &quot;$0&quot; &quot;info&quot; &quot;$(basename $0) called with options: $@&quot;
 
diff --git a/x2goserver/bin/x2gomountdirs b/x2goserver/bin/x2gomountdirs
index 8436219..ef7f139 100755
--- a/x2goserver/bin/x2gomountdirs
+++ b/x2goserver/bin/x2gomountdirs
@@ -116,7 +116,7 @@ print F $dsa_key;
 close(F);
 
 open (F,&quot;&gt;$key.ident&quot;);
-print F &quot;$host $rsa_identity&quot;;
+print F &quot;\[$host\]:$port $rsa_identity&quot;;
 close(F);
 
 chmod(0600,&quot;$key&quot;);
@@ -221,6 +221,7 @@ for (my $i=0;$i&lt;@dirs;$i++)
 	my $printspool=0;
 	my $mimeboxspool=0;
 	my $mntpath;
+	my $this_mdir = $mdir;
 	if(@dirs[$i]=~m/__PRINT_SPOOL_/)
 	{
 		@dirs[$i]=~s/__PRINT_SPOOL_//;
@@ -243,24 +244,24 @@ for (my $i=0;$i&lt;@dirs;$i++)
 			$p=~s/\/ramdrive\/mnt\///;
 			if ($p =~ m/CDROM/)
 			{
-				$mdir=$mdir.&quot;/cd&quot;;
+				$this_mdir=$this_mdir.&quot;/cd&quot;;
 			}
 			else
 			{
-				$mdir=$mdir.&quot;/rm&quot;;
+				$this_mdir=$this_mdir.&quot;/rm&quot;;
 			}
 		}
 		else
 		{
-			$mdir=$mdir.&quot;/disk&quot;;
+			$this_mdir=$this_mdir.&quot;/disk&quot;;
 		}
 		$p=~s/\//_/g;
 		$p=~s/ /_/g;
 		$p=~s/~_cygdrive_//;
 		$p=~s/~_windrive_//;
 		$p=~s/~//g;
-		mkdir(&quot;$mdir/$p&quot;);
-		$mntpath=&quot;$mdir/$p&quot;;
+		mkdir(&quot;$this_mdir/$p&quot;);
+		$mntpath=&quot;$this_mdir/$p&quot;;
 	}
 
 	if (db_insertmount( $session, $mntpath, $host))
diff --git a/x2goserver-fmbindings/bin/x2gofm b/x2goserver/bin/x2gopath
similarity index 57%
copy from x2goserver-fmbindings/bin/x2gofm
copy to x2goserver/bin/x2gopath
index 9070055..b42c9bb 100755
--- a/x2goserver-fmbindings/bin/x2gofm
+++ b/x2goserver/bin/x2gopath
@@ -1,4 +1,4 @@
-#!/usr/bin/perl
+#!/bin/sh
 
 # Copyright (C) 2007-2012 X2Go Project - <A HREF="http://wiki.x2go.org">http://wiki.x2go.org</A>
 #
@@ -17,13 +17,29 @@
 # Free Software Foundation, Inc.,
 # 51 Franklin St, Fifth Floor, Boston, MA 02110-1301, USA.
 #
-# Copyright (C) 2012  Milan Kn&#237;&#382;ek &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/x2go-commits">knizek.confy at gmail.com</A>&gt;
 # Copyright (C) 2012  Oleksandr Shneyder &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/x2go-commits">oleksandr.shneyder at obviously-nice.de</A>&gt;
+# Copyright (C) 2012  Heinz-Markus Graesing &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/x2go-commits">heinz-m.graesing at obviously-nice.de</A>&gt;
+# Copyright (C) 2012  Mike Gabriel &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/x2go-commits">mike.gabriel at das-netzwerkteam.de</A>&gt;
+# Copyright (C) 2012  Jan Engelhard &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/x2go-commits">jengelh at inai.de</A>&gt;
 
-use strict;
 
-my $fname=shift;
-open(F,&quot;&lt;$fname&quot;) or die &quot;can't open $fname&quot;;
-my $dir=&lt;F&gt;;
-close(F);
-system( &quot;xdg-open  $dir&quot; );
+base=&quot;${0%/*}&quot;;
+if test &quot;$base&quot; = &quot;$0&quot;; then
+	base=&quot;.&quot;;
+fi;
+
+base=$(readlink -f &quot;$base/..&quot;);
+
+# The following section is subject to substitution by distro packaging tools.
+case &quot;$1&quot; in
+	base) echo -n &quot;$base&quot;;;
+	lib) echo -n &quot;$base/lib/x2go&quot;;;
+	libexec) echo -n &quot;$base/lib/x2go&quot;;;
+	share) echo -n &quot;$base/share/x2go&quot;;;
+	xinerama) echo -n &quot;$base/lib/nx/X11/Xinerama&quot;;;
+	*) exit 1;;
+esac;
+
+if test -t 1; then
+	echo &quot;&quot;;
+fi;
diff --git a/x2goserver/bin/x2goresume-session b/x2goserver/bin/x2goresume-session
index cddbf05..f4b5624 100755
--- a/x2goserver/bin/x2goresume-session
+++ b/x2goserver/bin/x2goresume-session
@@ -28,7 +28,7 @@ X2GO_KBD_LAYOUT=&quot;$5&quot;
 X2GO_KBD_TYPE=&quot;$6&quot;
 X2GO_SET_KBD=&quot;$7&quot;
 
-X2GO_LIB_PATH=`echo -n \$(x2gobasepath)/lib/x2go`
+X2GO_LIB_PATH=&quot;$(x2gopath libexec)&quot;;
 X2GO_AGENT_PID=`$X2GO_LIB_PATH/x2gogetagent &quot;$SESSION_NAME&quot;`
 
 X2GO_ROOT=&quot;${HOME}/.x2go&quot;
diff --git a/x2goserver/bin/x2goruncommand b/x2goserver/bin/x2goruncommand
index b88c3b9..2414b2c 100755
--- a/x2goserver/bin/x2goruncommand
+++ b/x2goserver/bin/x2goruncommand
@@ -27,7 +27,7 @@ cmd=$5
 sndsys=$6
 X2GO_SESS_TYPE=$7
 
-X2GO_LIB_PATH=`echo -n \$(x2gobasepath)/lib/x2go`
+X2GO_LIB_PATH=&quot;$(x2gopath libexec)&quot;;
 
 $X2GO_LIB_PATH/x2gosyslog &quot;$0&quot; &quot;info&quot; &quot;$(basename $0) called with options: $@&quot;
 
@@ -206,12 +206,12 @@ then
 	X2GO_SESS_TYPE=&quot;R&quot;
 fi
 
-if [ &quot;$cmd&quot; == &quot;startkde&quot; ]; then
-	NX_XRANDR_LIBS=/usr/lib/nx/X11/Xrandr
-	LD_LIBRARY_PATH=&quot;$NX_XRANDR_LIBS:$LD_LIBRARY_PATH&quot;
-	$X2GO_LIB_PATH/x2gosyslog &quot;$0&quot; &quot;debug&quot; &quot;extending LD_LIBRARY_PATH=$LD_LIBRARY_PATH by Xrandr extension&quot;
-	export LD_LIBRARY_PATH
-fi
+#if [ &quot;$cmd&quot; == &quot;startkde&quot; ]; then
+#	NX_XRANDR_LIBS=/usr/lib/nx/X11/Xrandr
+#	LD_LIBRARY_PATH=&quot;$NX_XRANDR_LIBS:$LD_LIBRARY_PATH&quot;
+#	$X2GO_LIB_PATH/x2gosyslog &quot;$0&quot; &quot;debug&quot; &quot;extending LD_LIBRARY_PATH=$LD_LIBRARY_PATH by Xrandr extension&quot;
+#	export LD_LIBRARY_PATH
+#fi
 
 
 # run x2goserver-extensions for pre-runcommand
diff --git a/x2goserver/bin/x2gosetkeyboard b/x2goserver/bin/x2gosetkeyboard
index 949af5e..cb99b40 100755
--- a/x2goserver/bin/x2gosetkeyboard
+++ b/x2goserver/bin/x2gosetkeyboard
@@ -21,7 +21,7 @@
 # Copyright (C) 2011-2012  Oleksandr Shneyder &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/x2go-commits">oleksandr.shneyder at obviously-nice.de</A>&gt;
 # Copyright (C) 2011-2012  Heinz-Markus Graesing &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/x2go-commits">heinz-m.graesing at obviously-nice.de</A>&gt;
 
-X2GO_LIB_PATH=`echo -n \$(x2gobasepath)/lib/x2go`
+X2GO_LIB_PATH=&quot;$(x2gopath libexec)&quot;;
 
 $X2GO_LIB_PATH/x2gosyslog &quot;$0&quot; &quot;info&quot; &quot;$(basename $0) called with options: $@&quot;
 
diff --git a/x2goserver/bin/x2gostartagent b/x2goserver/bin/x2gostartagent
index 5499d15..45b3ba5 100755
--- a/x2goserver/bin/x2gostartagent
+++ b/x2goserver/bin/x2gostartagent
@@ -20,7 +20,7 @@
 # Copyright (C) 2007-2012  Oleksandr Shneyder &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/x2go-commits">oleksandr.shneyder at obviously-nice.de</A>&gt;
 # Copyright (C) 2007-2012  Heinz-Markus Graesing &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/x2go-commits">heinz-m.graesing at obviously-nice.de</A>&gt;
 
-X2GO_LIB_PATH=`echo -n \$(x2gobasepath)/lib/x2go`
+X2GO_LIB_PATH=&quot;$(x2gopath libexec)&quot;;
 
 $X2GO_LIB_PATH/x2gosyslog &quot;$0&quot; &quot;info&quot; &quot;$(basename $0) called with options: $@&quot;
 
@@ -30,6 +30,14 @@ SSH_PORT=30000 #First ssh port 30001
 X2GO_ROOT=&quot;${HOME}/.x2go&quot;
 export NX_ROOT=$X2GO_ROOT
 
+if [ -r /etc/x2go/x2goagent.options ]; then
+    source /etc/x2go/x2goagent.options
+fi
+
+if [ -z &quot;$X2GO_NXAGENT_OPTIONS&quot; ]; then
+    X2GO_NXAGENT_OPTIONS=&quot;$X2GO_NXAGENT_DEFAULT_OPTIONS&quot;
+fi
+
 REMOTE=localhost
 
 X2GO_CLIENT=`echo $SSH_CLIENT | awk '{print $1}'`
@@ -263,10 +271,10 @@ SESSION_WINDOW_TITLE=&quot;X2GO-${SESSION_NAME}&quot;
 
 if  [ &quot;$X2GO_STYPE&quot; == &quot;S&quot; ]; then
 	# set NX_TEMP to /tmp, make sure x2goagent starts when pam_tmpdir.so is in use
-	NX_TEMP=/tmp x2goagent $NOLISTOPT $X2GODPIOPTION_ -$SESSION_TYPE -auth &quot;$XAUTHORITY&quot; -shadow $SHADOW_DESKTOP -shadowmode $SHADOW_MODE -geometry ${X2GO_GEOMETRY} -name &quot;${SESSION_WINDOW_TITLE}&quot;  &quot;${NX_AGENT}&quot; 2&gt;&quot;${SESSION_LOG}&quot; &amp;
+	NX_TEMP=/tmp x2goagent $X2GO_NXAGENT_OPTIONS $NOLISTOPT $X2GODPIOPTION_ -$SESSION_TYPE -auth &quot;$XAUTHORITY&quot; -shadow $SHADOW_DESKTOP -shadowmode $SHADOW_MODE -geometry ${X2GO_GEOMETRY} -name &quot;${SESSION_WINDOW_TITLE}&quot;  &quot;${NX_AGENT}&quot; 2&gt;&quot;${SESSION_LOG}&quot; &amp;
 else
 	# set NX_TEMP to /tmp, make sure x2goagent starts when pam_tmpdir.so is in use
-	NX_TEMP=/tmp x2goagent $NOLISTOPT $X2GODPIOPTION_ $XDMCPOPT -$SESSION_TYPE $NOEXITPARAM -auth &quot;$XAUTHORITY&quot; -geometry ${X2GO_GEOMETRY} -name &quot;${SESSION_WINDOW_TITLE}&quot;  &quot;${NX_AGENT}&quot; 2&gt;&quot;${SESSION_LOG}&quot; &amp;
+	NX_TEMP=/tmp x2goagent $X2GO_NXAGENT_OPTIONS $NOLISTOPT $X2GODPIOPTION_ $XDMCPOPT -$SESSION_TYPE $NOEXITPARAM -auth &quot;$XAUTHORITY&quot; -geometry ${X2GO_GEOMETRY} -name &quot;${SESSION_WINDOW_TITLE}&quot;  &quot;${NX_AGENT}&quot; 2&gt;&quot;${SESSION_LOG}&quot; &amp;
 fi
 
 X2GO_AGENT_PID=$!
diff --git a/x2goserver/bin/x2gosuspend-session b/x2goserver/bin/x2gosuspend-session
index f823c69..645c352 100755
--- a/x2goserver/bin/x2gosuspend-session
+++ b/x2goserver/bin/x2gosuspend-session
@@ -26,7 +26,7 @@ else
 	SESSION_NAME=&quot;$X2GO_SESSION&quot;
 fi
 
-X2GO_LIB_PATH=`echo -n \$(x2gobasepath)/lib/x2go`
+X2GO_LIB_PATH=&quot;$(x2gopath libexec)&quot;;
 
 $X2GO_LIB_PATH/x2gosyslog &quot;$0&quot; &quot;info&quot; &quot;$(basename $0) called with options: $@&quot;
 
diff --git a/x2goserver/bin/x2goterminate-session b/x2goserver/bin/x2goterminate-session
index a661dfc..9819498 100755
--- a/x2goserver/bin/x2goterminate-session
+++ b/x2goserver/bin/x2goterminate-session
@@ -26,7 +26,7 @@ else
 	SESSION_NAME=&quot;$X2GO_SESSION&quot;
 fi
 
-X2GO_LIB_PATH=`echo -n \$(x2gobasepath)/lib/x2go`
+X2GO_LIB_PATH=&quot;$(x2gopath libexec)&quot;;
 
 $X2GO_LIB_PATH/x2gosyslog &quot;$0&quot; &quot;info&quot; &quot;$(basename $0) called with options: $@&quot;
 
diff --git a/x2goserver/bin/x2goversion b/x2goserver/bin/x2goversion
index a1fea45..eee00db 100755
--- a/x2goserver/bin/x2goversion
+++ b/x2goserver/bin/x2goversion
@@ -20,7 +20,7 @@
 # Copyright (C) 2011-2012  Oleksandr Shneyder &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/x2go-commits">oleksandr.shneyder at obviously-nice.de</A>&gt;
 # Copyright (C) 2011-2012  Heinz-Markus Graesing &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/x2go-commits">heinz-m.graesing at obviously-nice.de</A>&gt;
 
-X2GO_LIB_PATH=`echo -n \$(x2gobasepath)/lib/x2go`
+X2GO_LIB_PATH=&quot;$(x2gopath libexec)&quot;;
 
 $X2GO_LIB_PATH/x2gosyslog &quot;$0&quot; &quot;info&quot; &quot;$(basename $0) called with options: $@&quot;
 
diff --git a/x2goserver/etc/x2goagent.options b/x2goserver/etc/x2goagent.options
new file mode 100644
index 0000000..afe12f9
--- /dev/null
+++ b/x2goserver/etc/x2goagent.options
@@ -0,0 +1,15 @@
+#
+# This file can be used to specify default options that are passed to nxagent
+# These options can be overriden by the client!
+
+X2GO_NXAGENT_DEFAULT_OPTIONS=&quot;&quot;
+
+# Disable XFIXES.
+# Workaround for <A HREF="https://bugs.launchpad.net/ubuntu/+source/libxfixes/+bug/985202">https://bugs.launchpad.net/ubuntu/+source/libxfixes/+bug/985202</A>
+#
+X2GO_NXAGENT_DEFAULT_OPTIONS+=&quot; -extension XFIXES&quot;
+
+# Disable GLX, the old mesa version is hopelessly outdated anyways.
+# Unbreaks the gnome3 control center
+#
+X2GO_NXAGENT_DEFAULT_OPTIONS+=&quot; -extension GLX&quot;
diff --git a/x2goserver/man/man8/x2gopath.8 b/x2goserver/man/man8/x2gopath.8
new file mode 100644
index 0000000..a8d1cbb
--- /dev/null
+++ b/x2goserver/man/man8/x2gopath.8
@@ -0,0 +1,28 @@
+.TH x2gopath 8 &quot;Feb 2012&quot; &quot;Version 3.1.0.x&quot; &quot;X2Go Server Tool&quot;
+.SH Name
+.PP
+x2gopath - Show X2Go Server installation paths
+.SH Synopsis
+.PP
+\fBx2gopath\fP {\fBbase\fP|\fBlib\fP|\fBlibexec\fP|\fBshare\fP}
+.SH Description
+.PP
+\fBx2gopath\fP displays the paths of the selected X2Go installation directory.
+.TP
+\fBbase\fP
+The prefix under which X2Go was installed. This is generally \fB/usr\fP or
+\fB/usr/local\fP.
+.TP
+\fBlib\fP
+The location of X2Go architecture-dependent parts (e.g. libraries,
+but also Perl modules).
+.\&quot; Possible examplares are /usr/lib64/x2go (traditional biarch) and
+.\&quot; /usr/lib/x86_64-gnu-linux/x2go (Debian-style multiarch)
+.TP
+\fBlibexec\fP
+The location of private X2Go binaries.
+.\&quot; Possible examples are /usr/libexec/x2go and /usr/lib/x2go.
+.TP
+\fBshare\fP
+The location of X2Go's data files.
+.\&quot; prefix + /share/x2go
diff --git a/x2goserver/sbin/x2gocleansessions b/x2goserver/sbin/x2gocleansessions
index 8d52d85..6cc0edd 100755
--- a/x2goserver/sbin/x2gocleansessions
+++ b/x2goserver/sbin/x2gocleansessions
@@ -24,8 +24,8 @@ use strict;
 use Sys::Hostname;
 use Sys::Syslog qw( :standard :macros );
 
-my $x2go_lib_path=`echo -n \$(x2gobasepath)/lib/x2go`;
-use lib `echo -n \$(x2gobasepath)/lib/x2go`;
+my $x2go_lib_path=`x2gopath libexec`;
+use lib `x2gopath libexec`;
 use x2gologlevel;
 
 openlog($0,'cons,pid','user');
diff --git a/x2goserver/sbin/x2golistsessions_root b/x2goserver/sbin/x2golistsessions_root
index 71fc5dd..dda2b31 100755
--- a/x2goserver/sbin/x2golistsessions_root
+++ b/x2goserver/sbin/x2golistsessions_root
@@ -43,7 +43,7 @@ sub check_stat
 	return 1;
 }
 
-my $x2go_lib_path=`echo -n \$(x2gobasepath)/lib/x2go`;
+my $x2go_lib_path = `x2gopath libexec`;
 
 my $uname;
 
diff --git a/x2goserver/share/x2gofeature.d/x2goserver.features b/x2goserver/share/x2gofeature.d/x2goserver.features
index db4aaf2..1d23695 100755
--- a/x2goserver/share/x2gofeature.d/x2goserver.features
+++ b/x2goserver/share/x2gofeature.d/x2goserver.features
@@ -20,7 +20,7 @@
 # Copyright (C) 2011-2012  Oleksandr Shneyder &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/x2go-commits">oleksandr.shneyder at obviously-nice.de</A>&gt;
 # Copyright (C) 2011-2012  Heinz-Markus Graesing &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/x2go-commits">heinz-m.graesing at obviously-nice.de</A>&gt;
 
-X2GO_LIB_PATH=`echo -n \$(x2gobasepath)/lib/x2go`
+X2GO_LIB_PATH=&quot;$(x2gopath libexec)&quot;;
 
 $X2GO_LIB_PATH/x2gosyslog &quot;$0&quot; &quot;info&quot; &quot;$(basename $0) called with options: $@&quot;
 


hooks/post-receive
-- 
x2goserver.git (X2Go Server)

This is an automated email from the git hooks/post-receive script. It was
generated because a ref change was pushed to the repository containing
the project &quot;x2goserver.git&quot; (X2Go Server).

</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="003928.html">[X2go-Commits] x2goserver.git - release/4.0.0.x (branch) updated:	3.1.1.9-17-g3bb58b5
</A></li>
	<LI>Next message: <A HREF="003930.html">[X2go-Commits] x2goclient.git - build-baikal (branch) created:	4.0.0.0-1-g7f58ba0
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3929">[ date ]</a>
              <a href="thread.html#3929">[ thread ]</a>
              <a href="subject.html#3929">[ subject ]</a>
              <a href="author.html#3929">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/x2go-commits">More information about the X2go-commits
mailing list</a><br>
</body></html>
