<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [X2Go-Commits] x2goclient.git - build-main (branch) updated:	4.0.1.0-15-ga657ff6
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/x2go-commits/2013-September/index.html" >
   <LINK REL="made" HREF="mailto:x2go-commits%40lists.berlios.de?Subject=Re%3A%20%5BX2Go-Commits%5D%20x2goclient.git%20-%20build-main%20%28branch%29%20updated%3A%0A%094.0.1.0-15-ga657ff6&In-Reply-To=%3C20130911100653.753EA5DB2C%40ymir%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="012181.html">
   <LINK REL="Next"  HREF="012171.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[X2Go-Commits] x2goclient.git - build-main (branch) updated:	4.0.1.0-15-ga657ff6</H1>
    <B>X2Go dev team</B> 
    <A HREF="mailto:x2go-commits%40lists.berlios.de?Subject=Re%3A%20%5BX2Go-Commits%5D%20x2goclient.git%20-%20build-main%20%28branch%29%20updated%3A%0A%094.0.1.0-15-ga657ff6&In-Reply-To=%3C20130911100653.753EA5DB2C%40ymir%3E"
       TITLE="[X2Go-Commits] x2goclient.git - build-main (branch) updated:	4.0.1.0-15-ga657ff6">git-admin at x2go.org
       </A><BR>
    <I>Wed Sep 11 12:06:53 CEST 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="012181.html">[X2Go-Commits] x2goclient.git - build-main (branch) updated:	4.0.1.0-13-g35aa03e
</A></li>
        <LI>Next message: <A HREF="012171.html">[X2Go-Commits] x2goclient.git - build-main (branch) updated:	4.0.1.0-25-g67b1b42
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12192">[ date ]</a>
              <a href="thread.html#12192">[ thread ]</a>
              <a href="subject.html#12192">[ subject ]</a>
              <a href="author.html#12192">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>The branch, build-main has been updated
       via  a657ff6df33de369f4c323e42b642b157d999b45 (commit)
      from  c25f99471a30d406a68356d710f928b2e805973f (commit)

Those revisions listed above that are new to this repository have
not appeared on any other notification email; so we list those
revisions in full, below.

- Log -----------------------------------------------------------------
-----------------------------------------------------------------------

Summary of changes:
 .gitignore              |    7 +
 debian/changelog        |    4 +
 onmainwindow.cpp        |  899 +++++++++++++++++++++++++++++++----------------
 onmainwindow.h          |    3 +
 sshmasterconnection.cpp |   88 ++++-
 x2goclientconfig.h      |    2 +-
 x2gologdebug.cpp        |    1 -
 x2gologdebug.h          |   33 +-
 8 files changed, 716 insertions(+), 321 deletions(-)

The diff of changes is:
diff --git a/.gitignore b/.gitignore
index 721e32c..bd81db2 100644
--- a/.gitignore
+++ b/.gitignore
@@ -1,6 +1,11 @@
 # Temporary object files/static libs.
 *.[oa]
 
+client_build/
+plugin_build/
+.build_man2html
+x2goclient
+
 # Generated by qmake.
 moc_*.cpp
 ui_*.h
@@ -14,4 +19,6 @@ x2goclient_*.qm
 
 # Generated by qmake when building on OS X.
 x2goclient.app
+x2goclient.dmg
 
+x2goclient.pro.user
diff --git a/debian/changelog b/debian/changelog
index d06914d..85111fe 100644
--- a/debian/changelog
+++ b/debian/changelog
@@ -12,6 +12,10 @@ x2goclient (4.0.1.1-0~x2go1) UNRELEASED; urgency=low
       Let's consider a given SSH private key that fails to log the user
       in as an overall login failure. (Fixes: #141).
 
+  [ Otto Kjell ]
+  * New upstream version (4.0.1.1):
+    - Enable debug mode through cmd line parameter. (Fixes: #142).
+
   [ Orion Poplawski ]
   * New upstream version (4.0.1.1):
     - Instead of using a hard-code DPI of 96, use local DPI settings for new
diff --git a/onmainwindow.cpp b/onmainwindow.cpp
index 5f37cc1..c69fc43 100644
--- a/onmainwindow.cpp
+++ b/onmainwindow.cpp
@@ -36,18 +36,20 @@ bool	ONMainWindow::portable=false;
 QString ONMainWindow::homeDir;
 QString ONMainWindow::sessionCfg;
 
-
 #ifdef Q_OS_WIN
 QString ONMainWindow::u3Device;
 #endif
 
+bool ONMainWindow::debugging=false;
 
 ONMainWindow::ONMainWindow ( QWidget *parent ) :QMainWindow ( parent )
 {
 #ifdef Q_OS_LINUX
     image=shape=0;
 #endif
-    x2goDebug&lt;&lt;&quot;ONMainWindow constructor&quot;&lt;&lt;endl;
+    x2goInfof(1) &lt;&lt; tr(&quot;Starting x2goclient...&quot;);
+    debugging = false;
+
     setFocusPolicy ( Qt::NoFocus );
     installTranslator();
     cleanAllFiles=false;
@@ -223,8 +225,8 @@ ONMainWindow::ONMainWindow ( QWidget *parent ) :QMainWindow ( parent )
             portableDataPath=QDir::currentPath();
 
         homeDir=portableDataPath;
-        x2goDebug&lt;&lt;&quot;running in \&quot;portable\&quot; mode\n&quot;&lt;&lt;
-                 &quot;Data Dir is &quot;&lt;&lt;portableDataPath;
+
+        x2goInfof(2)&lt;&lt;tr(&quot;Starting x2goclient in portable mode... data directory is: &quot;)&lt;&lt;portableDataPath;
         QTimer *timer = new QTimer(this);
         connect(timer, SIGNAL(timeout()), this, SLOT(slotCheckPortableDir()));
         timer-&gt;start(1000);
@@ -241,7 +243,6 @@ ONMainWindow::ONMainWindow ( QWidget *parent ) :QMainWindow ( parent )
     trayIconInit();
 
 
-
     if ( embedMode )
     {
         miniMode=false;
@@ -270,13 +271,11 @@ ONMainWindow::ONMainWindow ( QWidget *parent ) :QMainWindow ( parent )
 
     QDesktopWidget wd;
 
-    //x2goDebug&lt;&lt;&quot;primary screen geometry: &quot;&lt;&lt;wd.screenGeometry(wd.screenNumber(this));
-
     if ( wd.screenGeometry(wd.screenNumber(this)).width() &lt;1024 ||
             wd.screenGeometry(wd.screenNumber(this)).height() &lt;768 )
     {
         miniMode=true;
-        x2goDebug&lt;&lt;&quot;Switching to \&quot;mini\&quot; mode&quot;;
+        x2goDebug&lt;&lt;&quot;Switching to \&quot;mini\&quot; mode...&quot;;
     }
 
 
@@ -391,7 +390,8 @@ ONMainWindow::ONMainWindow ( QWidget *parent ) :QMainWindow ( parent )
     initStatusDlg();
 
 #if defined(CFGPLUGIN) &amp;&amp; defined(Q_OS_LINUX)
-    x2goDebug&lt;&lt;&quot;create embedContainer&quot;&lt;&lt;endl;
+
+    x2goDebug&lt;&lt;&quot;Creating embedded container.&quot;;
     embedContainer=new QX11EmbedContainer ( fr );
 
 #endif
@@ -457,9 +457,11 @@ ONMainWindow::ONMainWindow ( QWidget *parent ) :QMainWindow ( parent )
 
     connect( xineramaTimer, SIGNAL(timeout()), this, SLOT(slotConfigXinerama()));
 
-    x2goDebug&lt;&lt;&quot;ONMainWindows constructor finished, home Directory is:&quot;&lt;&lt;homeDir&lt;&lt;endl;
+    x2goInfof(3)&lt;&lt;tr(&quot;Started  x2goclient.&quot;);
+    x2goDebug&lt;&lt;&quot;$HOME=&quot; + homeDir.toAscii();
     if (thinMode)
     {
+        x2goDebug&lt;&lt;&quot;ThinMode is active.&quot;;
         showMaximized();
         activateWindow();
         raise();
@@ -469,10 +471,10 @@ ONMainWindow::ONMainWindow ( QWidget *parent ) :QMainWindow ( parent )
 
 ONMainWindow::~ONMainWindow()
 {
-    x2goDebug&lt;&lt;&quot;ONMainWindow destructor&quot;;
+    x2goDebug&lt;&lt;&quot;Destroying x2goclient...&quot;;
     if ( !closeEventSent )
         closeClient();
-    x2goDebug&lt;&lt;&quot;end of ONMainWindow destructor&quot;;
+    x2goDebug&lt;&lt;&quot;Destroyed  x2goclient.&quot;;
 }
 
 void ONMainWindow::slotShutdownThinClient()
@@ -517,13 +519,12 @@ void ONMainWindow::installTranslator()
     filename=filename.toLower();
     if ( !x2goclientTranslator-&gt;load ( filename ) )
     {
-        qDebug ( &quot;Can't load translator (%s) !\n&quot;,
-                 filename.toLocal8Bit().data() );
+        x2goWarningf(1)&lt;&lt;tr(&quot;Can't load translator: &quot;) + filename.toAscii();
     }
     else
     {
         QCoreApplication::installTranslator ( x2goclientTranslator );
-// 		x2goDebug&lt;&lt;&quot;translator &quot;&lt;&lt;filename&lt;&lt; &quot; installed&quot;;
+        x2goInfof(4)&lt;&lt;tr(&quot;Translator: &quot;) + filename.toAscii() + tr(&quot; installed.&quot;);
     }
 
 
@@ -531,13 +532,12 @@ void ONMainWindow::installTranslator()
     filename=QString ( &quot;:/qt_%1&quot; ).arg ( QLocale::system().name() );
     if ( !qtTranslator-&gt;load ( filename ) )
     {
-        x2goDebug&lt;&lt; &quot;Can't load translator &quot;&lt;&lt;
-                 filename.toLocal8Bit().data() ;
+        x2goWarningf(2)&lt;&lt;tr(&quot;Can't load translator: &quot;) + filename.toAscii();
     }
     else
     {
         QCoreApplication::installTranslator ( qtTranslator );
-// 		x2goDebug&lt;&lt;&quot;translator &quot;&lt;&lt;filename&lt;&lt; &quot; installed&quot;;
+        x2goInfof(5)&lt;&lt;tr(&quot;Translator: &quot;) + filename.toAscii() + tr(&quot; installed.&quot;);
     }
 }
 
@@ -654,6 +654,7 @@ void ONMainWindow::initWidgetsEmbed()
     if ( config.confFS&amp;&amp; ( !config.useFs ) )
     {
         x2goDebug&lt;&lt;&quot;hide share&quot;;
+
         act_shareFolder-&gt;setVisible ( false );
     }
 
@@ -915,7 +916,8 @@ void ONMainWindow::slotTestConnection()
 
 void ONMainWindow::slotChangeBrokerPass()
 {
-    x2goDebug&lt;&lt;&quot;change broker pass&quot;;
+    x2goDebug&lt;&lt;&quot;Changing broker password.&quot;;
+
     BrokerPassDlg passDlg;
     if (passDlg.exec()!=QDialog::Accepted)
         return;
@@ -938,7 +940,7 @@ void ONMainWindow::slotCheckPortableDir()
 {
     if (!QFile::exists(homeDir))
     {
-        x2goDebug&lt;&lt;&quot;portable dir not exists, close&quot;;
+        x2goDebug&lt;&lt;&quot;Portable directory does not exists, closing.&quot;;
         close();
     }
 }
@@ -1085,8 +1087,12 @@ void ONMainWindow::trayIconInit()
             trayIcon-&gt;setIcon(QIcon ( &quot;:icons/128x128/x2go.png&quot;) );
             trayIcon-&gt;setToolTip(tr(&quot;Left mouse button to hide/restore - Right mouse button to display context menu&quot;));
         }
-        trayIcon-&gt;show();
-        plugAppsInTray();
+
+        if (!startHidden)
+        {
+            trayIcon-&gt;show();
+            plugAppsInTray();
+        }
     }
 #endif
 }
@@ -1101,7 +1107,8 @@ QMenu* ONMainWindow::initTrayAppMenu(QString text, QPixmap icon)
 
 void ONMainWindow::slotAppMenuTriggered(QAction* action)
 {
-    x2goDebug&lt;&lt;&quot;slotAppMenuTriggered :&quot;&lt;&lt;action-&gt;data().toString()&lt;&lt;endl;
+    x2goDebug&lt;&lt;&quot;slotAppMenuTriggered: &quot;&lt;&lt;action-&gt;data().toString();
+
     if (action-&gt;data().toString() != &quot;&quot;)
         runApplication(action-&gt;data().toString());
 }
@@ -1111,7 +1118,9 @@ void ONMainWindow::plugAppsInTray()
     if (!trayIcon)
         return;
     removeAppsFromTray();
-    x2goDebug&lt;&lt;&quot;plugging apps\n&quot;;
+
+    x2goDebug&lt;&lt;&quot;Plugging apps in tray.&quot;;
+
     bool empty=true;
     topActions.clear();
     foreach(Application app, applications)
@@ -1141,7 +1150,9 @@ void ONMainWindow::removeAppsFromTray()
 {
     if (!trayIcon)
         return;
-    x2goDebug&lt;&lt;&quot;remove apps\n&quot;;
+
+    x2goDebug&lt;&lt;&quot;Removing apps from tray&quot;;
+
     for (int i=0; i&lt;=Application::OTHER; ++i)
     {
         appMenu[i]-&gt;clear();
@@ -1245,13 +1256,13 @@ void ONMainWindow::slotResize ( const QSize sz )
 
 void ONMainWindow::closeClient()
 {
+    x2goInfof(6)&lt;&lt;tr(&quot;Closing x2goclient...&quot;);
     if(trayIcon)
         trayIcon-&gt;hide();
     closeEventSent=true;
     if ( !startMaximized &amp;&amp; !startHidden &amp;&amp; !embedMode )
     {
-        x2goDebug&lt;&lt;&quot;saving settings&quot;;
-
+        x2goDebug&lt;&lt;&quot;Saving settings...&quot;;
         X2goSettings st ( &quot;sizes&quot; );
 
         st.setting()-&gt;setValue ( &quot;mainwindow/size&quot;,
@@ -1260,7 +1271,7 @@ void ONMainWindow::closeClient()
         st.setting()-&gt;setValue ( &quot;mainwindow/maximized&quot;,
                                  QVariant ( isMaximized() ) );
         st.setting()-&gt;sync();
-        x2goDebug&lt;&lt;&quot;done&quot;;
+        x2goDebug&lt;&lt;&quot;Saved  settings.&quot;;
 #ifdef Q_OS_LINUX
         if (image)
             XFreePixmap(QX11Info::display(),image);
@@ -1272,20 +1283,19 @@ void ONMainWindow::closeClient()
     {
         if ( nxproxy-&gt;state() ==QProcess::Running )
         {
-            x2goDebug&lt;&lt;&quot;terminate proxy&quot;;
+            x2goDebug&lt;&lt;&quot;Terminating proxy...&quot;;
             nxproxy-&gt;terminate();
-            x2goDebug&lt;&lt;&quot;done&quot;;
+            x2goDebug&lt;&lt;&quot;Terminated  proxy.&quot;;
         }
-        x2goDebug&lt;&lt;&quot;delete proxy process&quot;;
+        x2goDebug&lt;&lt;&quot;Deleting proxy...&quot;;
         delete nxproxy;
-        x2goDebug&lt;&lt;&quot;done&quot;;
-
+        x2goDebug&lt;&lt;&quot;Deleted  proxy.&quot;;
     }
     if ( sshConnection &amp;&amp; !useLdap)
     {
-        x2goDebug&lt;&lt;&quot;waiting sshConnection to finish\n&quot;;
+        x2goDebug&lt;&lt;&quot;Waiting for the SSH connection to finish...&quot;;
         delete sshConnection;
-        x2goDebug&lt;&lt;&quot;sshConnection is closed\n&quot;;
+        x2goDebug&lt;&lt;&quot;Waited  for the SSH connection to finish.&quot;;
         sshConnection=0;
     }
     if (useLdap)
@@ -1294,51 +1304,29 @@ void ONMainWindow::closeClient()
         {
             if (serverSshConnections[i])
             {
-                x2goDebug&lt;&lt;&quot;waiting sshConnection to finish\n&quot;;
+                x2goDebug&lt;&lt;&quot;Waiting for the SSH connection to finish...&quot;;
                 delete serverSshConnections[i];
-                x2goDebug&lt;&lt;&quot;sshConnection is closed\n&quot;;
+                x2goDebug&lt;&lt;&quot;Waited  for the SSH connection to finish.&quot;;
             }
         }
     }
 
-    /*	if ( tunnel!=0l )
-    	{
-    		x2goDebug&lt;&lt;&quot;delete tunnel&quot;;
-    		delete tunnel;
-    		x2goDebug&lt;&lt;&quot;done&quot;;
-    	}
-    	if ( sndTunnel!=0l )
-    	{
-    		x2goDebug&lt;&lt;&quot;delete snd tunnel&quot;;
-    		delete sndTunnel;
-    		x2goDebug&lt;&lt;&quot;done&quot;;
-    	}
-    	if ( fsTunnel!=0l )
-    	{
-    		x2goDebug&lt;&lt;&quot;delete fs tunnel&quot;;
-    		delete fsTunnel;
-    		x2goDebug&lt;&lt;&quot;done&quot;;
-    	}
-    	*/
     if ( soundServer )
     {
-        x2goDebug&lt;&lt;&quot;delete snd server&quot;;
+        x2goDebug&lt;&lt;&quot;Deleting the sound server...&quot;;
         delete soundServer;
-        x2goDebug&lt;&lt;&quot;done&quot;;
+        x2goDebug&lt;&lt;&quot;Deleted  the sound server.&quot;;
     }
     if ( gpgAgent!=0l )
     {
-        x2goDebug&lt;&lt;&quot;terminate gpg-agent&quot;;
         if ( gpgAgent-&gt;state() ==QProcess::Running )
+        {
+            x2goDebug&lt;&lt;&quot;Terminating gpg-agent...&quot;;
             gpgAgent-&gt;terminate();
-        x2goDebug&lt;&lt;&quot;done&quot;;
-    }
-    /*	if ( useSshAgent )
-    	{
-    		x2goDebug&lt;&lt;&quot;terminate ssh-agent&quot;;
-    		finishSshAgent();
-    		x2goDebug&lt;&lt;&quot;done&quot;;
-    	}*/
+            x2goDebug&lt;&lt;&quot;Terminated  gpg-agent.&quot;;
+        }
+    }
+
 #ifndef Q_OS_WIN
     if ( agentPid.length() &gt;0 )
     {
@@ -1353,13 +1341,15 @@ void ONMainWindow::closeClient()
 #ifdef Q_OS_WIN
     if ( pulseServer )
     {
+        x2goDebug&lt;&lt;&quot;Deleting the pulse timer...&quot;;
         delete pulseTimer;
-
-        x2goDebug&lt;&lt;&quot;terminate pulse&quot;;
+        x2goDebug&lt;&lt;&quot;Deleted  the pulse timer.&quot;;
+        x2goDebug&lt;&lt;&quot;Killing the pulse sound server...&quot;;
         pulseServer-&gt;kill();
-        x2goDebug&lt;&lt;&quot;done\ndelete pulse process&quot;;
+        x2goDebug&lt;&lt;&quot;Killed  the pulse sound server.&quot;;
+        x2goDebug&lt;&lt;&quot;Deleting the pulse process...&quot;;
         delete pulseServer;
-        x2goDebug&lt;&lt;&quot;done&quot;;
+        x2goDebug&lt;&lt;&quot;Deleted  the pulse process.&quot;;
 
         QDir dr ( homeDir );
         dr.remove ( pulseDir+&quot;/config.pa&quot; );
@@ -1369,11 +1359,12 @@ void ONMainWindow::closeClient()
     }
     if ( xorg )
     {
-        x2goDebug&lt;&lt;&quot;terminate xorg&quot;;
+        x2goDebug&lt;&lt;&quot;Terminating xorg...&quot;;
         xorg-&gt;terminate();
-        x2goDebug&lt;&lt;&quot;done\ndelete xorg process&quot;;
+        x2goDebug&lt;&lt;&quot;Terminated  xorg.&quot;;
+        x2goDebug&lt;&lt;&quot;Deleting xorg...&quot;;
         delete xorg;
-        x2goDebug&lt;&lt;&quot;done&quot;;
+        x2goDebug&lt;&lt;&quot;Deleted xorg.&quot;;
     }
 
     if ( winSshdStarted )
@@ -1385,8 +1376,9 @@ void ONMainWindow::closeClient()
 #else
     if ( userSshd &amp;&amp; sshd )
     {
+        x2goDebug&lt;&lt;&quot;Terminating sshd...&quot;;
         sshd-&gt;terminate();
-        x2goDebug&lt;&lt;&quot;terminating userspace sshd&quot;;
+        x2goDebug&lt;&lt;&quot;Terminated  sshd.&quot;;
         delete sshd;
     }
 
@@ -1411,11 +1403,14 @@ void ONMainWindow::closeClient()
         cleanPortable();
     }
     SshMasterConnection::finalizeLibSsh();
+
+    x2goInfof(7)&lt;&lt;tr(&quot;Closed  x2goclient.&quot;);
 }
 
 void ONMainWindow::closeEvent ( QCloseEvent* event )
 {
-    x2goDebug&lt;&lt;&quot;close event&quot;;
+    x2goDebug&lt;&lt;&quot;Close event received.&quot;;
+
     if (trayNoclose &amp;&amp; !brokerMode)
     {
         hide();
@@ -1578,7 +1573,9 @@ void ONMainWindow::displayUsers()
     if ( usePGPCard  &amp;&amp; !PGPInited)
     {
         PGPInited=true;
-        x2goDebug&lt;&lt;&quot;Users loaded, starting smart card daemon\n&quot;;
+
+        x2goDebug&lt;&lt;&quot;Users loaded, starting smart card daemon.&quot;;
+
         QTimer::singleShot ( 10, this, SLOT ( slotStartPGPAuth() ) );
     }
 }
@@ -1738,8 +1735,8 @@ void ONMainWindow::slotPassEnter()
         {
             sPort=sL.front().c_str();
         }
-        x2goDebug&lt;&lt;server.name&lt;&lt;&quot;: ssh port is &quot;&lt;&lt;sPort;
 
+        x2goDebug&lt;&lt;&quot;SSH-Server(&quot;&lt;&lt;server.name&lt;&lt;&quot;) port: &quot;&lt;&lt;sPort;
 
         QString sFactor=&quot;1&quot;;
         list&lt;string&gt; serialNumber=LDAPSession::getStringAttrValues (
@@ -1748,7 +1745,9 @@ void ONMainWindow::slotPassEnter()
         {
             sFactor=serialNumber.front().c_str();
         }
-        x2goDebug&lt;&lt;server.name&lt;&lt;&quot;: factor is &quot;&lt;&lt;sFactor;
+
+        x2goDebug&lt;&lt;&quot;SSH-Server(&quot;&lt;&lt;server.name&lt;&lt;&quot;) factor: &quot;&lt;&lt;sFactor;
+
         server.factor=sFactor.toFloat();
         server.sess=0;
         server.sshPort=sPort;
@@ -2144,10 +2143,16 @@ void ONMainWindow::slotReadSessions()
         st= new X2goSettings( &quot;sessions&quot; );
 
     QStringList slst=st-&gt;setting()-&gt;childGroups();
-    x2goDebug&lt;&lt;&quot;read &quot;&lt;&lt;slst.size()&lt;&lt;&quot; sessions from config file&quot;;
+
+    x2goDebug&lt;&lt;&quot;Reading &quot;&lt;&lt;slst.size()&lt;&lt;&quot; sessions from config file.&quot;;
+
     if (brokerMode &amp;&amp; (slst.size()==0))
     {
-        QMessageBox::critical(this,tr(&quot;Error&quot;),tr(&quot;X2Go sessions not found&quot;));
+        QString error = tr(&quot;No X2Go sessions found, closing.&quot;);
+        if(!startHidden)
+            QMessageBox::critical(this,tr(&quot;Error&quot;),error);
+        else
+            x2goErrorf(1)&lt;&lt;error; // tr(&quot;No X2Go sessions not found, closing.&quot;);
         close();
         return;
     }
@@ -2333,7 +2338,9 @@ void ONMainWindow::displayToolBar ( bool show )
 bool ONMainWindow::initLdapSession ( bool showError )
 {
 #ifdef USELDAP
-    x2goDebug&lt;&lt;&quot;initing LDAP Session&quot;&lt;&lt;endl;
+
+    x2goDebug&lt;&lt;&quot;Initializing LDAP sessions...&quot;;
+
     try
     {
         ld=new LDAPSession ( ldapServer.toStdString(),
@@ -2344,7 +2351,9 @@ bool ONMainWindow::initLdapSession ( bool showError )
         QString message=&quot;Exeption0 in: &quot;;
         message=message+e.err_type.c_str();
         message=message+&quot; : &quot;+e.err_str.c_str();
-        x2goDebug &lt;&lt;message&lt;&lt;endl;
+
+        x2goDebug&lt;&lt;message;
+
         if ( ldapServer1.length() )
         {
             try
@@ -2358,7 +2367,9 @@ bool ONMainWindow::initLdapSession ( bool showError )
                 QString message=&quot;Exeption1 in: &quot;;
                 message=message+e.err_type.c_str();
                 message=message+&quot; : &quot;+e.err_str.c_str();
-                x2goDebug &lt;&lt;message&lt;&lt;endl;
+
+                x2goDebug&lt;&lt;message;
+
                 if ( ldapServer2.length() )
                 {
                     try
@@ -2376,8 +2387,8 @@ bool ONMainWindow::initLdapSession ( bool showError )
                                 e.err_type.c_str();
                         message=message+&quot; : &quot;+
                                 e.err_str.c_str();
-                        x2goDebug &lt;&lt;message&lt;&lt;endl;
-                        x2goDebug&lt;&lt;&quot;return false&quot;&lt;&lt;endl;
+
+                        x2goDebug&lt;&lt;message;
                         if ( showError )
                             QMessageBox::critical (
                                 0l,tr ( &quot;Error&quot; ),
@@ -2386,12 +2397,14 @@ bool ONMainWindow::initLdapSession ( bool showError )
                                 QMessageBox::
                                 NoButton );
 
+                        x2goDebug&lt;&lt;&quot;Returning false, 3rd try failed.&quot;;
                         return false;
                     }
                 }
                 else
                 {
-                    x2goDebug&lt;&lt;&quot;return false&quot;&lt;&lt;endl;
+                    x2goDebug&lt;&lt;&quot;Returning false.&quot;;
+
                     if ( showError )
                         QMessageBox::critical (
                             0l,tr ( &quot;Error&quot; ),
@@ -2405,7 +2418,8 @@ bool ONMainWindow::initLdapSession ( bool showError )
         }
         else
         {
-            x2goDebug&lt;&lt;&quot;return false&quot;&lt;&lt;endl;
+            x2goDebug&lt;&lt;&quot;Returning false.&quot;;
+
             if ( showError )
                 QMessageBox::critical ( 0l,tr ( &quot;Error&quot; ),
                                         message,QMessageBox::Ok,
@@ -2535,6 +2549,7 @@ bool ONMainWindow::initLdapSession ( bool showError )
         }
     }
 #endif
+    x2goDebug&lt;&lt;&quot;Initialized  LDAP sessions.&quot;;
     return true;
 
 }
@@ -2727,7 +2742,7 @@ void ONMainWindow::slotSelectedFromList ( SessionButton* session )
     }
     if ( currentKey != QString::null &amp;&amp; currentKey != &quot;&quot; &amp;&amp; nopass )
     {
-        x2goDebug&lt;&lt;&quot;Have key, starting session&quot;&lt;&lt;endl;
+        x2goDebug&lt;&lt;&quot;Starting session with key.&quot;;
         slotSessEnter();
     }
     if ( cardReady || autologin || krblogin  )
@@ -2762,17 +2777,20 @@ SshMasterConnection* ONMainWindow::startSshConnection ( QString host, QString po
         QString proxylogin, QString proxypassword, QString proxyKey,
         bool proxyAutologin)
 {
-
+    x2goInfof(8)&lt;&lt;tr(&quot;Starting connection to server: &quot;) + host + &quot;:&quot; + port;
     SshMasterConnection* con;
-    x2goDebug&lt;&lt;&quot;start new ssh connection to server:&quot;&lt;&lt;host&lt;&lt;&quot;:&quot;&lt;&lt;port&lt;&lt;&quot;krb: &quot;&lt;&lt;krbLogin&lt;&lt;endl;
+
+    x2goDebug&lt;&lt;&quot;Start new ssh connection to server:&quot;&lt;&lt;host&lt;&lt;&quot;:&quot;&lt;&lt;port&lt;&lt;&quot; krbLogin: &quot;&lt;&lt;krbLogin;
+
     for ( int i=0; i&lt;sshEnv.size(); ++i )
     {
 #ifndef Q_OS_WIN
         QStringList args=sshEnv[i].split ( &quot;=&quot; );
-        x2goDebug&lt;&lt;&quot;set Env &quot;&lt;&lt;args[0]&lt;&lt;&quot; to &quot;&lt;&lt;args[1]&lt;&lt;endl;
+        x2goDebug&lt;&lt;&quot;Setting ENV &quot; + args[0] + tr(&quot; to &quot;) + args[1];
         setenv ( args[0].toAscii(),args[1].toAscii(),1 );
 #else
-        x2goDebug&lt;&lt;&quot;set Env &quot;&lt;&lt;sshEnv[i]&lt;&lt;endl;
+        x2goDebug&lt;&lt;&quot;Set ENV: &quot;&lt;&lt;sshEnv[i];
+
         _putenv ( sshEnv[i].toAscii() );
 #endif
     }
@@ -2813,6 +2831,7 @@ SshMasterConnection* ONMainWindow::startSshConnection ( QString host, QString po
 
 void ONMainWindow::slotSshConnectionError ( QString message, QString lastSessionError )
 {
+    x2goErrorf(2)&lt;&lt; tr(&quot;Connection Error(&quot;) + message + &quot;): &quot; + lastSessionError;
     if ( sshConnection )
     {
         sshConnection-&gt;wait();
@@ -2820,26 +2839,35 @@ void ONMainWindow::slotSshConnectionError ( QString message, QString lastSession
         sshConnection=0l;
     }
 
-    QMessageBox::critical ( 0l,message,lastSessionError,
-                            QMessageBox::Ok,
-                            QMessageBox::NoButton );
-    setEnabled ( true );
-    passForm-&gt;setEnabled ( true );
-    slotShowPassForm();
-    pass-&gt;setFocus();
-    pass-&gt;selectAll();
+    if (!startHidden)
+    {
+        QMessageBox::critical ( 0l,message,lastSessionError,
+                                QMessageBox::Ok,
+                                QMessageBox::NoButton );
+        setEnabled ( true );
+        passForm-&gt;setEnabled ( true );
+        slotShowPassForm();
+        pass-&gt;setFocus();
+        pass-&gt;selectAll();
 
 
-    passForm-&gt;setEnabled ( true );
-    if ( startHidden )
+        passForm-&gt;setEnabled ( true );
+    }
+    else
     {
-        startHidden=false;
-        slotResize();
-        show();
-        activateWindow();
-        raise();
+        // In order to get this interaction free, we need to free this from windows and stuff
+        //    if ( startHidden )
+        //    {
+        //        startHidden=false;
+        //        slotResize();
+        //        show();
+        //        activateWindow();
+        //        raise();
+        //    }
+
+        // completely quit the application
+        trayQuit();
     }
-
 }
 
 
@@ -2847,7 +2875,7 @@ void ONMainWindow::slotSshConnectionError ( QString message, QString lastSession
 
 void ONMainWindow::slotSshConnectionOk()
 {
-    x2goDebug&lt;&lt;&quot;ssh connection ok&quot;&lt;&lt;endl;
+    x2goDebug&lt;&lt;&quot;SSH connection established.&quot;;
     passForm-&gt;setEnabled ( true );
     if ( useLdap )
     {
@@ -2860,14 +2888,19 @@ void ONMainWindow::slotSshConnectionOk()
 
 SshMasterConnection*  ONMainWindow::findServerSshConnection(QString host)
 {
+    x2goDebug&lt;&lt;&quot;Searching for SSH connections...&quot;;
     for (int i=0; i&lt;serverSshConnections.count(); ++i)
     {
         if (serverSshConnections[i])
         {
             if (serverSshConnections[i]-&gt;getHost()==host)
+            {
+                x2goDebug&lt;&lt;&quot;Found SSH connection.&quot;;
                 return serverSshConnections[i];
+            }
         }
     }
+    x2goWarningf(3)&lt;&lt; tr(&quot;Couldn't find a SSH connection.&quot;);
     return 0l;
 }
 
@@ -2876,7 +2909,7 @@ void ONMainWindow::slotServSshConnectionOk(QString server)
     SshMasterConnection* con=findServerSshConnection(server);
     if (!con)
         return;
-    x2goDebug&lt;&lt;&quot;getting sessions on &quot;&lt;&lt;server&lt;&lt;endl;
+    x2goDebug&lt;&lt;&quot;Getting sessions on Host: &quot; + server;
     con-&gt;executeCommand( &quot;export HOSTNAME &amp;&amp; x2golistsessions&quot;, this, SLOT (slotListAllSessions ( bool,QString,int ) ));
 }
 
@@ -2993,6 +3026,21 @@ void ONMainWindow::slotSshUserAuthError ( QString error )
         sshConnection=0l;
     }
 
+    //    if ( startHidden )
+    //    {
+    //        startHidden=false;
+    //        slotResize();
+    //        show();
+    //        activateWindow();
+    //        raise();
+    //    }
+    // hidden means hidden, we'll close the client afterwards.
+    if ( startHidden )
+    {
+        x2goErrorf(3)&lt;&lt; tr(&quot;Authentication failed: &quot;) + error;
+        trayQuit();
+    }
+
     QMessageBox::critical ( 0l,tr ( &quot;Authentication failed&quot; ),error,
                             QMessageBox::Ok,
                             QMessageBox::NoButton );
@@ -3005,14 +3053,6 @@ void ONMainWindow::slotSshUserAuthError ( QString error )
 
 
     passForm-&gt;setEnabled ( true );
-    if ( startHidden )
-    {
-        startHidden=false;
-        slotResize();
-        show();
-        activateWindow();
-        raise();
-    }
 }
 
 void ONMainWindow::slotSessEnter()
@@ -3027,7 +3067,8 @@ void ONMainWindow::slotSessEnter()
     {
         if (!config.brokerAuthenticated)
         {
-            x2goDebug&lt;&lt;&quot;starting broker request&quot;;
+
+            x2goDebug&lt;&lt;&quot;Starting broker request.&quot;;
             slotStartBroker();
             return;
         }
@@ -3060,7 +3101,7 @@ void ONMainWindow::slotSessEnter()
 
 void ONMainWindow::continueNormalSession()
 {
-    x2goDebug&lt;&lt;&quot;continue normal x2go session&quot;&lt;&lt;endl;
+    x2goDebug&lt;&lt;&quot;Continue normal x2go session&quot;;
     if (brokerMode)
     {
         slotListSessions(true,QString::null,0);
@@ -3252,7 +3293,8 @@ bool ONMainWindow::startSession ( const QString&amp; sid )
     if(brokerMode)
     {
         sshPort=config.sshport;
-        x2goDebug&lt;&lt;&quot;server: &quot;&lt;&lt;host;
+
+        x2goDebug&lt;&lt;&quot;Server: &quot;&lt;&lt;host;
     }
 
     QString cmd=st-&gt;setting()-&gt;value ( sid+&quot;/command&quot;,
@@ -3403,9 +3445,24 @@ void ONMainWindow::slotListSessions ( bool result,QString output,
                     message;
         }
 
-        QMessageBox::critical ( 0l,tr ( &quot;Error&quot; ),message,
-                                QMessageBox::Ok,
-                                QMessageBox::NoButton );
+        if ( !startHidden )
+        {
+            QMessageBox::critical ( 0l,tr ( &quot;Error&quot; ),message,
+                                    QMessageBox::Ok,
+                                    QMessageBox::NoButton );
+        }
+        else
+        {
+            QString printout = tr( &quot;Connection failed: &quot;)  + output.toAscii();
+
+            if ( output.indexOf ( &quot;publickey,password&quot; ) !=-1 )
+                x2goErrorf(4)&lt;&lt; tr( &quot;Connection failed: &quot;)  + output + tr(&quot; - Wrong password.&quot;);
+            else
+                x2goErrorf(5)&lt;&lt; tr( &quot;Connection failed: &quot;)  + output;
+            trayQuit();
+        }
+
+
 // 		currentKey=QString::null;
         setEnabled ( true );
         passForm-&gt;setEnabled ( true );
@@ -3424,17 +3481,16 @@ void ONMainWindow::slotListSessions ( bool result,QString output,
     }
     if ( managedMode || brokerMode )
     {
-        x2goDebug&lt;&lt;&quot;sess data:&quot;&lt;&lt;config.sessiondata;
+        x2goDebug&lt;&lt;&quot;Session data: &quot; + config.sessiondata;
         if ( config.sessiondata.indexOf ( &quot;|S|&quot; ) ==-1 )
         {
-            x2goDebug&lt;&lt;&quot;start new managed session&quot;;
+            x2goDebug&lt;&lt;&quot;Starting new managed session.&quot;;
             startNewSession();
         }
         else
         {
-            x2goSession s=getSessionFromString (
-                              config.sessiondata );
-            x2goDebug&lt;&lt;&quot;resuming managed session:&quot;&lt;&lt;s.sessionId;
+            x2goSession s=getSessionFromString (config.sessiondata);
+            x2goDebug&lt;&lt;&quot;Resuming managed session with Id: &quot; + s.sessionId;
             resumeSession ( s );
         }
         return;
@@ -3722,7 +3778,9 @@ void ONMainWindow::startNewSession()
 
     QString geometry;
 #ifdef Q_OS_WIN
-    x2goDebug&lt;&lt;&quot;fullscreen: &quot;&lt;&lt;fullscreen;
+
+    x2goDebug&lt;&lt;&quot;Fullscreen: &quot;&lt;&lt;fullscreen;
+
     maximizeProxyWin=false;
     proxyWinWidth=width;
     proxyWinHeight=height;
@@ -3744,7 +3802,9 @@ void ONMainWindow::startNewSession()
 #ifdef Q_OS_WIN
 //        fullscreen=false;
         maximizeProxyWin=true;
-        x2goDebug&lt;&lt;&quot;maximizeProxyWin: &quot;&lt;&lt;maximizeProxyWin;
+
+        x2goDebug&lt;&lt;&quot;Maximize proxy win: &quot;&lt;&lt;maximizeProxyWin;
+
 #endif
     }
     if ( ! fullscreen )
@@ -3847,7 +3907,9 @@ void ONMainWindow::startNewSession()
              shadowUser+&quot;XSHAD&quot;+shadowDisplay;
     }
     resumingSession.fullscreen=fullscreen;
-    x2goDebug&lt;&lt;cmd&lt;&lt;endl;
+
+    x2goDebug&lt;&lt;&quot;Executing remote command: &quot;&lt;&lt;cmd;
+
     if ( managedMode )
     {
         slotRetResumeSess ( true,config.sessiondata,0 );
@@ -4011,7 +4073,8 @@ void ONMainWindow::resumeSession ( const x2goSession&amp; s )
 #ifdef Q_OS_WIN
 //        fullscreen=false;
         maximizeProxyWin=true;
-        x2goDebug&lt;&lt;&quot;maximizeProxyWin: &quot;&lt;&lt;maximizeProxyWin;
+
+        x2goDebug&lt;&lt;&quot;Maximize proxy win: &quot;&lt;&lt;maximizeProxyWin;
 
 #endif
     }
@@ -4102,10 +4165,10 @@ void ONMainWindow::selectSession ( QStringList&amp; sessions )
     setEnabled ( true );
     sessionStatusDlg-&gt;hide();
     passForm-&gt;hide();
-// 	x2goDebug&lt;&lt;&quot;check type&quot;;
+
     if ( !shadowSession )
     {
-// 		x2goDebug&lt;&lt;&quot;! shadow&quot;;
+        x2goDebug&lt;&lt;&quot;No shadow session.&quot;;
         if ( !miniMode )
             selectSesDlgLayout-&gt;setContentsMargins ( 25,25,10,10 );
 
@@ -4114,13 +4177,13 @@ void ONMainWindow::selectSession ( QStringList&amp; sessions )
         bTerm-&gt;show();
         sOk-&gt;show();
         sCancel-&gt;show();
-// 		x2goDebug&lt;&lt;&quot;standart buttons ok&quot;;
+
         desktopFilter-&gt;hide();
         desktopFilterCb-&gt;hide();
         bShadow-&gt;hide();
         bShadowView-&gt;hide();
         bCancel-&gt;hide();
-// 		x2goDebug&lt;&lt;&quot;shadow buttons ok&quot;;
+
 // 		model-&gt;clear();
         model-&gt;removeRows ( 0,model-&gt;rowCount() );
         selectSessionLabel-&gt;setText ( tr ( &quot;Select session:&quot; ) );
@@ -4128,10 +4191,9 @@ void ONMainWindow::selectSession ( QStringList&amp; sessions )
         QFontMetrics fm ( sessTv-&gt;font() );
         for ( int row = 0; row &lt; sessions.size(); ++row )
         {
-
-// 			x2goDebug&lt;&lt;&quot;decoding sessionstr:&quot;&lt;&lt;sessions[row];
+            x2goDebug&lt;&lt;&quot;Decoding Sessionstring:&quot; + sessions[row];
             x2goSession s=getSessionFromString ( sessions[row] );
-// 			x2goDebug&lt;&lt;&quot;listing id:&quot;&lt;&lt;s.sessionId;
+
             selectedSessions.append ( s );
             QStandardItem *item;
 
@@ -4416,13 +4478,18 @@ void ONMainWindow::slotTermSessFromSt()
 #ifdef Q_OS_LINUX
     if (directRDP)
     {
-        x2goDebug&lt;&lt;&quot;terminating direct RDP session&quot;;
+
+        x2goDebug&lt;&lt;&quot;Terminating direct RDP session.&quot;;
+
         nxproxy-&gt;terminate();
         proxyRunning=false;
         return;
     }
 #endif
-    /*	x2goDebug &lt;&lt;&quot;disconnect export&quot;&lt;&lt;endl;
+
+    x2goDebug&lt;&lt;&quot;Disconnect export.&quot;;
+
+    /*
     	disconnect ( sbExp,SIGNAL ( clicked() ),this,
     	             SLOT ( slot_exportDirectory() ) );*/
     sbExp-&gt;setEnabled ( false );
@@ -4564,7 +4631,9 @@ void ONMainWindow::slotRetResumeSess ( bool result,
                                        QString output,
                                        int )
 {
-    x2goDebug&lt;&lt;&quot;Agent output:&quot;&lt;&lt;output;
+
+    x2goDebug&lt;&lt;&quot;Agent output: &quot;&lt;&lt;output;
+
     if ( result==false )
     {
         QString message=tr ( &quot;&lt;b&gt;Connection failed&lt;/b&gt;\n&quot; ) +output;
@@ -4720,17 +4789,23 @@ void ONMainWindow::slotRetResumeSess ( bool result,
             if (line.indexOf(&quot;gr_port=&quot;)!=-1)
             {
                 resumingSession.grPort=line.replace(&quot;gr_port=&quot;,&quot;&quot;);
-                x2goDebug&lt;&lt;&quot;new gr_port: &quot;&lt;&lt;resumingSession.grPort&lt;&lt;endl;
+
+                x2goDebug&lt;&lt;&quot;New gr_port: &quot;&lt;&lt;resumingSession.grPort;
+
             }
             if (line.indexOf(&quot;sound_port=&quot;)!=-1)
             {
                 resumingSession.sndPort=line.replace(&quot;sound_port=&quot;,&quot;&quot;);
-                x2goDebug&lt;&lt;&quot;new sound_port: &quot;&lt;&lt;resumingSession.sndPort&lt;&lt;endl;
+
+                x2goDebug&lt;&lt;&quot;New sound_port: &quot;&lt;&lt;resumingSession.sndPort;
+
             }
             if (line.indexOf(&quot;fs_port=&quot;)!=-1)
             {
                 resumingSession.fsPort=line.replace(&quot;fs_port=&quot;,&quot;&quot;);
-                x2goDebug&lt;&lt;&quot;new fs_port: &quot;&lt;&lt;resumingSession.fsPort&lt;&lt;endl;
+
+                x2goDebug&lt;&lt;&quot;New fs_port: &quot;&lt;&lt;resumingSession.fsPort;
+
             }
         }
         if (resumingSession.published)
@@ -4831,13 +4906,13 @@ void ONMainWindow::slotRetResumeSess ( bool result,
             }
 #endif
             if ( sysPulse )
-
+            {
                 sshConnection-&gt;copyFile(
                     &quot;/var/run/pulse/.pulse-cookie&quot;,
                     &quot;~/.x2go/C-&quot;+
                     resumingSession.sessionId+
                     &quot;/.pulse-cookie&quot;, this, SLOT ( slotPCookieReady ( bool, QString,int )));
-
+            }
             else
             {
 #ifndef Q_OS_WIN
@@ -4942,7 +5017,9 @@ void ONMainWindow::slotTunnelOk(int)
     //waiting for X
     if ( !winServersReady )
     {
-        x2goDebug&lt;&lt;&quot;waiting for win-servers&quot;;
+
+        x2goDebug&lt;&lt;&quot;Waiting for win-servers.&quot;;
+
         QTimer::singleShot ( 100, this, SLOT ( slotTunnelOk() ) );
         return;
     }
@@ -4955,9 +5032,13 @@ void ONMainWindow::slotTunnelOk(int)
     if ( !d.exists() )
         if ( !d.mkpath ( dirpath ) )
         {
-            QString message=tr ( &quot;Unable to create folder:&quot; ) +
-                            dirpath;
-            QMessageBox::critical ( 0l,tr ( &quot;Error&quot; ),message,
+            if (startHidden)
+            {
+                x2goErrorf(6)&lt;&lt; tr( &quot;Unable to create folder: &quot;)  + dirpath;
+                trayQuit();
+            }
+
+            QMessageBox::critical ( 0l,tr ( &quot;Error&quot; ), tr ( &quot;Unable to create folder: &quot; ) + dirpath,
                                     QMessageBox::Ok,
                                     QMessageBox::NoButton );
             slotShowPassForm();
@@ -4981,9 +5062,13 @@ void ONMainWindow::slotTunnelOk(int)
     QFile file ( dirpath+&quot;/options&quot; );
     if ( !file.open ( QIODevice::WriteOnly | QIODevice::Text ) )
     {
-        QString message=tr ( &quot;Unable to write file:&quot; ) +
-                        dirpath+&quot;/options&quot;;
-        QMessageBox::critical ( 0l,tr ( &quot;Error&quot; ),message,
+        if (startHidden)
+        {
+            x2goErrorf(7)&lt;&lt; tr( &quot;Unable to write file: &quot; ) + dirpath + &quot;/options&quot;;
+            trayQuit();
+        }
+
+        QMessageBox::critical ( 0l,tr ( &quot;Error&quot; ), tr( &quot;Unable to write file: &quot; ) + dirpath + &quot;/options&quot;,
                                 QMessageBox::Ok,
                                 QMessageBox::NoButton );
         slotShowPassForm();
@@ -5014,6 +5099,7 @@ void ONMainWindow::slotTunnelOk(int)
     for ( int l=0; l&lt;env.size(); ++l )
     {
 // 		x2goDebug&lt;&lt;env[l]&lt;&lt;endl;
+
         if ( env[l].indexOf ( &quot;X2GO_LIB&quot; ) ==0 )
         {
             x2golibpath=env[l].split ( &quot;=&quot; ) [1];
@@ -5043,13 +5129,17 @@ void ONMainWindow::slotTunnelOk(int)
     if ( dispInd==-1 )
     {
         env &lt;&lt;&quot;DISPLAY=localhost:&quot;+disp;
+
         /*		x2goDebug&lt;&lt;&quot;new env DISPLAY&quot;&lt;&lt;&quot;DISPLAY=localhost:&quot;+disp&lt;&lt;endl;*/
+
     }
     else
     {
         env[dispInd]=&quot;DISPLAY=localhost:&quot;+disp;
+
         /*		x2goDebug&lt;&lt;&quot;existing env DISPLAY(&quot;&lt;&lt;dispInd&lt;&lt;
         		&quot;) DISPLAY=localhost:&quot;+disp&lt;&lt;endl;*/
+
     }
 #endif // Q_OS_WIN
 #if defined ( Q_OS_DARWIN )
@@ -5066,17 +5156,14 @@ void ONMainWindow::slotTunnelOk(int)
     }
     if (dispInd == -1)
     {
-        x2goDebug &lt;&lt; &quot;No DISPLAY variable found in global environment, using autodetected setting.&quot;;
+
+        x2goDebug&lt;&lt; &quot;No DISPLAY variable found in global environment, using autodetected setting.&quot;;
+
         env.append (&quot;DISPLAY=&quot; + disp);
     }
 #endif
     nxproxy-&gt;setEnvironment ( env );
-    /*	x2goDebug&lt;&lt;&quot;new env:&quot;&lt;&lt;endl;
-    	for ( int l=0;l&lt;env.size();++l )
-    	{
-    		x2goDebug&lt;&lt;env[l]&lt;&lt;endl;
-    	}
-    	x2goDebug&lt;&lt;&quot;##########################&quot;&lt;&lt;endl;*/
+
     connect ( nxproxy,SIGNAL ( error ( QProcess::ProcessError ) ),this,
               SLOT ( slotProxyError ( QProcess::ProcessError ) ) );
     connect ( nxproxy,SIGNAL ( finished ( int,QProcess::ExitStatus ) ),this,
@@ -5095,7 +5182,9 @@ void ONMainWindow::slotTunnelOk(int)
     dir.cd ( &quot;exe&quot; );
     proxyCmd=&quot;\&quot;&quot;+dir.absolutePath() +&quot;/\&quot;&quot;+proxyCmd;
 #endif //Q_OS_DARWIN
-    x2goDebug&lt;&lt;&quot;starting nxproxy with: &quot;&lt;&lt;proxyCmd&lt;&lt;endl;
+
+    x2goDebug&lt;&lt;&quot;Starting NX proxy, command: &quot; + proxyCmd;
+
     nxproxy-&gt;start ( proxyCmd );
     proxyRunning=true;
 //always search for proxyWin
@@ -5216,7 +5305,8 @@ void ONMainWindow::slotProxyFinished ( int,QProcess::ExitStatus )
     if ( spoolTimer )
         delete spoolTimer;
 
-    x2goDebug&lt;&lt;&quot;deleting proxy&quot;&lt;&lt;endl;
+    x2goDebug&lt;&lt;&quot;Deleting Proxy.&quot; ;
+
     disconnect ( nxproxy,SIGNAL ( error ( QProcess::ProcessError ) ),this,
                  SLOT ( slotProxyError ( QProcess::ProcessError ) ) );
     disconnect ( nxproxy,SIGNAL ( finished ( int,QProcess::ExitStatus ) ),this,
@@ -5241,7 +5331,7 @@ void ONMainWindow::slotProxyFinished ( int,QProcess::ExitStatus )
     if(proxyErrString.indexOf(&quot;No data received from remote proxy&quot;)!=-1)
     {
         emergencyExit=true;
-        x2goDebug&lt;&lt;&quot;Emergency exit&quot;&lt;&lt;endl;
+        x2goWarningf(4)&lt;&lt; tr( &quot;Emergency exit.&quot; );
     }
 
 #if ! (defined (CFGPLUGIN))
@@ -5250,21 +5340,22 @@ void ONMainWindow::slotProxyFinished ( int,QProcess::ExitStatus )
         if ( nxproxy-&gt;state() ==QProcess::Running )
         {
             emergencyExit=true;
-            x2goDebug&lt;&lt;&quot;waiting for proxy to exit&quot;&lt;&lt;endl;
+            x2goWarningf(5)&lt;&lt; tr( &quot;Waiting for proxy to exit.&quot; );
             if ( !nxproxy-&gt;waitForFinished ( 3000 ) )
             {
-                x2goDebug&lt;&lt;&quot;Failed, try to kill&quot;&lt;&lt;endl;
+                x2goWarningf(6)&lt;&lt; tr( &quot;Failed, killing the proxy.&quot; );
                 nxproxy-&gt;kill();
             }
         }
-        x2goDebug&lt;&lt;&quot;nxproxy not running&quot;&lt;&lt;endl;
+
 #ifdef Q_OS_LINUX
         if (directRDP)
             nxproxy=0;
 #endif
     }
 #endif
-    x2goDebug&lt;&lt;&quot;proxy deleted&quot;&lt;&lt;endl;
+    x2goDebug&lt;&lt;&quot;Waiting for proxy to exit.&quot;;
+
     spoolTimer=0l;
     tunnel=sndTunnel=fsTunnel=0l;
     soundServer=0l;
@@ -5283,14 +5374,14 @@ void ONMainWindow::slotProxyFinished ( int,QProcess::ExitStatus )
     if ( !emergencyExit &amp;&amp; !shadowSession &amp;&amp; !usePGPCard &amp;&amp; ! ( embedMode &amp;&amp;
             ( config.checkexitstatus==false ) ) )
     {
-        x2goDebug&lt;&lt;&quot;checking exit status&quot;;
+        x2goDebug&lt;&lt;&quot;Checking exit status.&quot;;
         check_cmd_status();
     }
     else
     {
-        x2goDebug&lt;&lt;&quot;deleting sshConnection instance: &quot;&lt;&lt;endl;
+        x2goDebug&lt;&lt;&quot;Deleting SSH connection instance.&quot;;
         delete sshConnection;
-        x2goDebug&lt;&lt;&quot;done&quot;&lt;&lt;endl;
+        x2goDebug&lt;&lt;&quot;Deleted  SSH connection instance.&quot; ;
         sshConnection=0;
         if ( startHidden )
         {
@@ -5330,6 +5421,7 @@ void ONMainWindow::slotProxyFinished ( int,QProcess::ExitStatus )
         sessionStatusDlg-&gt;hide();
         resumeSession ( resumingSession );
     }
+    x2goDebug&lt;&lt;&quot;Finished Proxy.&quot;;
     setStatStatus ( tr ( &quot;Finished&quot; ) );
 }
 
@@ -5340,7 +5432,9 @@ void ONMainWindow::slotProxyStderr()
     if ( nxproxy )
         reserr= nxproxy-&gt;readAllStandardError();
     proxyErrString+=reserr;
-    x2goDebug&lt;&lt;reserr&lt;&lt;endl;
+
+    x2goDebug&lt;&lt;&quot;Proxy wrote on stderr: &quot;&lt;&lt;reserr;
+
     stInfo-&gt;insertPlainText ( reserr );
     stInfo-&gt;ensureCursorVisible();
     if ( stInfo-&gt;toPlainText().indexOf (
@@ -5427,7 +5521,9 @@ void ONMainWindow::slotProxyStderr()
 #if defined( Q_OS_WIN ) &amp;&amp; defined (CFGPLUGIN)
     if ( reserr.indexOf ( &quot;Session terminated at&quot; ) !=-1 )
     {
-        x2goDebug&lt;&lt;&quot;proxy finished&quot;&lt;&lt;endl;
+
+        x2goDebug&lt;&lt;&quot;Proxy finished.&quot;;
+
         slotProxyFinished ( 0, QProcess::NormalExit );
     }
 #endif
@@ -5439,8 +5535,8 @@ void ONMainWindow::slotProxyStderr()
 void ONMainWindow::slotProxyStdout()
 {
     QString resout ( nxproxy-&gt;readAllStandardOutput() );
-    x2goDebug&lt;&lt;resout&lt;&lt;endl;
 
+    x2goDebug&lt;&lt;&quot;Proxy wrote on stdout: &quot;&lt;&lt;resout;
 }
 
 
@@ -5594,7 +5690,7 @@ bool ONMainWindow::termSession ( QString sessId, bool warn )
         nxproxy-&gt;terminate();
         return true;
     }
-
+    x2goDebug&lt;&lt;&quot;Terminating session.&quot;;
     sshConnection-&gt;executeCommand ( &quot;x2goterminate-session &quot;+sessId, this, SLOT ( slotRetTermSess ( bool,
                                     QString,int) )  );
     proxyRunning=false;
@@ -5976,13 +6072,15 @@ void ONMainWindow::slotReadApplications(bool result, QString output,
             if (line.indexOf(&quot;Name[&quot;+localshort+&quot;]=&quot;)!=-1  || line.indexOf(&quot;Name[&quot;+locallong+&quot;]=&quot;)!=-1)
             {
                 app.name=QString::fromUtf8(line.split(&quot;=&quot;)[1].toAscii());
-//                 x2goDebug&lt;&lt;&quot;local name: &quot;&lt;&lt;app.name&lt;&lt;endl;
+
+                //                 x2goDebug&lt;&lt;&quot;local name: &quot;&lt;&lt;app.name&lt;&lt;endl;
+
                 localname=true;
             }
             if (line.indexOf(&quot;Comment[&quot;+localshort+&quot;]=&quot;)!=-1 || line.indexOf(&quot;Comment[&quot;+locallong+&quot;]=&quot;)!=-1)
             {
                 app.comment=QString::fromUtf8(line.split(&quot;=&quot;)[1].toAscii());
-//                 x2goDebug&lt;&lt;&quot;local comment: &quot;&lt;&lt;app.comment&lt;&lt;endl;
+                //                 x2goDebug&lt;&lt;&quot;local comment: &quot;&lt;&lt;app.comment&lt;&lt;endl;
                 localcomment=true;
             }
             if (line.indexOf(&quot;Name=&quot;)!=-1 &amp;&amp; !localname)
@@ -5990,12 +6088,12 @@ void ONMainWindow::slotReadApplications(bool result, QString output,
                 app.name=line.split(&quot;=&quot;)[1];
                 if (app.name==autostartApp)
                     startAppFound=true;
-//                 x2goDebug&lt;&lt;&quot;name: &quot;&lt;&lt;app.name&lt;&lt;endl;
+                //                 x2goDebug&lt;&lt;&quot;name: &quot;&lt;&lt;app.name&lt;&lt;endl;
             }
             if (line.indexOf(&quot;Comment=&quot;)!=-1 &amp;&amp; !localcomment)
             {
                 app.comment=line.split(&quot;=&quot;)[1];
-//                 x2goDebug&lt;&lt;&quot;comment: &quot;&lt;&lt;app.comment&lt;&lt;endl;
+                //                 x2goDebug&lt;&lt;&quot;comment: &quot;&lt;&lt;app.comment&lt;&lt;endl;
             }
             if (line.indexOf(&quot;Exec=&quot;)!=-1)
             {
@@ -6006,7 +6104,7 @@ void ONMainWindow::slotReadApplications(bool result, QString output,
                 app.exec.replace(&quot;%u&quot;,&quot;&quot;,Qt::CaseInsensitive);
                 if (app.exec==autostartApp)
                     startAppFound=true;
-//                 x2goDebug&lt;&lt;&quot;exec: &quot;&lt;&lt;app.exec&lt;&lt;endl;
+                //                 x2goDebug&lt;&lt;&quot;exec: &quot;&lt;&lt;app.exec&lt;&lt;endl;
             }
             if (line.indexOf(&quot;Categories=&quot;)!=-1)
             {
@@ -6073,10 +6171,13 @@ void ONMainWindow::slotReadApplications(bool result, QString output,
     plugAppsInTray();
     if (runStartApp &amp;&amp; autostartApp.length()&gt;1)
     {
-        if (!startAppFound)
-            x2goDebug&lt;&lt;&quot;Autostart application &quot;&lt;&lt;autostartApp&lt;&lt; &quot; not found in Desktop files&quot;&lt;&lt;endl;
+        if (!startAppFound) {
+            x2goDebug&lt;&lt;&quot;Autostart application &quot;&lt;&lt;autostartApp&lt;&lt; &quot; not found in Desktop files.&quot;;
+        }
         else
+        {
             runApplication(autostartApp);
+        }
     }
 }
 
@@ -6095,6 +6196,12 @@ bool ONMainWindow::parseParameter ( QString param )
         return false;
     }
 
+    if (param == &quot;--debug&quot;)
+    {
+        ONMainWindow::debugging = true;
+        return true;
+    }
+
     if ( param == &quot;--portable&quot; )
     {
         ONMainWindow::portable=true;
@@ -6409,10 +6516,11 @@ bool ONMainWindow::parseParameter ( QString param )
         if (find!=-1 &amp;&amp; lind !=-1)
         {
             QString label=value.mid(find+1,lind-find-1);
-            x2goDebug&lt;&lt; &quot;searching for drive with label: &quot;&lt;&lt;label;
+            x2goDebug&lt;&lt;&quot;Searching for drive with label: &quot;&lt;&lt;label;
+
             QString drive=wapiGetDriveByLabel(label);
             value.replace(&quot;(&quot;+label+&quot;)&quot;,drive);
-            x2goDebug&lt;&lt;&quot;new path: &quot;&lt;&lt;value;
+            x2goDebug&lt;&lt;&quot;New path: &quot;&lt;&lt;value;
         }
 #endif
         if (! dr.exists(value))
@@ -6629,11 +6737,15 @@ bool ONMainWindow::packParameter ( QString val )
 
 void ONMainWindow::printError ( QString param )
 {
-    qCritical ( &quot;%s&quot;, ( tr ( &quot;wrong parameter: &quot; ) +param ).
-                toLocal8Bit().data() );
-#ifdef Q_OS_WIN
-    x2goDebug&lt;&lt;tr ( &quot;wrong parameter: &quot; ) +param &lt;&lt;endl;
-#endif
+    if( !startHidden )
+    {
+        qCritical ( &quot;%s&quot;, ( tr ( &quot;Wrong parameter: &quot; ) +param ).
+                    toLocal8Bit().data() );
+    }
+    else
+    {
+        x2goErrorf(8)&lt;&lt;tr(&quot;Wrong parameter: &quot;)&lt;&lt;param;
+    }
 }
 
 void ONMainWindow::showHelp()
@@ -6643,6 +6755,7 @@ void ONMainWindow::showHelp()
         &quot;Options:\n&quot;
         &quot;--help\t\t\t\t show this message\n&quot;
         &quot;--help-pack\t\t\t show available pack methods\n&quot;
+        &quot;--debug\t\t\t\t enables extensive output for console output.\n&quot;
         &quot;--no-menu\t\t\t hide menu bar\n&quot;
         &quot;--no-session-edit\t\t not allow user to edit preconfigured\n&quot;
         &quot;\t\t\t\t sessions\n&quot;
@@ -6667,7 +6780,7 @@ void ONMainWindow::showHelp()
         &quot;--command=&lt;cmd&gt;\t\t\t Set default command, default value 'KDE'\n&quot;
         &quot;--session=&lt;session&gt;\t\t Start session 'session'\n&quot;
         &quot;--user=&lt;username&gt;\t\t select user 'username'\n&quot;
-        &quot;--geomerty=&lt;W&gt;x&lt;H&gt;|fullscreen\t set default geometry, default &quot;
+        &quot;--geometry=&lt;W&gt;x&lt;H&gt;|fullscreen\t set default geometry, default &quot;
         &quot;value '800x600'\n&quot;
         &quot;--dpi=&lt;dpi&gt;\t\t\t set dpi of x2goagent to dpi, default set to same as local display\n&quot;
         &quot;--link=&lt;modem|isdn|adsl|wan|lan&gt; set default link type, &quot;
@@ -6683,7 +6796,10 @@ void ONMainWindow::showHelp()
         &quot;applications\&quot; mode\n&quot;
         &quot;--session-conf=&lt;file&gt;\t\t path to alternative session config\n&quot;;
     qCritical ( &quot;%s&quot;,helpMsg.toLocal8Bit().data() );
-    QMessageBox::information ( this,tr ( &quot;Options&quot; ),helpMsg );
+    if (!startHidden)
+    {
+        QMessageBox::information ( this,tr ( &quot;Options&quot; ),helpMsg );
+    }
 }
 
 void ONMainWindow::showHelpPack()
@@ -6755,10 +6871,12 @@ void ONMainWindow::slotGetServers ( bool result, QString output,
                     x2goServers[j].sess=
                         lst[1].toInt() *
                         x2goServers[j].factor;
+
                     x2goDebug&lt;&lt;x2goServers[j].name&lt;&lt;
                              &quot;: sessions &quot;&lt;&lt;
                              lst[1].toInt() &lt;&lt;
                              &quot;, multiplied &quot;&lt;&lt;x2goServers[j].sess;
+
                     break;
                 }
         }
@@ -6832,22 +6950,26 @@ void ONMainWindow::slotListAllSessions ( bool result,QString output,
                 ( listedSessions.size() ==1 &amp;&amp;
                   listedSessions[0].length() &lt;5 ) )
         {
-// 	x2goDebug&lt;&lt;&quot;start New Session&quot;;
+            x2goDebug&lt;&lt;&quot;Start new session.&quot;;
             startNewSession();
         }
         else if ( listedSessions.size() ==1 )
         {
-// 	x2goDebug&lt;&lt;&quot;have one session&quot;;
+            x2goDebug&lt;&lt;&quot;Already having a session.&quot;;
             x2goSession s=getSessionFromString (
                               listedSessions[0] );
-// 		x2goDebug&lt;&lt;&quot;will procceed one session&quot;;
+
+            x2goDebug&lt;&lt;&quot;Will procceed with session.&quot;;
+
             QDesktopWidget wd;
             if ( s.status==&quot;S&quot; &amp;&amp; isColorDepthOk (
                         wd.depth(),s.colorDepth ) )
+            {
                 resumeSession ( s );
+            }
             else
             {
-// 				x2goDebug&lt;&lt;&quot;select one Session&quot;;
+                x2goDebug&lt;&lt;&quot;Please select one session...&quot;;
                 selectSession ( listedSessions );
             }
         }
@@ -6932,7 +7054,8 @@ void ONMainWindow::exportDirs ( QString exports,bool removable )
     dr.dirList=exports;
     dr.key=createRSAKey();
     QString passwd;
-    x2goDebug&lt;&lt;&quot;key created on: &quot;&lt;&lt;dr.key;
+
+    x2goDebug&lt;&lt;&quot;Key created on: &quot;&lt;&lt;dr.key;
 
     passwd=getCurrentPass();
 
@@ -7099,15 +7222,17 @@ QString ONMainWindow::createRSAKey()
 
     QStringList args;
 
-    args&lt;&lt;&quot;-t&quot;&lt;&lt;&quot;rsa&quot;&lt;&lt;&quot;-b&quot;&lt;&lt;&quot;1024&quot;&lt;&lt;&quot;-N&quot;&lt;&lt;&quot;&quot;&lt;&lt;&quot;-f&quot;&lt;&lt;keyName;
-// 	x2goDebug &lt;&lt;keyName&lt;&lt;endl;
+    args&lt;&lt;&quot;-t&quot;&lt;&lt;&quot;rsa&quot;&lt;&lt;&quot;-b&quot;&lt;&lt;&quot;1024&quot;&lt;&lt;&quot;-N&quot;&lt;&lt;&quot;&quot;&lt;&lt;&quot;-f&quot;&lt;&lt;keyName&lt;&lt;&quot;-q&quot;;
+
+    x2goDebug&lt;&lt;&quot;ssh-keygen &quot; + args.join(&quot; &quot;);
 
     if ( QProcess::execute ( &quot;ssh-keygen&quot;,args ) !=0 )
     {
-        x2goDebug &lt;&lt;&quot;ssh-keygen failed&quot; &lt;&lt;endl;
+        x2goDebug&lt;&lt;&quot;ssh-keygen failed.&quot; &lt;&lt;endl;
         return QString::null;
     }
-// 	x2goDebug &lt;&lt;&quot;ssh-keygen ok&quot; &lt;&lt;endl;
+    x2goDebug&lt;&lt;&quot;ssh-keygen succeeded.&quot;;
+
 
     QFile rsa ( &quot;/etc/ssh/ssh_host_rsa_key.pub&quot; );
 #ifdef Q_OS_WIN
@@ -7143,7 +7268,7 @@ QString ONMainWindow::createRSAKey()
         rsa_pub = rsa.readLine();
     else
     {
-        x2goDebug&lt;&lt;&quot;error: rsa file empty&quot;;
+        x2goErrorf(9)&lt;&lt;tr(&quot;RSA file empty.&quot;);
         return QString::null;
     }
 
@@ -7152,7 +7277,7 @@ QString ONMainWindow::createRSAKey()
                 QIODevice::WriteOnly | QIODevice::Text | QIODevice::Append )
        )
     {
-        x2goDebug&lt;&lt;&quot;error openning key:&quot;&lt;&lt;keyName;
+        x2goErrorf(10)&lt;&lt;tr(&quot;Can not open key: &quot;)&lt;&lt;keyName;
         return keyName;
     }
     QTextStream out ( &amp;file );
@@ -7164,9 +7289,12 @@ QString ONMainWindow::createRSAKey()
 void ONMainWindow::slotCopyKey ( bool result, QString output, int pid)
 {
     fsExportKey=sshConnection-&gt;getSourceFile(pid);
-    x2goDebug&lt;&lt;&quot;exported key &quot;&lt;&lt;fsExportKey;
+
+    x2goDebug&lt;&lt;&quot;Exported key: &quot;&lt;&lt;fsExportKey;
+
     QFile::remove ( fsExportKey );
-    x2goDebug&lt;&lt;&quot;key removed&quot;;
+    x2goDebug&lt;&lt;&quot;Key removed.&quot;;
+
     if ( result==false )
     {
         QString message=tr ( &quot;&lt;b&gt;Connection failed&lt;/b&gt;\n&quot; ) +output;
@@ -7176,9 +7304,23 @@ void ONMainWindow::slotCopyKey ( bool result, QString output, int pid)
                     message;
         }
 
-        QMessageBox::critical ( 0l,tr ( &quot;Error&quot; ),message,
-                                QMessageBox::Ok,
-                                QMessageBox::NoButton );
+        if (!startHidden)
+        {
+            QMessageBox::critical ( 0l,tr ( &quot;Error&quot; ),message,
+                                    QMessageBox::Ok,
+                                    QMessageBox::NoButton );
+        }
+        else
+        {
+            QString printout = tr( &quot;Connection failed: &quot;)  + output.toAscii();
+
+            if ( output.indexOf ( &quot;publickey,password&quot; ) !=-1 )
+                x2goErrorf(11)&lt;&lt; tr( &quot;Connection failed: &quot;)  + output + tr(&quot; - Wrong password.&quot;);
+            else
+                x2goErrorf(12)&lt;&lt; tr( &quot;Connection failed: &quot;)  + output;
+            trayQuit();
+        }
+
         QFile::remove ( fsExportKey+&quot;.pub&quot; );
         return;
     }
@@ -7246,7 +7388,9 @@ void ONMainWindow::slotRetExportDir ( bool result,QString output,
 #ifdef Q_OS_WIN
     QDir dir;
     dir.mkpath ( authofname+&quot;\\.x2go\\.ssh&quot; );
-    x2goDebug&lt;&lt;&quot;Creating &quot;&lt;&lt;authofname+&quot;\\.x2go\\.ssh&quot;&lt;&lt;endl;
+
+    x2goDebug&lt;&lt;&quot;Creating &quot;&lt;&lt;authofname+&quot;\\.x2go\\.ssh&quot;;
+
     authofname=wapiShortFileName ( authofname ) +&quot;/.x2go&quot;;
 #endif
     authofname+=&quot;/.ssh/authorized_keys&quot; ;
@@ -7302,13 +7446,15 @@ void ONMainWindow::slotExtTimer()
             ( QFile::ReadUser|QFile::WriteUser|QFile::ExeUser|
               QFile::ReadOwner|QFile::WriteOwner|QFile::ExeOwner ) )
     {
-        x2goDebug &lt;&lt;&quot;Wrong permissions on &quot;&lt;&lt;readLoginsFrom &lt;&lt;&quot;:&quot;&lt;&lt;endl;
-        x2goDebug &lt;&lt; ( int ) ( QFile::permissions (
+
+        x2goDebug&lt;&lt;&quot;Wrong permissions on &quot;&lt;&lt;readLoginsFrom &lt;&lt;&quot;:&quot;;
+        x2goDebug&lt;&lt; ( int ) ( QFile::permissions (
                                    readLoginsFrom+&quot;/.&quot; ) )
                   &lt;&lt;&quot;must be&quot;&lt;&lt; ( int ) ( QFile::ReadUser|QFile::WriteUser
                                           |QFile::ExeUser|QFile::ReadOwner|
                                           QFile::WriteOwner|
                                           QFile::ExeOwner ) &lt;&lt;endl;
+
         if ( extLogin )
             extTimer-&gt;stop();
         return;
@@ -7338,9 +7484,9 @@ void ONMainWindow::slotExtTimer()
                 }
                 if ( args[0]==&quot;logout&quot; )
                 {
-                    x2goDebug &lt;&lt;
-                              &quot; I HAVE external logout&quot;&lt;&lt;
-                              endl;
+
+                    x2goDebug&lt;&lt;&quot;External logout.&quot;;
+
                     args[1].replace ( &quot;\n&quot;,&quot;&quot; );
                     if ( args[1].size() )
                         logoutDir=args[1];
@@ -7354,7 +7500,7 @@ void ONMainWindow::slotExtTimer()
     {
         if ( logoutDir != QString::null )
         {
-            x2goDebug &lt;&lt;&quot;external logout&quot;&lt;&lt;endl;
+            x2goDebug&lt;&lt;&quot;External logout received&quot;;
             externalLogout ( logoutDir );
         }
     }
@@ -7362,7 +7508,7 @@ void ONMainWindow::slotExtTimer()
     {
         if ( loginDir != QString::null )
         {
-            x2goDebug &lt;&lt;&quot;external login&quot;&lt;&lt;endl;
+            x2goDebug&lt;&lt;&quot;External login.&quot;;
             externalLogin ( loginDir );
         }
     }
@@ -7377,9 +7523,10 @@ void ONMainWindow::slotExportTimer()
             QFile::ExeUser|
             QFile::ReadOwner|QFile::WriteOwner|QFile::ExeOwner ) )
     {
-        x2goDebug &lt;&lt;&quot;Wrong permissions on &quot;&lt;&lt;
+
+        x2goDebug&lt;&lt;&quot;Wrong permissions on &quot;&lt;&lt;
                   readExportsFrom &lt;&lt;&quot;:&quot;&lt;&lt;endl;
-        x2goDebug &lt;&lt; ( int ) ( QFile::permissions (
+        x2goDebug&lt;&lt; ( int ) ( QFile::permissions (
                                    readExportsFrom+&quot;/.&quot; ) )
                   &lt;&lt;&quot;must be&quot;&lt;&lt; ( int ) ( QFile::ReadUser|QFile::WriteUser
                                           |QFile::ExeUser|QFile::ReadOwner|
@@ -7713,7 +7860,9 @@ void ONMainWindow::slotScDaemonError()
 {
     QString stdOut ( scDaemon-&gt;readAllStandardError() );
     stdOut=stdOut.simplified();
-    x2goDebug&lt;&lt;&quot;SCDAEMON err:&quot;&lt;&lt;stdOut&lt;&lt;endl;
+
+    x2goDebug&lt;&lt;&quot;SCDAEMON error: &quot;&lt;&lt;stdOut;
+
     if ( stdOut.indexOf ( &quot;updating slot&quot; ) !=-1 ||
             stdOut.indexOf ( &quot;updating status of slot&quot; ) !=-1 )
     {
@@ -7731,7 +7880,8 @@ void ONMainWindow::slotScDaemonOut()
 {
     QString stdOut ( scDaemon-&gt;readAllStandardOutput() );
     stdOut=stdOut.simplified();
-    x2goDebug&lt;&lt;&quot;SCDAEMON out:&quot;&lt;&lt;stdOut&lt;&lt;endl;
+
+    x2goDebug&lt;&lt;&quot;SCDAEMON out: &quot;&lt;&lt;stdOut;
 }
 
 void ONMainWindow::slotScDaemonFinished ( int , QProcess::ExitStatus )
@@ -7739,7 +7889,9 @@ void ONMainWindow::slotScDaemonFinished ( int , QProcess::ExitStatus )
     scDaemon=0l;
     if ( isScDaemonOk )
     {
-        x2goDebug&lt;&lt;&quot;scDaemon finished&quot;&lt;&lt;endl;
+
+        x2goDebug&lt;&lt;&quot;SCDAEMON finished.&quot;&lt;&lt;endl;
+
         gpg=new QProcess ( this );
         QStringList arguments;
         arguments&lt;&lt;&quot;--card-status&quot;;
@@ -7761,7 +7913,9 @@ void ONMainWindow::slotGpgError()
 {
     QString stdOut ( gpg-&gt;readAllStandardError() );
     stdOut=stdOut.simplified();
-    x2goDebug&lt;&lt;&quot;GPG err:&quot;&lt;&lt;stdOut&lt;&lt;endl;
+
+    x2goDebug&lt;&lt;&quot;GPG error: &quot;&lt;&lt;stdOut;
+
     if ( stdOut.indexOf ( &quot;failed&quot; ) !=-1 )
     {
         QMessageBox::critical ( 0l,tr ( &quot;Error&quot; ),
@@ -7776,13 +7930,17 @@ void ONMainWindow::slotGpgError()
 void ONMainWindow::slotGpgFinished ( int exitCode,
                                      QProcess::ExitStatus exitStatus )
 {
-    x2goDebug&lt;&lt;&quot;gpg finished, exit code:&quot;&lt;&lt;exitCode&lt;&lt;&quot; exit status:&quot;&lt;&lt;
-             exitStatus&lt;&lt;endl;
+
+    x2goDebug&lt;&lt;&quot;GPG finished, exit code: &quot;&lt;&lt;exitCode;
+    x2goDebug&lt;&lt;&quot;GPG finished, exit status:&quot;&lt;&lt;exitStatus;
+
     if ( exitStatus==0 )
     {
         QString stdOut ( gpg-&gt;readAllStandardOutput() );
         stdOut.chop ( 1 );
-        x2goDebug&lt;&lt;&quot;GPG out:&quot;&lt;&lt;stdOut&lt;&lt;endl;
+
+        x2goDebug&lt;&lt;&quot;GPG out: &quot;&lt;&lt;stdOut;
+
         QStringList lines=stdOut.split ( &quot;\n&quot; );
         QString login;
         QString appId;
@@ -7807,10 +7965,14 @@ void ONMainWindow::slotGpgFinished ( int exitCode,
         appId=appId.simplified();
         login=login.simplified();
         authKey=authKey.simplified();
-        x2goDebug&lt;&lt;&quot;card data: &quot;&lt;&lt;appId&lt;&lt;login&lt;&lt;authKey&lt;&lt;endl;
+
+        x2goDebug&lt;&lt;&quot;Card data: &quot;&lt;&lt;appId&lt;&lt;login&lt;&lt;authKey;
+
         if ( login==&quot;[not set]&quot; || authKey == &quot;[none]&quot; )
         {
-            x2goDebug&lt;&lt;&quot;Card not configured\n&quot;;
+
+            x2goErrorf(13)&lt;&lt;tr(&quot;Card not configured.&quot;);
+
             QMessageBox::critical (
                 0l,tr ( &quot;Error&quot; ),
                 tr (
@@ -7886,15 +8048,16 @@ void ONMainWindow::slotGpgAgentFinished ( int , QProcess::ExitStatus )
     QString gpg_agent_info=envLst[0].split ( &quot;=&quot; ) [1];
     QString ssh_auth_sock=envLst[2].split ( &quot;=&quot; ) [1];
     agentPid=envLst[4].split ( &quot;=&quot; ) [1];
-    x2goDebug&lt;&lt;gpg_agent_info&lt;&lt;ssh_auth_sock&lt;&lt;agentPid&lt;&lt;endl;
-    x2goDebug&lt;&lt;&quot;GPGAGENT out:&quot;&lt;&lt;envLst[0]&lt;&lt;envLst[2]&lt;&lt;envLst[4]&lt;&lt;endl;
+
+    x2goDebug&lt;&lt;&quot;GPG-agent info: &quot;&lt;&lt;gpg_agent_info&lt;&lt;ssh_auth_sock&lt;&lt;agentPid;
+    x2goDebug&lt;&lt;&quot;GPG-agent pid: &quot;&lt;&lt;agentPid;
+    x2goDebug&lt;&lt;&quot;GPG-agent out:&quot;&lt;&lt;envLst[0]&lt;&lt;envLst[2]&lt;&lt;envLst[4];
 
     agentCheckTimer-&gt;start ( 1000 );
     cardReady=true;
 
     sshEnv.clear();
     sshEnv&lt;&lt;envLst[0]&lt;&lt;envLst[2]&lt;&lt;envLst[4];
-// 	x2goDebug&lt;&lt;&quot;sshenv:&quot;&lt;&lt;sshEnv&lt;&lt;endl;
 
     if ( !useLdap )
     {
@@ -7918,7 +8081,9 @@ void ONMainWindow::slotGpgAgentFinished ( int , QProcess::ExitStatus )
         sshadd.waitForFinished ( -1 );
         QString sshout ( sshadd.readAllStandardOutput() );
         sshout=sshout.simplified();
-        x2goDebug&lt;&lt;&quot;SSH-ADD out:&quot;&lt;&lt;sshout&lt;&lt;endl;
+
+        x2goDebug&lt;&lt;&quot;SSH-ADD out: &quot;&lt;&lt;sshout;
+
         if(brokerMode)
         {
             broker-&gt;getUserSessions();
@@ -7937,7 +8102,9 @@ void ONMainWindow::slotGpgAgentFinished ( int , QProcess::ExitStatus )
             sshadd.waitForFinished ( -1 );
             QString sshout ( sshadd.readAllStandardOutput() );
             sshout=sshout.simplified();
-            x2goDebug&lt;&lt;&quot;SSH-ADD out:&quot;&lt;&lt;sshout&lt;&lt;endl;
+
+            x2goDebug&lt;&lt;&quot;SSH-ADD out: &quot;&lt;&lt;sshout;
+
             return;
         }
 
@@ -7962,13 +8129,14 @@ void ONMainWindow::slotCheckAgentProcess()
         if ( nxproxy )
             if ( nxproxy-&gt;state() ==QProcess::Running )
             {
-                x2goDebug&lt;&lt;&quot;Suspending session\n&quot;;
+                x2goDebug&lt;&lt;&quot;Suspending session...&quot;;
                 slotSuspendSessFromSt();
+                x2goDebug&lt;&lt;&quot;Suspended  session.&quot;;
 //                 nxproxy-&gt;terminate();
             }
     }
 
-    x2goDebug&lt;&lt;&quot;gpg-agent finished\n&quot;;
+    x2goDebug&lt;&lt;&quot;GPG-Agent finished.&quot;;
     slotStartPGPAuth();
 }
 
@@ -7998,7 +8166,9 @@ QString ONMainWindow::getXDisplay()
         // Mac OS X 10.4 compatibility mode.
         // There, it is possible no $DISPLAY variable is set.
         // Start X11 manually. First, find a free display number.
-        x2goDebug &lt;&lt; &quot;entering 10.4 compat mode, checking for free X11 display&quot;;
+
+        x2goDebug&lt;&lt; &quot;entering 10.4 compat mode, checking for free X11 display&quot;;
+
 
         int xFreeDisp = 0;
         QDir xtmpdir (&quot;/tmp/.X11-unix&quot;);
@@ -8028,7 +8198,8 @@ QString ONMainWindow::getXDisplay()
         if (xFreeDisp != -1)
         {
             xsocket = &quot;/tmp/.X11-unix/X&quot; + QString::number (xFreeDisp);
-            x2goDebug &lt;&lt; &quot;Successfully detected free socket &quot; &lt;&lt; xsocket &lt;&lt; &quot;.&quot;;
+
+            x2goDebug&lt;&lt; &quot;Successfully detected free socket &quot; &lt;&lt; xsocket &lt;&lt; &quot;.&quot;;
         }
 
         if (!(xsocket.isEmpty ()))
@@ -8038,18 +8209,21 @@ QString ONMainWindow::getXDisplay()
             QProcessEnvironment env = QProcessEnvironment::systemEnvironment ();
             QProcess* startx = new QProcess (this);
 
-            x2goDebug &lt;&lt; &quot;Starting the X server on free display port.&quot;;
+            x2goDebug&lt;&lt; &quot;Starting the X server on free display port.&quot;;
+
             env.insert (0, &quot;PATH=/usr/bin:/bin:/usr/sbin:/sbin:/usr/local/bin:/usr/X11R6/bin&quot;);
 
             startx-&gt;setProcessEnvironment (env);
             startx-&gt;start (xname + QString (&quot; &quot;) + xopt, QIODevice::NotOpen);
             if (startx-&gt;waitForStarted (3000))
             {
-                x2goDebug &lt;&lt; &quot;sleeping for three seconds&quot;;
+
+                x2goDebug&lt;&lt; &quot;Sleeping for three seconds&quot;;
                 int sleeptime = 3;
                 while ((sleeptime = sleep (sleeptime))) {};
 
-                x2goDebug &lt;&lt; &quot;Leaving OS X 10.4 compat mode.&quot;;
+                x2goDebug&lt;&lt; &quot;Leaving OS X 10.4 compat mode.&quot;;
+
             }
         }
     }
@@ -8077,7 +8251,9 @@ QString ONMainWindow::getXDisplay()
             }
             // Prepend the well-known socket path.
             xsocket.prepend (&quot;/tmp/.X11-unix/X&quot;);
-            x2goDebug &lt;&lt; &quot;xsocket in compat mode: &quot; &lt;&lt; xsocket;
+
+            x2goDebug&lt;&lt; &quot;xsocket in compat mode: &quot; &lt;&lt; xsocket;
+
         }
 
         unixSocket.connectToServer (xsocket);
@@ -8102,7 +8278,7 @@ QString ONMainWindow::getXDisplay()
 
                 if (ok)
                 {
-                    x2goDebug &lt;&lt; &quot;Returning&quot; &lt;&lt; QString (&quot;:&quot;) + xsocket;
+                    x2goDebug&lt;&lt;&quot;Returning &quot; &lt;&lt; QString (&quot;:&quot;) + xsocket;
                     return (QString (&quot;:&quot;) + xsocket);
                 }
             }
@@ -8228,7 +8404,9 @@ void ONMainWindow::slotExecXmodmap()
 //  	    &quot;echo add mod5 = ISO_Level3_Shift&quot;
         &quot;)| DISPLAY=:&quot;
         +resumingSession.display+&quot; xmodmap - &quot;;
-    x2goDebug&lt;&lt;&quot;cmd:&quot;&lt;&lt;cmd;
+
+    x2goDebug&lt;&lt;&quot;Executing xmodmap with cmd: &quot;&lt;&lt;cmd;
+
     SshProcess* xmodProc;
     try
     {
@@ -8254,7 +8432,11 @@ void ONMainWindow::slotExecXmodmap()
 
 void ONMainWindow::check_cmd_status()
 {
-    x2goDebug&lt;&lt;&quot;check command message&quot;&lt;&lt;endl;
+    QString passwd;
+    QString user=getCurrentUname();
+    QString host=resumingSession.server;
+    passwd=getCurrentPass();
+
     sshConnection-&gt;executeCommand ( &quot;x2gocmdexitmessage &quot;+
                                     resumingSession.sessionId , this, SLOT(slotCmdMessage(bool, QString, int)));
 }
@@ -8262,6 +8444,7 @@ void ONMainWindow::check_cmd_status()
 void ONMainWindow::slotCmdMessage ( bool result,QString output,
                                     int)
 {
+    x2goDebug&lt;&lt;&quot;Command Message: &quot; + output;
     if ( result==false )
     {
         cardReady=false;
@@ -8285,10 +8468,18 @@ void ONMainWindow::slotCmdMessage ( bool result,QString output,
     {
         QString cmd=output;
         cmd.replace ( &quot;X2GORUNCOMMAND ERR NOEXEC:&quot;,&quot;&quot; );
-        QMessageBox::critical ( 0l,tr ( &quot;Error&quot; ),
-                                tr ( &quot;Unable to execute: &quot; ) +
-                                cmd,QMessageBox::Ok,
-                                QMessageBox::NoButton );
+
+        if(startHidden)
+        {
+            x2goErrorf(14)&lt;&lt; tr( &quot;Unable to execute: &quot;) + cmd;
+        }
+        else
+        {
+            QMessageBox::critical ( 0l,tr ( &quot;Error&quot; ),
+                                    tr ( &quot;Unable to execute: &quot; ) +
+                                    cmd,QMessageBox::Ok,
+                                    QMessageBox::NoButton );
+        }
     }
     if(sshConnection)
         delete sshConnection;
@@ -8303,8 +8494,10 @@ void ONMainWindow::slotCmdMessage ( bool result,QString output,
 int ONMainWindow::startSshFsTunnel()
 {
     fsTunReady=false;
-    x2goDebug&lt;&lt;&quot;starting fs tunnel for:&quot;&lt;&lt;resumingSession.sessionId&lt;&lt;
-             &quot;\nfs port: &quot;&lt;&lt;resumingSession.fsPort;
+
+    x2goDebug&lt;&lt;&quot;Starting fs tunnel for: &quot;&lt;&lt;resumingSession.sessionId;
+    x2goDebug&lt;&lt;&quot;fs port: &quot;&lt;&lt;resumingSession.fsPort;
+
 
     if ( resumingSession.fsPort.length() &lt;=0 )
     {
@@ -8376,7 +8569,9 @@ void ONMainWindow::startX2goMount()
 #ifdef Q_OS_WIN
     QDir tdir;
     tdir.mkpath ( authofname+&quot;\\.x2go\\.ssh&quot; );
-    x2goDebug&lt;&lt;&quot;Creating &quot;&lt;&lt;authofname+&quot;\\.x2go\\.ssh&quot;&lt;&lt;endl;
+
+    x2goDebug&lt;&lt;&quot;Creating &quot;&lt;&lt;authofname+&quot;\\.x2go\\.ssh&quot;;
+
     authofname=wapiShortFileName ( authofname ) +&quot;/.x2go&quot;;
 #endif
     authofname+= &quot;/.ssh/authorized_keys&quot; ;
@@ -8496,7 +8691,6 @@ void ONMainWindow::startX2goMount()
 
     dir-&gt;pid=sshConnection-&gt;executeCommand(cmd,this,SLOT ( slotRetExportDir ( bool,
                                            QString,int) ));
-
 }
 
 void ONMainWindow::slotCheckPrintSpool()
@@ -8582,14 +8776,18 @@ bool ONMainWindow::isServerRunning ( int port )
     iResult = WSAStartup(MAKEWORD(2, 2), &amp;wsaData);
     if (iResult != 0)
     {
-        x2goDebug&lt;&lt;&quot;WARNING: WSAStartup failed: &quot;&lt;&lt; iResult&lt;&lt;endl;
+
+        x2goDebug&lt;&lt;&quot;WARNING: WSAStartup failed: &quot;&lt;&lt; iResult;
+
         return false;
     }
 
     addr.s_addr = inet_addr(&quot;127.0.0.1&quot;);
     if (addr.s_addr == INADDR_NONE)
     {
+
         x2goDebug&lt;&lt; &quot;WARNING:  The IPv4 address entered must be a legal address\n&quot;;
+
         return false;
     }
 
@@ -8597,10 +8795,13 @@ bool ONMainWindow::isServerRunning ( int port )
     localHost = gethostbyaddr((char*)&amp;addr,4, AF_INET);
     if (!localHost)
     {
-        x2goDebug&lt;&lt;&quot;WARNING: gethostbyaddr failed: &quot;&lt;&lt;WSAGetLastError()&lt;&lt;endl;
+
+        x2goDebug&lt;&lt;&quot;WARNING: gethostbyaddr failed: &quot;&lt;&lt;WSAGetLastError();
+
         return false;
     }
-    x2goDebug&lt;&lt;&quot;got localhost&quot;&lt;&lt;endl;
+    x2goDebug&lt;&lt;&quot;got localhost&quot;;
+
 
     localIP = inet_ntoa (*(struct in_addr *)*localHost-&gt;h_addr_list);
 
@@ -8611,7 +8812,8 @@ bool ONMainWindow::isServerRunning ( int port )
     ConnectSocket = socket(AF_INET, SOCK_STREAM, IPPROTO_TCP);
     if (ConnectSocket == INVALID_SOCKET)
     {
-        x2goDebug&lt;&lt;&quot;WARNING: socket failed with error: &quot;&lt;&lt; WSAGetLastError()&lt;&lt;endl;
+        x2goDebug&lt;&lt;&quot;WARNING: socket failed with error: &quot;&lt;&lt; WSAGetLastError();
+
         return false;
     }
 
@@ -8619,11 +8821,15 @@ bool ONMainWindow::isServerRunning ( int port )
     if (iResult == SOCKET_ERROR)
     {
         closesocket(ConnectSocket);
-        x2goDebug&lt;&lt;&quot;Port is free: &quot;&lt;&lt;port&lt;&lt;endl;
+
+        x2goDebug&lt;&lt;&quot;Port is free: &quot;&lt;&lt;port;
+
         return false;
     }
     closesocket(ConnectSocket);
-    x2goDebug&lt;&lt;&quot;Port already used: &quot;&lt;&lt;port&lt;&lt;endl;
+
+    x2goDebug&lt;&lt;&quot;Port already used: &quot;&lt;&lt;port;
+
     return true;
 #endif
     QTcpSocket tcpSocket ( 0 );
@@ -8681,7 +8887,9 @@ void ONMainWindow::startXOrg ()
     if (internalX==VCXSRV)
         exec=appDir+&quot;\\vcxsrv\\vcxsrv.exe&quot;;
     winServersReady=false;
+
     x2goDebug&lt;&lt;&quot;using internal X: &quot;&lt;&lt;useInternalX;
+
 //#ifdef CFGCLIENT
     if (!useInternalX || internalX!=XMING)
     {
@@ -8702,10 +8910,13 @@ void ONMainWindow::startXOrg ()
                 break;
             case WIN:
                 cmdLine=xorgWinOptions;
-                x2goDebug&lt;&lt;&quot;WxH:&quot;&lt;&lt;xorgWidth&lt;&lt;&quot;x&quot;&lt;&lt;xorgHeight&lt;&lt;endl;
+
+                x2goDebug&lt;&lt;&quot;WxH:&quot;&lt;&lt;xorgWidth&lt;&lt;&quot;x&quot;&lt;&lt;xorgHeight;
+
                 cmdLine.replace(&quot;%w&quot;,xorgWidth);
                 cmdLine.replace(&quot;%h&quot;,xorgHeight);
-                x2goDebug&lt;&lt;cmdLine&lt;&lt;endl;
+
+                x2goDebug&lt;&lt;cmdLine;
                 break;
             }
         }
@@ -8741,7 +8952,9 @@ void ONMainWindow::startXOrg ()
         xorg-&gt; setWorkingDirectory ( workingDir);
     }
 
-    x2goDebug&lt;&lt;&quot;running&quot;&lt;&lt;exec&lt;&lt;&quot; &quot;&lt;&lt;args.join(&quot; &quot;);
+
+    x2goDebug&lt;&lt;&quot;Running &quot;&lt;&lt;exec&lt;&lt;&quot; &quot;&lt;&lt;args.join(&quot; &quot;);
+
     xorg-&gt;start ( exec, args );
 
 
@@ -8768,7 +8981,9 @@ void ONMainWindow::slotCheckXOrgConnection()
     ++waitingForX;
     if (isServerRunning(6000+xDisplay))
     {
-        x2goDebug&lt;&lt;&quot;X is started&quot;;
+
+        x2goDebug&lt;&lt;&quot;X is started.&quot;;
+
         slotSetWinServersReady();
     }
     else
@@ -8783,7 +8998,9 @@ void ONMainWindow::slotCheckXOrgConnection()
         }
         else
         {
-            x2goDebug&lt;&lt;&quot;waiting for X&quot;;
+
+            x2goDebug&lt;&lt;&quot;...waiting for X.&quot;;
+
             QTimer::singleShot(1000, this, SLOT(slotCheckXOrgConnection()));
         }
     }
@@ -8813,7 +9030,8 @@ void WinServerStarter::run()
 
 void ONMainWindow::startWinServers()
 {
-    x2goDebug&lt;&lt;&quot;Starting win servers&quot;&lt;&lt;endl;
+
+    x2goDebug&lt;&lt;&quot;Starting win servers...&quot;;
 
     QString etcDir=homeDir+&quot;/.x2go/etc&quot;;
     QDir dr ( homeDir );
@@ -8841,7 +9059,9 @@ void ONMainWindow::startWinServers()
         startPulsed();
     }
 // #ifdef CFGCLIENT
-//     x2goDebug&lt;&lt;&quot;xorg settings: &quot;&lt;&lt;startXorgOnStart &lt;&lt;&quot; &quot;&lt;&lt; useXming&lt;&lt;endl;
+
+    //x2goDebug&lt;&lt;&quot;Xorg settings: &quot;&lt;&lt; startXorgOnStart &lt;&lt;&quot; useXming: &quot;&lt;&lt; useXming;
+
     if ( useInternalX &amp;&amp; (internalX== XMING))
     {
 // #endif
@@ -8878,12 +9098,12 @@ void ONMainWindow::saveCygnusSettings()
     {
         if ( haveCygwinEntry() )
         {
-            x2goDebug&lt;&lt;&quot;Cygwin entry exist&quot;;
+            x2goDebug&lt;&lt;&quot;Cygnus Solutions entry exists.&quot;;
             cyEntry=true;
         }
         else
         {
-            x2goDebug&lt;&lt;&quot;Cygwin entry not exist&quot;;
+            x2goDebug&lt;&lt;&quot;Cygnus Solutions entry does not exist.&quot;;
             cyEntry=false;
         }
     }
@@ -8923,7 +9143,9 @@ void ONMainWindow::startPulsed()
     QDir dr ( homeDir );
     dr.mkpath ( pulseDir );
     pulseDir=wapiShortFileName ( pulseDir );
-    x2goDebug&lt;&lt;&quot;template: &quot;&lt;&lt;pulseDir+&quot;/tmp&quot;&lt;&lt;endl;
+
+    x2goDebug&lt;&lt;&quot;pulse template: &quot;&lt;&lt;pulseDir+&quot;/tmp&quot;;
+
     QTemporaryFile* fl=new QTemporaryFile ( pulseDir+&quot;/tmp&quot; );
     fl-&gt;open();
     pulseDir=fl-&gt;fileName();
@@ -8931,7 +9153,9 @@ void ONMainWindow::startPulsed()
     delete fl;
     QFile::remove ( pulseDir );
     dr.mkpath ( pulseDir );
-    x2goDebug&lt;&lt;&quot;pulse tmp file: &quot;&lt;&lt;pulseDir&lt;&lt;endl;
+
+    x2goDebug&lt;&lt;&quot;pulse tmp file: &quot;&lt;&lt;pulseDir;
+
     QStringList pEnv=QProcess::systemEnvironment();
     for ( int i=0; i&lt;pEnv.size(); ++i )
     {
@@ -8971,12 +9195,15 @@ void ONMainWindow::startPulsed()
     pulseServer-&gt;setWorkingDirectory ( wapiShortFileName (
                                            appDir+&quot;\\pulse&quot; ) );
     pulseServer-&gt;start ( &quot;pulse\\pulseaudio.exe&quot;,pulseArgs );
-    x2goDebug&lt;&lt;&quot;starting pulse\\pulseaudio.exe &quot;&lt;&lt;pulseArgs.join ( &quot; &quot; ) &lt;&lt;
+
+    x2goDebug&lt;&lt;&quot;Starting pulse\\pulseaudio.exe &quot;&lt;&lt;pulseArgs.join ( &quot; &quot; ) &lt;&lt;
              &quot; working dir: &quot;&lt;&lt;
-             wapiShortFileName ( appDir+&quot;\\pulse&quot; ) &lt;&lt;endl;
+             wapiShortFileName ( appDir+&quot;\\pulse&quot; );
+
     pulseTimer=new QTimer(this);
-    x2goDebug&lt;&lt;&quot;connect timer&quot;;
+
     connect (pulseTimer, SIGNAL(timeout()), this, SLOT(slotCheckPulse()));
+    x2goDebug&lt;&lt;&quot;Connected timer.&quot;;
     pulseTimer-&gt;start(2000);
 }
 
@@ -8986,7 +9213,9 @@ void ONMainWindow::slotCheckPulse()
     if(pulseServer-&gt;state()!=QProcess::Running)
     {
         pulseServer-&gt;start ( &quot;pulse\\pulseaudio.exe&quot;,pulseArgs );
-        x2goDebug&lt;&lt;&quot;restarting pulse\\pulseaudio.exe &quot;&lt;&lt;pulseArgs.join ( &quot; &quot; );
+
+        x2goDebug&lt;&lt;&quot;Restarting pulse\\pulseaudio.exe &quot;&lt;&lt;pulseArgs.join ( &quot; &quot; );
+
     }
 }
 
@@ -8994,7 +9223,9 @@ void ONMainWindow::slotCheckPulse()
 // #ifdef CFGCLIENT
 void ONMainWindow::xorgSettings()
 {
-    x2goDebug&lt;&lt;&quot;getting xorg settings&quot;&lt;&lt;endl;
+
+    x2goDebug&lt;&lt;&quot;Getting Xorg settings.&quot;;
+
 
     X2goSettings st ( &quot;settings&quot; );
 
@@ -9036,7 +9267,9 @@ void ONMainWindow::xorgSettings()
 
 void ONMainWindow::slotSetWinServersReady()
 {
-    x2goDebug&lt;&lt;&quot;all winservers are started\n&quot;;
+
+    x2goDebug&lt;&lt;&quot;All winservers are started.&quot;;
+
     winServersReady=true;
     restoreCygnusSettings();
 }
@@ -9069,7 +9302,7 @@ void ONMainWindow::generateEtcFiles()
        &lt;&lt;appDir&lt;&lt;&quot;/sftp-server\n&quot;;
 #endif
     file.close();
-    x2goDebug&lt;&lt;etcDir +&quot;/sshd_config created&quot;;
+    x2goDebug&lt;&lt;etcDir +&quot;/sshd_config created.&quot;;
 }
 
 void ONMainWindow::generateHostDsaKey()
@@ -9080,7 +9313,9 @@ void ONMainWindow::generateHostDsaKey()
     if ( !QFile::exists ( etcDir+&quot;/ssh_host_dsa_key&quot; ) ||
             !QFile::exists ( etcDir+&quot;/ssh_host_dsa_key.pub&quot; ) )
     {
-        /*		x2goDebug&lt;&lt;&quot;Generating host DSA key\n&quot;;*/
+
+        x2goDebug&lt;&lt;&quot;Generating host DSA key.&quot;;
+
 #ifdef Q_OS_WIN
         QString fname=cygwinPath ( wapiShortFileName ( etcDir ) ) +
                       &quot;/ssh_host_dsa_key&quot;;
@@ -9122,7 +9357,9 @@ void ONMainWindow::startSshd()
     desktopName+=getenv ( &quot;USERNAME&quot; );
     char* desktop=new char[desktopName.size() +1];
     strcpy ( desktop,desktopName.c_str() );
-    x2goDebug&lt;&lt;&quot;Creating desktop: &quot;&lt;&lt;desktop&lt;&lt;endl;
+
+    x2goDebug&lt;&lt;&quot;Creating desktop: &quot;&lt;&lt;desktop;
+
     if ( !CreateDesktopA (
                 desktop,
                 0,
@@ -9133,7 +9370,9 @@ void ONMainWindow::startSshd()
             ) )
     {
         strcpy ( desktop,&quot;&quot; );
-        x2goDebug&lt;&lt;&quot;Desktop creation failed, using default\n&quot;;
+
+        x2goDebug&lt;&lt;&quot;Desktop creation failed, using default.&quot;;
+
     }
     ZeroMemory ( &amp;si, sizeof ( si ) );
     ZeroMemory ( &amp;sshd, sizeof ( sshd ) );
@@ -9159,7 +9398,8 @@ void ONMainWindow::startSshd()
     arguments&lt;&lt;&quot;-f&quot;&lt;&lt;etcDir +&quot;/sshd_config&quot;&lt;&lt; &quot;-h&quot; &lt;&lt;
              etcDir+&quot;/ssh_host_dsa_key&quot;&lt;&lt;&quot;-D&quot;&lt;&lt;&quot;-p&quot;&lt;&lt;clientSshPort;
     sshd-&gt;start ( appDir+&quot;/sshd&quot;,arguments );
-    x2goDebug&lt;&lt;&quot;Usermode sshd started&quot;;
+    x2goDebug&lt;&lt;&quot;Usermode sshd started.&quot;;
+
 #endif
 }
 
@@ -9261,7 +9501,14 @@ void ONMainWindow::slotSetProxyWinFullscreen()
 void ONMainWindow::resizeProxyWinOnDisplay(int disp)
 {
     QRect geom=QApplication::desktop()-&gt;screenGeometry(disp-1);
-    //x2goDebug&lt;&lt;&quot;resizing proxy win to fit display &quot;&lt;&lt;disp&lt;&lt;&quot;(&quot;&lt;&lt;geom&lt;&lt;&quot;)&quot;&lt;&lt;endl;
+
+    QString geoStr =
+            &quot;(x: &quot; + QString(&quot;%1&quot;).arg(geom.x()) +
+            &quot;, y: &quot;+ QString(&quot;%1&quot;).arg(geom.y()) +
+            &quot;, w: &quot;+ QString(&quot;%1&quot;).arg(geom.width()) +
+            &quot;, h: &quot;+ QString(&quot;%1&quot;).arg(geom.height());
+    x2goDebug&lt;&lt;&quot;Resizing proxy window to fit Display: &quot; + QString(&quot;%1&quot;).arg(disp) + &quot; &quot; + geoStr;
+
 #ifdef Q_OS_LINUX
     XSync(QX11Info::display(),false);
     XMoveWindow(QX11Info::display(), proxyWinId,geom.x(),geom.y());
@@ -9304,14 +9551,21 @@ void ONMainWindow::slotConfigXinerama()
     QRect newGeometry=proxyWinGeometry();
     if (newGeometry.isNull())
     {
-//     x2goDebug&lt;&lt;&quot;error getting window geometry (window closed?)\n&quot;;
+        x2goWarningf(7)&lt;&lt; tr(&quot;Error getting window geometry (window closed)?&quot;);
         xineramaTimer-&gt;stop();
         return;
     }
     if (newGeometry==lastDisplayGeometry)
         return;
     lastDisplayGeometry=newGeometry;
-//    x2goDebug&lt;&lt;&quot;New proxy geometry: &quot;&lt;&lt;lastDisplayGeometry&lt;&lt;endl;
+
+    QString geoStr =
+            &quot;(x: &quot; + QString(&quot;%1&quot;).arg(lastDisplayGeometry.x()) +
+            &quot;, y: &quot;+ QString(&quot;%1&quot;).arg(lastDisplayGeometry.y()) +
+            &quot;, w: &quot;+ QString(&quot;%1&quot;).arg(lastDisplayGeometry.width()) +
+            &quot;, h: &quot;+ QString(&quot;%1&quot;).arg(lastDisplayGeometry.height());
+    x2goDebug&lt;&lt;&quot;New proxy geometry: &quot; + geoStr;
+
     QDesktopWidget* root=QApplication::desktop();
     QList&lt;QRect&gt; newXineramaScreens;
     for (int i=0; i&lt; root-&gt;numScreens(); ++i)
@@ -9323,17 +9577,19 @@ void ONMainWindow::slotConfigXinerama()
             intersection=root-&gt;screenGeometry(i).intersected(lastDisplayGeometry);
         if (!intersection.isNull())
         {
-//            x2goDebug&lt;&lt;&quot;intersected with &quot;&lt;&lt;i&lt;&lt;&quot;: &quot;&lt;&lt;intersection&lt;&lt;endl;
+            //            x2goDebug&lt;&lt;&quot;intersected with &quot;&lt;&lt;i&lt;&lt;&quot;: &quot;&lt;&lt;intersection&lt;&lt;endl;
             intersection.moveLeft(intersection.x()-lastDisplayGeometry.x());
             intersection.moveTop(intersection.y()-lastDisplayGeometry.y());
-//            x2goDebug&lt;&lt;&quot;xinerama screen: &quot;&lt;&lt;intersection&lt;&lt;endl;
+
+            //            x2goDebug&lt;&lt;&quot;xinerama screen: &quot;&lt;&lt;intersection&lt;&lt;endl;
             newXineramaScreens&lt;&lt;intersection;
         }
     }
     if (xineramaScreens != newXineramaScreens)
     {
         xineramaScreens=newXineramaScreens;
-//        x2goDebug&lt;&lt;&quot;xinerama screen changed, new screens: &quot;&lt;&lt;xineramaScreens&lt;&lt;endl;
+        //        x2goDebug&lt;&lt;&quot;xinerama screen changed, new screens: &quot;&lt;&lt;xineramaScreens&lt;&lt;endl;
+
         xineramaTimer-&gt;stop();
         QStringList screens;
         foreach (QRect disp, xineramaScreens)
@@ -9342,7 +9598,6 @@ void ONMainWindow::slotConfigXinerama()
         QString cmd=&quot;export DISPLAY=:&quot;+resumingSession.display+&quot;;printf '&quot;+screens.join(&quot;\\\\n&quot;)+&quot;' &gt;  ~/.x2go/C-&quot;+
                     resumingSession.sessionId+&quot;/xinerama.conf&quot;;
 
-        x2goDebug&lt;&lt;cmd&lt;&lt;endl;
         sshConnection-&gt;executeCommand(cmd, this, SLOT(slotXineramaConfigured()));
     }
 }
@@ -9374,12 +9629,14 @@ void ONMainWindow::slotXineramaConfigured()
 void ONMainWindow::slotFindProxyWin()
 {
 #ifndef Q_OS_DARWIN
-//     x2goDebug&lt;&lt;&quot;search proxy win: &quot;&lt;&lt;&quot;X2GO-&quot;+resumingSession.sessionId;
+    x2goDebug&lt;&lt;&quot;Searching proxy win: X2GO-&quot; + resumingSession.sessionId;
+
     proxyWinId=findWindow ( &quot;X2GO-&quot;+resumingSession.sessionId );
     bool xinerama=defaultXinerama;
     if ( proxyWinId )
     {
-        x2goDebug&lt;&lt;&quot;proxy win found:&quot;&lt;&lt;proxyWinId;
+        x2goDebug&lt;&lt;&quot;Proxy win found: &quot; + QString(&quot;%1&quot;).arg(proxyWinId);
+
         setProxyWinTitle();
         proxyWinTimer-&gt;stop();
         if (!embedMode)
@@ -9415,7 +9672,8 @@ void ONMainWindow::slotFindProxyWin()
             }
             if (xinerama)
             {
-                x2goDebug&lt;&lt;&quot;Starting xinerama timer\n&quot;;
+                x2goDebug&lt;&lt;&quot;Starting Xinerama Timer.&quot;;
+
                 lastDisplayGeometry=QRect();
                 xineramaScreens.clear();
                 xineramaTimer-&gt;start(500);
@@ -9424,23 +9682,26 @@ void ONMainWindow::slotFindProxyWin()
 
         if ( embedMode )
         {
-            x2goDebug&lt;&lt;&quot;checking rootless config&quot;;
+            x2goDebug&lt;&lt;&quot;Checking rootless config.&quot;;
+
             if ( config.rootless )
             {
-                x2goDebug&lt;&lt;&quot;win is rootless&quot;;
+                x2goDebug&lt;&lt;&quot;Window is rootless.&quot;;
                 act_embedContol-&gt;setEnabled ( false );
             }
             else
                 slotAttachProxyWindow();
         }
 #ifdef Q_OS_WIN
-        x2goDebug&lt;&lt;&quot;maximizeProxyWin: &quot;&lt;&lt;maximizeProxyWin;
+        x2goDebug&lt;&lt;&quot;Maximize proxy win: &quot;&lt;&lt;maximizeProxyWin;
+
         if ( !startEmbedded )
         {
             if ( maximizeProxyWin )
             {
                 QDesktopWidget dw;
-                x2goDebug&lt;&lt;&quot;making proxy win full screen&quot;;
+
+                x2goDebug&lt;&lt;&quot;Making proxy win full screen.&quot;;
                 wapiSetFSWindow ( ( HWND ) proxyWinId,
                                   dw.screenGeometry ( this ) );
                 /*wapiShowWindow ( ( HWND ) proxyWinId,
@@ -9481,9 +9742,8 @@ void ONMainWindow::slotDetachProxyWindow()
     //and reconnect
     if ( !embedControlChanged )
     {
-        x2goDebug&lt;&lt;&quot;\n&quot;;
         slotFindProxyWin();
-        x2goDebug&lt;&lt;&quot;proxy win detached, proxywin is:&quot;&lt;&lt;proxyWinId&lt;&lt;endl;
+        x2goDebug&lt;&lt;&quot;Proxy win detached, proxywin is: &quot;&lt;&lt;proxyWinId;
     }
 #endif
     embedControlChanged=false;
@@ -9492,7 +9752,8 @@ void ONMainWindow::slotDetachProxyWindow()
 
 void ONMainWindow::slotAttachProxyWindow()
 {
-    x2goDebug&lt;&lt;&quot;slotAttachProxy&quot;;
+    x2goDebug&lt;&lt;&quot;slotAttachProxyWindow.&quot;;
+
     if ( startEmbedded )
     {
         embedControlChanged=false;
@@ -9506,7 +9767,9 @@ void ONMainWindow::slotAttachProxyWindow()
     }
     else
     {
-        x2goDebug&lt;&lt;&quot;start embedded was false&quot;;
+
+        x2goDebug&lt;&lt;&quot;Start embedded was false.&quot;;
+
         startEmbedded=true;
     }
 
@@ -9814,7 +10077,9 @@ void ONMainWindow::slotChangeKbdLayout(const QString&amp; layout)
 #ifdef Q_OS_LINUX
     QStringList args;
     args&lt;&lt;&quot;-layout&quot;&lt;&lt;layout;
-    x2goDebug&lt;&lt;&quot;running setxkbmap with params: &quot;&lt;&lt;args.join(&quot; &quot;);
+
+    x2goDebug&lt;&lt;&quot;Running setxkbmap with params: &quot;&lt;&lt;args.join(&quot; &quot;);
+
     QProcess::startDetached(&quot;setxkbmap&quot;,args);
 #endif
 }
@@ -10587,8 +10852,10 @@ void ONMainWindow::slotActivateWindow()
         QApplication::setActiveWindow ( this ) ;
         activateWindow();
 
+
         /*		x2goDebug&lt;&lt;&quot;focus:&quot;&lt;&lt;pass-&gt;hasFocus();
-        		x2goDebug&lt;&lt;&quot;activ:&quot;&lt;&lt;pass-&gt;isActiveWindow();*/
+                x2goDebug&lt;&lt;&quot;activ:&quot;&lt;&lt;pass-&gt;isActiveWindow();*/
+
         QTimer::singleShot ( 50, this,
                              SLOT ( slotEmbedToolBarToolTip() ) );
     }
@@ -10736,7 +11003,6 @@ QString ONMainWindow::u3DataPath()
     QString dpath;
     for ( int i=0; i&lt;env.size(); ++i )
     {
-// 		x2goDebug &lt;&lt; env[i];
         //check if we have U3 System
         if ( env[i].indexOf ( &quot;U3_APP_DATA_PATH=&quot; ) ==0 )
         {
@@ -10772,14 +11038,18 @@ void ONMainWindow::cleanPortable()
 
 void ONMainWindow::removeDir ( QString path )
 {
-    x2goDebug&lt;&lt;&quot;entering &quot; &lt;&lt;path;
+
+    x2goDebug&lt;&lt;&quot;removeDir, entering: &quot; &lt;&lt;path;
+
     QDir dr ( path );
     QStringList files=dr.entryList ( QDir::Files );
     for ( int i=0; i&lt;files.size(); ++i )
     {
         if ( files[i]!=&quot;known_hosts&quot; || cleanAllFiles)
         {
-            x2goDebug&lt;&lt;&quot;cleaning file:&quot;&lt;&lt;path+&quot;/&quot;+files[i];
+
+            x2goDebug&lt;&lt;&quot;Cleaning file: &quot;&lt;&lt;path+&quot;/&quot;+files[i];
+
             dr.remove ( path+&quot;/&quot;+files[i] );
         }
     }
@@ -10831,6 +11101,7 @@ long ONMainWindow::X11FindWindow ( QString text, long rootWin )
 
 long ONMainWindow::findWindow ( QString text )
 {
+    x2goDebug&lt;&lt;&quot;Searching window with title: &quot; + text;
 #ifdef Q_OS_LINUX
     return X11FindWindow ( text );
 #endif
@@ -10845,7 +11116,9 @@ long ONMainWindow::findWindow ( QString text )
 void ONMainWindow::setX2goconfig ( const QString&amp; text )
 {
     m_x2goconfig=text;
-    x2goDebug&lt;&lt;&quot;have session config&quot;;
+
+    x2goDebug&lt;&lt;&quot;Haveing a session config.&quot;;
+
     initWidgetsEmbed();
 }
 
@@ -10855,12 +11128,16 @@ void ONMainWindow::doPluginInit()
     Dl_info info;
     dladdr ( ( void* ) &amp; ( ONMainWindow::getPortable ),&amp;info );
     QString fname=info.dli_fname;
+
     x2goDebug&lt;&lt;&quot;Application name:&quot; &lt;&lt;fname;
+
     QString clientDir;
     QString pluginDir;
     int pos=fname.lastIndexOf ( &quot;/&quot; );
     pluginDir=fname.left ( pos );
-    x2goDebug&lt;&lt;&quot;Plugin Dir:&quot; &lt;&lt;pluginDir;
+
+    x2goDebug&lt;&lt;&quot;Plugin directory: &quot; &lt;&lt;pluginDir;
+
     QDir dr ( pluginDir );
     if ( dr.exists ( &quot;x2goclient/x2goclient&quot; ) )
     {
@@ -10886,7 +11163,9 @@ void ONMainWindow::doPluginInit()
             clientDir=pluginDir;
         }
     }
-    x2goDebug&lt;&lt;&quot;Client Dir:&quot;&lt;&lt;clientDir;
+
+    x2goDebug&lt;&lt;&quot;Client directory: &quot;&lt;&lt;clientDir;
+
     QString path=getenv ( &quot;PATH&quot; );
     path=clientDir+&quot;:&quot;+pluginDir+&quot;:&quot;+path;
     setenv ( &quot;PATH&quot;,path.toAscii (),1 );
@@ -10962,7 +11241,9 @@ void ONMainWindow::slotUpdateEmbedWindow()
         oldContainerSize=embedContainer-&gt;size();
         oldChildPos= mapToGlobal (
                          QPoint ( 0,0 ) );
-        x2goDebug&lt;&lt;&quot;updating embedded window&quot;&lt;&lt;endl;
+
+        x2goDebug&lt;&lt;&quot;Updating embedded window.&quot;;
+
     }
 }
 
@@ -10975,7 +11256,9 @@ void ONMainWindow::embedWindow ( long wndId )
     childId=wndId;
     embedContainer-&gt;show();
 #ifdef Q_OS_LINUX
-    x2goDebug&lt;&lt;&quot;embedding &quot;&lt;&lt;wndId&lt;&lt;&quot; in container&quot;&lt;&lt;endl;
+
+    x2goDebug&lt;&lt;&quot;Embedding window with id &quot;&lt;&lt;wndId&lt;&lt;&quot; in container.&quot;;
+
     embedContainer-&gt;embedClient ( wndId );
 #endif
 #ifdef Q_OS_WIN
diff --git a/onmainwindow.h b/onmainwindow.h
index b51caca..b736755 100644
--- a/onmainwindow.h
+++ b/onmainwindow.h
@@ -324,6 +324,9 @@ public:
         ARTS,
         ESD
     };
+
+    static bool debugging;
+
     static bool portable;
     ONMainWindow ( QWidget *parent = 0 );
     ~ONMainWindow();
diff --git a/sshmasterconnection.cpp b/sshmasterconnection.cpp
index eb75237..3dae569 100644
--- a/sshmasterconnection.cpp
+++ b/sshmasterconnection.cpp
@@ -319,7 +319,9 @@ void SshMasterConnection::run()
         if ( ssh_init() !=0 )
         {
             QString err=tr ( &quot;Can not initialize libssh&quot; );
+#ifdef DEBUG
             x2goDebug&lt;&lt;err&lt;&lt;endl;
+#endif
             emit connectionError ( err,&quot;&quot; );
             quit();
             return;
@@ -345,7 +347,9 @@ void SshMasterConnection::run()
     if ( my_ssh_session == NULL )
     {
         QString err=tr ( &quot;Can not create ssh session&quot; );
+#ifdef DEBUG
         x2goDebug&lt;&lt;err&lt;&lt;endl;
+#endif
         emit connectionError ( err,&quot;&quot; );
         if ( reverseTunnel )
             emit ioErr ( reverseTunnelCreator,err,&quot;&quot; );
@@ -373,7 +377,9 @@ void SshMasterConnection::run()
         if (!tcpProxySocket-&gt;waitForConnected(30000))
         {
             QString message=tr ( &quot;Can not connect to proxy server&quot; );
+#ifdef DEBUG
             x2goDebug&lt;&lt;message&lt;&lt;endl;
+#endif
             emit connectionError ( &quot;Proxy&quot;, message );
             ssh_free ( my_ssh_session );
             quit();
@@ -394,12 +400,16 @@ void SshMasterConnection::run()
     {
         if(disconnectSessionFlag)
         {
+#ifdef DEBUG
             x2goDebug&lt;&lt;&quot;session already disconnected, exiting&quot;&lt;&lt;endl;
+#endif
             return;
         }
         QString err=ssh_get_error ( my_ssh_session );
         QString message=tr ( &quot;Can not connect to &quot; ) +host+&quot;:&quot;+QString::number ( port );
+#ifdef DEBUG
         x2goDebug&lt;&lt;message&lt;&lt;&quot; - &quot;&lt;&lt;err;
+#endif
         emit connectionError ( message, err );
         if ( reverseTunnel )
             emit ioErr ( reverseTunnelCreator,message,err );
@@ -409,7 +419,9 @@ void SshMasterConnection::run()
     }
     if(disconnectSessionFlag)
     {
+#ifdef DEBUG
         x2goDebug&lt;&lt;&quot;session already disconnected, exiting&quot;&lt;&lt;endl;
+#endif
         return;
     }
     QString errMsg;
@@ -418,7 +430,9 @@ void SshMasterConnection::run()
     {
         if(disconnectSessionFlag)
         {
+#ifdef DEBUG
             x2goDebug&lt;&lt;&quot;session already disconnected, exiting&quot;&lt;&lt;endl;
+#endif
             return;
         }
         writeHostKey=writeHostKeyReady=false;
@@ -443,7 +457,9 @@ void SshMasterConnection::run()
 
     if(disconnectSessionFlag)
     {
+#ifdef DEBUG
         x2goDebug&lt;&lt;&quot;session already disconnected, exiting&quot;&lt;&lt;endl;
+#endif
         return;
     }
     ssh_options_set ( my_ssh_session, SSH_OPTIONS_USER, user.toAscii() );
@@ -459,7 +475,9 @@ void SshMasterConnection::run()
     {
         if(disconnectSessionFlag)
         {
+#ifdef DEBUG
             x2goDebug&lt;&lt;&quot;session already disconnected, exiting&quot;&lt;&lt;endl;
+#endif
             return;
         }
 #ifdef DEBUG
@@ -471,14 +489,18 @@ void SshMasterConnection::run()
     {
         if(disconnectSessionFlag)
         {
+#ifdef DEBUG
             x2goDebug&lt;&lt;&quot;session already disconnected, exiting&quot;&lt;&lt;endl;
+#endif
             return;
         }
         QString err;
         if (!kerberos)
             err=ssh_get_error ( my_ssh_session );
         QString message=tr ( &quot;Authentication failed&quot; );
+#ifdef DEBUG
         x2goDebug&lt;&lt;message&lt;&lt;&quot; - &quot;&lt;&lt;err;
+#endif
         emit userAuthError ( authErrors.join ( &quot;\n&quot; ) );
         if ( reverseTunnel )
             emit ioErr ( reverseTunnelCreator,message,err );
@@ -504,12 +526,16 @@ void SshMasterConnection::run()
         {
             if(disconnectSessionFlag)
             {
+#ifdef DEBUG
                 x2goDebug&lt;&lt;&quot;session already disconnected, exiting&quot;&lt;&lt;endl;
+#endif
                 return;
             }
             QString err=ssh_get_error ( my_ssh_session );
             QString message=tr ( &quot;channel_forward_listen failed&quot; );
+#ifdef DEBUG
             x2goDebug&lt;&lt;message&lt;&lt;&quot; - &quot;&lt;&lt;err;
+#endif
             emit ioErr ( reverseTunnelCreator, message, err );
             ssh_disconnect ( my_ssh_session );
             ssh_free ( my_ssh_session );
@@ -919,13 +945,17 @@ void SshMasterConnection::copy()
         ssh_scp scp=ssh_scp_new ( my_ssh_session, SSH_SCP_WRITE|SSH_SCP_RECURSIVE, dstPath.toAscii() );
         if ( scp == NULL )
         {
+#ifdef DEBUG
             x2goDebug&lt;&lt;&quot;Error allocating scp session: &quot;&lt;&lt; ssh_get_error ( my_ssh_session ) &lt;&lt;endl;
+#endif
             return;
         }
         int rc = ssh_scp_init ( scp );
         if ( rc != SSH_OK )
         {
+#ifdef DEBUG
             x2goDebug&lt;&lt;&quot;Error initializing scp session: &quot;&lt;&lt; ssh_get_error ( my_ssh_session ) &lt;&lt;endl;
+#endif
             ssh_scp_free ( scp );
             return;
         }
@@ -946,7 +976,9 @@ void SshMasterConnection::copy()
         {
             QString errMsg=tr ( &quot;Can not create remote file &quot; ) +copyRequests[i].dst;
             QString serr=ssh_get_error ( my_ssh_session );
+#ifdef DEBUG
             x2goDebug&lt;&lt;errMsg&lt;&lt;&quot; - &quot;&lt;&lt;serr&lt;&lt;endl;
+#endif
             emit copyErr ( copyRequests[i].creator, errMsg, serr );
             copyRequests.removeAt ( i );
             ssh_scp_close ( scp );
@@ -958,7 +990,9 @@ void SshMasterConnection::copy()
         {
             QString serr=ssh_get_error ( my_ssh_session );
             QString errMsg=tr ( &quot;Can not write to remote file &quot; ) +copyRequests[i].dst;
+#ifdef DEBUG
             x2goDebug&lt;&lt;errMsg&lt;&lt;&quot; - &quot;&lt;&lt;serr&lt;&lt;endl;
+#endif
             emit copyErr ( copyRequests[i].creator, errMsg, serr );
             copyRequests.removeAt ( i );
             ssh_scp_close ( scp );
@@ -1071,7 +1105,9 @@ void SshMasterConnection::channelLoop()
                 {
                     QString errMsg=tr ( &quot;can not connect to &quot; ) +
                                    reverseTunnelLocalHost+&quot;:&quot;+QString::number ( reverseTunnelLocalPort );
+#ifdef DEBUG
                     x2goDebug&lt;&lt;errMsg&lt;&lt;endl;
+#endif
                     emit ioErr ( reverseTunnelCreator, errMsg, &quot;&quot; );
                     continue;
                 }
@@ -1104,7 +1140,9 @@ void SshMasterConnection::channelLoop()
         channelConnectionsMutex.lock();
         if ( channelConnections.size() &lt;=0 )
         {
-//             x2goDebug&lt;&lt;&quot;no channel connections, waiting\n&quot;;
+#ifdef DEBUG
+            //             x2goDebug&lt;&lt;&quot;no channel connections, waiting\n&quot;;
+#endif
             channelConnectionsMutex.unlock();
             usleep ( 500 );
             continue;
@@ -1144,7 +1182,9 @@ void SshMasterConnection::channelLoop()
                         QString err=ssh_get_error ( my_ssh_session );
                         QString errorMsg=tr ( &quot;channel_open_forward failed&quot; );
                         emit ioErr ( channelConnections[i].creator, errorMsg, err );
+#ifdef DEBUG
                         x2goDebug&lt;&lt;errorMsg&lt;&lt;&quot;: &quot;&lt;&lt;err&lt;&lt;endl;
+#endif
                     }
 #ifdef DEBUG
                     else
@@ -1163,14 +1203,18 @@ void SshMasterConnection::channelLoop()
                         QString err=ssh_get_error ( my_ssh_session );
                         QString errorMsg=tr ( &quot;channel_open_session failed&quot; );
                         emit ioErr ( channelConnections[i].creator, errorMsg, err );
+#ifdef DEBUG
                         x2goDebug&lt;&lt;errorMsg&lt;&lt;&quot;: &quot;&lt;&lt;err&lt;&lt;endl;
+#endif
                     }
                     else if ( channel_request_exec ( channel, channelConnections[i].command.toAscii() ) != SSH_OK )
                     {
                         QString err=ssh_get_error ( my_ssh_session );
                         QString errorMsg=tr ( &quot;channel_request_exec failed&quot; );
                         emit ioErr ( channelConnections[i].creator, errorMsg, err );
+#ifdef DEBUG
                         x2goDebug&lt;&lt;errorMsg&lt;&lt;&quot;: &quot;&lt;&lt;err&lt;&lt;endl;
+#endif
                     }
 #ifdef DEBUG
                     else
@@ -1192,11 +1236,15 @@ void SshMasterConnection::channelLoop()
 
         if ( retval == -1 )
         {
+#ifdef DEBUG
             x2goDebug&lt;&lt;&quot;select error\n&quot;;
+#endif
             continue;
         }
 
-//         x2goDebug&lt;&lt;&quot;select exited&quot;&lt;&lt;endl;
+#ifdef DEBUG
+        //         x2goDebug&lt;&lt;&quot;select exited&quot;&lt;&lt;endl;
+#endif
 
         channelConnectionsMutex.lock();
         for ( int i=channelConnections.size()-1; i&gt;=0; --i )
@@ -1207,10 +1255,14 @@ void SshMasterConnection::channelLoop()
                 continue;
             if ( channel_poll ( channel,1 ) &gt;0 )
             {
-//              x2goDebug&lt;&lt;&quot;read err data from channel\n&quot;;
+#ifdef DEBUG
+                //              x2goDebug&lt;&lt;&quot;read err data from channel\n&quot;;
+#endif
                 nbytes = channel_read ( channel, buffer, sizeof ( buffer )-1, 1 );
                 emit stdErr ( channelConnections[i].creator, QByteArray ( buffer,nbytes ) );
-//              x2goDebug&lt;&lt;nbytes&lt;&lt;&quot; err from channel&quot;&lt;&lt;endl;
+#ifdef DEBUG
+                //              x2goDebug&lt;&lt;nbytes&lt;&lt;&quot; err from channel&quot;&lt;&lt;endl;
+#endif
             }
             int rez=channel_poll ( channel,0 );
             if ( rez==SSH_EOF )
@@ -1224,9 +1276,13 @@ void SshMasterConnection::channelLoop()
             }
             if ( rez&gt;0 )
             {
-//                  x2goDebug&lt;&lt;&quot;read data from channel &quot;&lt;&lt;channel&lt;&lt;endl;
+#ifdef DEBUG
+                //                  x2goDebug&lt;&lt;&quot;read data from channel &quot;&lt;&lt;channel&lt;&lt;endl;
+#endif
                 nbytes = channel_read ( channel, buffer, sizeof ( buffer )-1, 0 );
-//                  x2goDebug&lt;&lt;nbytes&lt;&lt;&quot; from channel &quot;&lt;&lt;channel&lt;&lt;endl;
+#ifdef DEBUG
+                //                  x2goDebug&lt;&lt;nbytes&lt;&lt;&quot; from channel &quot;&lt;&lt;channel&lt;&lt;endl;
+#endif
                 if ( nbytes &gt; 0 )
                 {
                     if ( tcpSocket&gt;0 )
@@ -1234,12 +1290,16 @@ void SshMasterConnection::channelLoop()
                         if ( send ( tcpSocket,buffer, nbytes,0 ) != nbytes )
                         {
                             QString errMsg=tr ( &quot;error writing to socket&quot; );
+#ifdef DEBUG
                             x2goDebug&lt;&lt;&quot;error writing &quot;&lt;&lt;nbytes&lt;&lt;&quot; to tcp socket&quot;&lt;&lt;tcpSocket&lt;&lt;endl;
+#endif
                             emit ioErr ( channelConnections[i].creator,errMsg,&quot;&quot; );
                             finalize ( i );
                             continue;
                         }
-//                      x2goDebug&lt;&lt;&quot;wrote &quot;&lt;&lt;nbytes&lt;&lt;&quot; to tcp socket &quot;&lt;&lt;tcpSocket&lt;&lt;endl;
+#ifdef DEBUG
+                        //                      x2goDebug&lt;&lt;&quot;wrote &quot;&lt;&lt;nbytes&lt;&lt;&quot; to tcp socket &quot;&lt;&lt;tcpSocket&lt;&lt;endl;
+#endif
                     }
                     else
                     {
@@ -1253,7 +1313,9 @@ void SshMasterConnection::channelLoop()
                     QString err=ssh_get_error ( my_ssh_session );
                     QString errorMsg=tr ( &quot;error reading channel&quot; );
                     emit ioErr ( channelConnections[i].creator, errorMsg, err );
+#ifdef DEBUG
                     x2goDebug&lt;&lt;errorMsg&lt;&lt;&quot; - &quot;&lt;&lt;err&lt;&lt;endl;
+#endif
                     finalize ( i );
                     continue;
                 }
@@ -1275,7 +1337,9 @@ void SshMasterConnection::channelLoop()
             if ( FD_ISSET ( tcpSocket,&amp;rfds ) )
             {
                 nbytes = recv ( tcpSocket, buffer, sizeof ( buffer )-1,0 );
-//                  x2goDebug&lt;&lt;nbytes&lt;&lt;&quot; bytes from tcp socket &quot;&lt;&lt;tcpSocket&lt;&lt;endl;
+#ifdef DEBUG
+                //                  x2goDebug&lt;&lt;nbytes&lt;&lt;&quot; bytes from tcp socket &quot;&lt;&lt;tcpSocket&lt;&lt;endl;
+#endif
                 if ( nbytes &gt; 0 )
                 {
                     if ( channel_write ( channel, buffer, nbytes ) !=nbytes )
@@ -1283,11 +1347,15 @@ void SshMasterConnection::channelLoop()
                         QString err=ssh_get_error ( my_ssh_session );
                         QString errorMsg=tr ( &quot;channel_write failed&quot; );
                         emit ioErr ( channelConnections[i].creator, errorMsg, err );
+#ifdef DEBUG
                         x2goDebug&lt;&lt;errorMsg&lt;&lt;&quot; - &quot;&lt;&lt;err&lt;&lt;endl;
+#endif
                         finalize ( i );
                         continue;
                     }
-//                      x2goDebug&lt;&lt;nbytes&lt;&lt;&quot; bytes wrote to channel&quot;&lt;&lt;channel&lt;&lt;endl;
+#ifdef DEBUG
+                    //                      x2goDebug&lt;&lt;nbytes&lt;&lt;&quot; bytes wrote to channel&quot;&lt;&lt;channel&lt;&lt;endl;
+#endif
                 }
                 if ( nbytes &lt; 0 )
                 {
@@ -1295,7 +1363,9 @@ void SshMasterConnection::channelLoop()
                     QString err=&quot;&quot;;
                     QString errorMsg=tr ( &quot;error reading tcp socket&quot; );
                     emit ioErr ( channelConnections[i].creator, errorMsg, err );
+#ifdef DEBUG
                     x2goDebug&lt;&lt;errorMsg&lt;&lt;&quot; - &quot;&lt;&lt;err&lt;&lt;endl;
+#endif
                     finalize ( i );
                     continue;
                 }
diff --git a/x2goclientconfig.h b/x2goclientconfig.h
index 341c1f7..e857e53 100644
--- a/x2goclientconfig.h
+++ b/x2goclientconfig.h
@@ -23,7 +23,7 @@
 #include &lt;qglobal.h&gt;
 
 
-// #define LOGFILE QDir::homePath()+&quot;/x2goclient.log&quot;
+//#define LOGFILE QDir::homePath()+&quot;/x2goclient.log&quot;
 
 #if !defined Q_OS_WIN
 #define USELDAP
diff --git a/x2gologdebug.cpp b/x2gologdebug.cpp
index c21c1c3..0fd8ada 100644
--- a/x2gologdebug.cpp
+++ b/x2gologdebug.cpp
@@ -28,7 +28,6 @@ X2goLogDebug::X2goLogDebug():QTextStream()
     }
 }
 
-
 X2goLogDebug::~X2goLogDebug()
 {
  	logFile.close();
diff --git a/x2gologdebug.h b/x2gologdebug.h
index b35f783..ded6d8d 100644
--- a/x2gologdebug.h
+++ b/x2gologdebug.h
@@ -20,21 +20,50 @@
 #include &lt;QTextStream&gt;
 #include &lt;QFile&gt;
 #include &quot;x2goclientconfig.h&quot;
+#include &quot;onmainwindow.h&quot;
 /**
 	@author Oleksandr Shneyder &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/x2go-commits">oleksandr.shneyder at obviously-nice.de</A>&gt;
 */
+
+#define __x2goPrefix      &quot;x2go-&quot;
+#define __x2goDebugPrefix &quot;DEBUG-&quot;
+#define __x2goInfoPrefix  &quot;INFO-&quot;
+#define __x2goWarningPrefix  &quot;WARNING-&quot;
+#define __x2goErrorPrefix &quot;ERROR-&quot;
+#define __x2goPostfix     &quot;&gt; &quot;
+
 #ifdef LOGFILE
 class X2goLogDebug: public QTextStream
 {
 public:
     X2goLogDebug();
     ~X2goLogDebug();
+
  private:
      QFile logFile;
 };
-#define x2goDebug X2goLogDebug()
+
+#define __x2goDebug   X2goLogDebug()&lt;&lt;&quot;\n&quot;
+#define __x2goInfo    X2goLogDebug()&lt;&lt;&quot;\n&quot;
+#define __x2goWarning X2goLogDebug()&lt;&lt;&quot;\n&quot;
+#define __x2goError   X2goLogDebug()&lt;&lt;&quot;\n&quot;
+
 #else
+
 #include &lt;QDebug&gt;
-#define x2goDebug qDebug()
+
+#define __x2goDebug   qDebug().nospace()
+#define __x2goInfo    qDebug().nospace()
+#define __x2goWarning qWarning().nospace()
+#define __x2goError   qCritical().nospace()
+
 #endif //LOGFILE
+
+#define x2goDebugf        __x2goDebug  &lt;&lt;__x2goPrefix&lt;&lt;__x2goDebugPrefix  &lt;&lt;__FILE__&lt;&lt;&quot;:&quot;&lt;&lt;__LINE__&lt;&lt;__x2goPostfix
+#define x2goInfof(NUM)    __x2goInfo   &lt;&lt;__x2goPrefix&lt;&lt;__x2goInfoPrefix   &lt;&lt;NUM                    &lt;&lt;__x2goPostfix
+#define x2goWarningf(NUM) __x2goWarning&lt;&lt;__x2goPrefix&lt;&lt;__x2goWarningPrefix&lt;&lt;NUM                    &lt;&lt;__x2goPostfix
+#define x2goErrorf(NUM)   __x2goError  &lt;&lt;__x2goPrefix&lt;&lt;__x2goErrorPrefix  &lt;&lt;NUM                    &lt;&lt;__x2goPostfix
+
+#define x2goDebug      if (ONMainWindow::debugging) x2goDebugf
+
 #endif //X2GOLOGDEBUG_H


hooks/post-receive
-- 
x2goclient.git (X2Go Client)

This is an automated email from the git hooks/post-receive script. It was
generated because a ref change was pushed to the repository containing
the project &quot;x2goclient.git&quot; (X2Go Client).

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="012181.html">[X2Go-Commits] x2goclient.git - build-main (branch) updated:	4.0.1.0-13-g35aa03e
</A></li>
	<LI>Next message: <A HREF="012171.html">[X2Go-Commits] x2goclient.git - build-main (branch) updated:	4.0.1.0-25-g67b1b42
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12192">[ date ]</a>
              <a href="thread.html#12192">[ thread ]</a>
              <a href="subject.html#12192">[ subject ]</a>
              <a href="author.html#12192">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/x2go-commits">More information about the X2Go-commits
mailing list</a><br>
</body></html>
