<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [X2go-Commits] x2gothinclient.git - build-main (branch) updated:	1.0.1.3
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/x2go-commits/2011-October/index.html" >
   <LINK REL="made" HREF="mailto:x2go-commits%40lists.berlios.de?Subject=Re%3A%20%5BX2go-Commits%5D%20x2gothinclient.git%20-%20build-main%20%28branch%29%20updated%3A%0A%091.0.1.3&In-Reply-To=%3C20111012102116.A24265DD11%40ymir%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001730.html">
   <LINK REL="Next"  HREF="001732.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[X2go-Commits] x2gothinclient.git - build-main (branch) updated:	1.0.1.3</H1>
    <B>X2go dev team</B> 
    <A HREF="mailto:x2go-commits%40lists.berlios.de?Subject=Re%3A%20%5BX2go-Commits%5D%20x2gothinclient.git%20-%20build-main%20%28branch%29%20updated%3A%0A%091.0.1.3&In-Reply-To=%3C20111012102116.A24265DD11%40ymir%3E"
       TITLE="[X2go-Commits] x2gothinclient.git - build-main (branch) updated:	1.0.1.3">git-admin at x2go.org
       </A><BR>
    <I>Wed Oct 12 12:21:16 CEST 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="001730.html">[X2go-Commits] x2gothinclient.git - master (branch) updated:	5ae6b6661a327d11dfb0a86906ba72d0352bb283
</A></li>
        <LI>Next message: <A HREF="001732.html">[X2go-Commits] x2goplasmabindings.git - master (branch) updated:	970ec47869c6e74cd68332e3c28d39c816bb2aee
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1731">[ date ]</a>
              <a href="thread.html#1731">[ thread ]</a>
              <a href="subject.html#1731">[ subject ]</a>
              <a href="author.html#1731">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>The branch, build-main has been updated
       via  5ae6b6661a327d11dfb0a86906ba72d0352bb283 (commit)
       via  32a9d8c786a5bafc1e3f496936a7b25d16750de2 (commit)
       via  cd4dad8cdd8ab429e8f6376f44f162e32dde001e (commit)
       via  493179488b6b7a05cfb246dd89e7554ec00ebd53 (commit)
       via  d91338434a42e59a268bd3e1f68060aee7897ac4 (commit)
       via  7644a08988d56df5afa229ed8e67c59a0b923bf2 (commit)
       via  29884c0ea40aeb6664be0f2e2b83305584da321b (commit)
       via  93121f78c4aa8fdb055220937d1c38d3b3fa3f5c (commit)
       via  e3988859da138f3295a712ebbc9cd88cd651783a (commit)
      from  3331a0057c0ff4a967351911fd0e51c2d2be2d38 (commit)

Those revisions listed above that are new to this repository have
not appeared on any other notification email; so we list those
revisions in full, below.

- Log -----------------------------------------------------------------
-----------------------------------------------------------------------

Summary of changes:
 VERSION                                            |    2 +-
 debian/changelog                                   |   97 +++++++++++--------
 x2gosmartcardrules/21-x2gognupgccid.rules          |    2 +
 x2gothinclient/sbin/x2gothinclientd                |    6 +-
 .../man/x2gothinclient_preptftpboot.8              |   32 ++++++-
 .../sbin/x2gothinclient_create                     |    3 +-
 .../share/x2gothinclient_start                     |    1 +
 7 files changed, 97 insertions(+), 46 deletions(-)

The diff of changes is:
diff --git a/VERSION b/VERSION
index 636ed6a..ba6c0fc 100644
--- a/VERSION
+++ b/VERSION
@@ -1 +1 @@
-1.0.1.2
\ No newline at end of file
+1.0.1.3
diff --git a/debian/changelog b/debian/changelog
index d6df0d3..344f9b0 100644
--- a/debian/changelog
+++ b/debian/changelog
@@ -1,48 +1,63 @@
-x2gothinclient (1.0.1.3-0~x2go1) UNRELEASED; urgency=low
+x2gothinclient (1.0.1.3-0~x2go1.1) unstable; urgency=low
+
+  [ Mike Gabriel ]
+  New upstream version (1.0.1.3):
+    - Split up x2gocdmanager package into x2gocdmanager and x2gothinshutdown
+      package
+    - Fix USB mounting, CD mounting, 
+    - Improve code layout (tab stops, inline comments)
+    - Add HTTP_PROXY and FTP_PROXY support to x2gothinclientmanagement (APT
+      package download)
+    - Add example files/symlinks for tftpboot environment.
+    - Add syslinux boot splash with X2go flavour.
+    - Install 486 and 686 kernels in TCE chroot.
+    - Move PXE tftpboot examples to x2gothinclient/share/tftpboot.
+    - Improval of syslinux boot screen. 
+    - Add x2gothinclient_preptftpboot script.
+    - Add man page for x2gothinclient_preptftpboot.
+    - Do not run management script if there is a problem with the X2go TCE
+      chroot.
+    - Sanity checks: X2go TCE management script have to run as root.
+    - Add HTTPS_PROXY support.
+    - Add x2gothinclient_cleanup script.
+    - Add man page for x2gothinclient_cleanup.
+    - Run x2gothinclient_init from x2gothinclientd init script.
+    - Fix udev rules path in x2gosmartcardrules, improval of udev script, plus man page.
+    - Fix udev rules path in x2gousbmount.
+    - Add comment that names possible boot profiles to tftp config template.
+    - Add kernel module blacklisting for x2gothinclient_create.
+    - Tweak mtab diversion on X2go Thin Client to avoid error messages.
+    - Add some more PXE/TFTP info at end of x2gothinclient_pretftpboot script.
+    - Disable service restarts in chroot.
+    - Add a ,,hit &lt;RETURN&gt; before TCE creation.
+    - Add tmpfs mount for /var/lib/dbus.
+    - Reduce x2goclient CPU load from ~100% to ~0-1%.
+    - Boot TCE kernel with nomodeset boot option to avoid gCard incompatibilities
+      (Fb vs. Xorg). 
+    - Move kernel/initrd symlinks after install rather than copying.
+    - Add detection of kernel upgrades to x2gothinclient_upgrade script.
+    - Adapt chroot file created by x2gothinclient_upgrade, escaping $-signs.
+    - Use --no-session-edit option when starting x2goclient on TCE.
+    - Delay thinshutdown button appearance for 4+6 seconds on X server
+      (re)start (that is: 10s on tce start or X server restart and 4s after session
+      logout).
+    - Add post-run instructions of x2gothinclient_preptftpboot to its man page.
 
-  * Split up x2gocdmanager package into x2gocdmanager and x2gothinshutdown
-    package
-  * Fix USB mounting, CD mounting, 
-  * Improve code layout (tab stops, inline comments)
-  * Add HTTP_PROXY and FTP_PROXY support to x2gothinclientmanagement (APT
-    package download)
-  * Fix for proxy code, env variables are $http_proxy and $ftp_proxy.
-  * Add example files/symlinks for tftpboot environment.
-  * Add syslinux boot splash with X2go flavour.
-  * Remove ssh (=openssh-server) dependency for x2gothinclient package.
   * Add acpid to x2gothinclient's Recommends: section.
-  * Install 486 and 686 kernels in TCE chroot. 
-  * Add memtest86+ to x2gothinclient's Recommends: section. 
-  * Move PXE tftpboot examples to x2gothinclient/share/tftpboot.
-  * Improval of syslinux boot screen. 
-  * Add x2gothinclient_preptftpboot script.
-  * Add man page for x2gothinclient_preptftpboot.
-  * Do not run management script if there is a problem with the X2go TCE chroot.
-  * X2go TCE management script have to run as root.
-  * Add https_proxy env variable support.
-  * Add x2gothinclient_cleanup script.
-  * Add man page for x2gothinclient_cleanup.
-  * Run x2gothinclient_init from x2gothinclientd init script.
-  * Fix udev rules path in x2gosmartcardrules, improval of udev script, plus man page.
-  * Fix udev rules path in x2gousbmount.
-  * Add comment that names possible boot profiles to tftp config template.
+  * Remove ssh (=openssh-server) dependency for x2gothinclient package.
+  * Add memtest86+ to x2gothinclient's Recommends: section.
   * Add midnight commander to Recommends: of x2gothinclient.
-  * Add kernel module blacklisting for x2gothinclient_create.
-  * Tweak mtab diversion on X2go Thin Client to avoid error messages.
-  * Add some more PXE/TFTP info at end of x2gothinclient_pretftpboot script.
-  * Disabled service restarts in chroot.
-  * Add a ,,hit &lt;RETURN&gt; before TCE creation.
-  * Add tmpfs mount for /var/lib/dbus.
-  * More variable ($) escaping in x2gothinclient_* scripts. Fixes start-stop-daemon
-    enable/disable code.
-  * Reduce x2goclient CPU load from ~100% to ~0-1%.
-  * Boot TCE kernel with nomodeset boot option to avoid gCard incompatibilities
-    (Fb vs. Xorg). 
-  * Move kernel/initrd symlinks after install rather than copying. 
-  * Add detection of kernel upgrades to x2gothinclient_upgrade script. 
-  * Adapt chroot file created by x2gothinclient_upgrade, escaping $-signs. 
+  * x2gothinshutdown: conflicts x2gocdmanager&lt;=1.0.1.2.
+
+  [ Coco ]
+  Improvements for upstream version (1.0.1.3):
+    - Replace tmpfs mount on /etc/network/run with symlink /etc/network/run -&gt; /dev/shm.
+
+  [ Oleksandr Shneyder ]
+  Improvements for upstream version (1.0.1.3):
+    - x2gosmartcardrules: support for SCM SCR331-LC1 SmartCard Reader.
 
- -- Mike Gabriel &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/x2go-commits">mike.gabriel at das-netzwerkteam.de</A>&gt;  Sat, 28 May 2011 12:04:34 +0200
+ -- Mike Gabriel &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/x2go-commits">mike.gabriel at das-netzwerkteam.de</A>&gt;  Wed, 12 Oct 2011 12:16:59 +0200
 
 x2gothinclient (1.0.1.2-0~x2go1) unstable; urgency=low
 
diff --git a/x2gosmartcardrules/21-x2gognupgccid.rules b/x2gosmartcardrules/21-x2gognupgccid.rules
index 77b5822..543acde 100644
--- a/x2gosmartcardrules/21-x2gognupgccid.rules
+++ b/x2gosmartcardrules/21-x2gognupgccid.rules
@@ -3,6 +3,8 @@
 
 ACTION==&quot;add&quot;, SUBSYSTEM==&quot;usb&quot;, ENV{PRODUCT}==&quot;4e6/e003/*&quot;, RUN+=&quot;/usr/lib/x2go/tce/x2gognupgccid&quot;
 ACTION==&quot;add&quot;, SUBSYSTEM==&quot;usb&quot;, ENV{PRODUCT}==&quot;4e6/5115/*&quot;, RUN+=&quot;/usr/lib/x2go/tce/x2gognupgccid&quot;
+#SCM SCR331-LC1 SmartCard Reader
+ACTION==&quot;add&quot;, SUBSYSTEM==&quot;usb&quot;, ENV{PRODUCT}==&quot;4e6/5116/*&quot;, RUN+=&quot;/usr/lib/x2go/tce/x2gognupgccid&quot;
 #OMNIKEY
 ACTION==&quot;add&quot;, SUBSYSTEM==&quot;usb&quot;, ENV{PRODUCT}==&quot;76b/3021/*&quot;, RUN+=&quot;/usr/lib/x2go/tce/x2gognupgccid&quot;
 #CHERRY
diff --git a/x2gothinclient/sbin/x2gothinclientd b/x2gothinclient/sbin/x2gothinclientd
index 63e3984..9efdb7d 100755
--- a/x2gothinclient/sbin/x2gothinclientd
+++ b/x2gothinclient/sbin/x2gothinclientd
@@ -90,10 +90,14 @@ elsif ($pid == 0 )
 	while(sleep 1)
 	{
 
+		my $thinshutdown_delay = 4;
+
 		# test if XServer is running, if not launch it...
 		if ( check_x() ==0 )
 		{
 			system(&quot;/usr/bin/Xorg -br &amp;&quot;);
+			# delay appearance of thinshutdown button a little longer on X server (re)start
+			$thinshutdown_delay = 10;
 		}
 
 		# test if pulseaudio is running, if not launch it...
@@ -123,7 +127,7 @@ elsif ($pid == 0 )
 		}
 		if (  !$SHUTD &amp;&amp; !$PROXY &amp;&amp; $CLIENT)
 		{
-			system(&quot;sleep 4; DISPLAY=:0 thinshutdown &amp;&quot;);
+			system(&quot;sleep $thinshutdown_delay; DISPLAY=:0 thinshutdown &amp;&quot;);
 		}
 
 		## wait for x2goclient to finish
diff --git a/x2gothinclientmanagement/man/x2gothinclient_preptftpboot.8 b/x2gothinclientmanagement/man/x2gothinclient_preptftpboot.8
index 379b3ff..44b8e3f 100644
--- a/x2gothinclientmanagement/man/x2gothinclient_preptftpboot.8
+++ b/x2gothinclientmanagement/man/x2gothinclient_preptftpboot.8
@@ -18,12 +18,40 @@ x2gothinclient_preptftpboot \- Prepare PXE/Syslinux Boot Environment (delivered
 This helper script prepares X2go's PXE/Syslinux boot environment. As X2go PXE
 server you can either use your X2go server itself or a dedicated machine or VM that merely serves
 as PXE boot server.
-
+.PP
 Please run the \fBx2gothinclient_create\fR helper script first before you run this script.
-
+.PP
 This script can only be called if the PXE boot dir (default: /srv/tftp) does not already
 contain any other PXE/Syslinux boot environment.
+.SH MANUAL STEPS AFTER SCRIPT HAS RUN
+At the end of \fBx2gothinclient_preptftpboot\fR 2-3 manual steps are still needed (as displayed by
+the script itself when run)... The $TC_* variables mentioned in the text below have to be
+obtained from \fI/etc/x2go/x2gothinclient_settings\fR.
+.PP
+    1. Make sure your DHCP server's configuration points to:
+.PP
+            next-server &lt;IP-or-hostname-of-this-server&gt;;
+            filename '/pxelinux.0';
+.PP
+    2. Export the X2go Thin Client chroot environment via NFSv3:
+.PP
+        Add this line to /etc/exports... (in one line):
+.PP
+            $TC_CHROOT\ &lt;network&gt;/&lt;netmask&gt;(ro,async,no_root_squash,no_subtree_check)
+.PP
+        ... and then restart your NFS server with:
+.PP
+            /etc/init.d/nfs-kernel-server restart
+.PP
+    3. Customize PXE/Syslinux files in $TC_TFTP_BOOT/ (optional):
+.PP
+        - customize PXE boot menu, take a look at
+.PP
+              $TC_TFTP_BOOT/default.cfg
 .PP
+          and proceed from there on...
+        - use your own boot loader background image: 640x480px,
+          16bit colour depth, file: $TC_TFTP_BOOT/x2go-tce.png
 .SH OPTIONS
 \fBx2gothinclient_pretftpboot\fR has no known options.
 .PP
diff --git a/x2gothinclientmanagement/sbin/x2gothinclient_create b/x2gothinclientmanagement/sbin/x2gothinclient_create
index 594770e..c5bf7e7 100755
--- a/x2gothinclientmanagement/sbin/x2gothinclient_create
+++ b/x2gothinclientmanagement/sbin/x2gothinclient_create
@@ -83,7 +83,6 @@ cat &gt; $TC_CHROOT/etc/fstab &lt;&lt;EOF
 none	/dev/pts		devpts	gid=5,mode=620		0	0
 none	/tmp			tmpfs	size=50M,mode=1777	0	0
 none	/root			tmpfs	size=100M,mode=700	0	0
-none	/etc/network/run	tmpfs	size=50M		0	0
 none	/etc/udev/rules.d	tmpfs	size=50M		0	0
 none	/var/run		tmpfs	size=50M		0	0
 none	/var/log		tmpfs	size=50M		0	0
@@ -111,6 +110,8 @@ mkdir -p /tmp/user/0
 mkdir -p /var/lib/xkb
 mkdir -p /var/lib/nfs
 mkdir -p /var/lib/dbus
+mkdir -p /etc/network
+ln -sf /dev/shm /etc/network/run 
 
 # disable service restarts
 test -e /sbin/start-stop-daemon.keep || mv /sbin/start-stop-daemon /sbin/start-stop-daemon.keep
diff --git a/x2gothinclientmanagement/share/x2gothinclient_start b/x2gothinclientmanagement/share/x2gothinclient_start
index 90158cd..68c4a05 100755
--- a/x2gothinclientmanagement/share/x2gothinclient_start
+++ b/x2gothinclientmanagement/share/x2gothinclient_start
@@ -28,6 +28,7 @@
                     --set-kbd=1 \
                     --geometry=fullscreen \
                     --read-exports-from=/home/x2goclient/export \
+                    --no-session-edit \
                     --add-to-known-hosts &amp;
 
 # for use with LDAP on Skolelinux network


hooks/post-receive
-- 
x2gothinclient.git (X2go Thin Client Environment)

This is an automated email from the git hooks/post-receive script. It was
generated because a ref change was pushed to the repository containing
the project &quot;x2gothinclient.git&quot; (X2go Thin Client Environment).


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001730.html">[X2go-Commits] x2gothinclient.git - master (branch) updated:	5ae6b6661a327d11dfb0a86906ba72d0352bb283
</A></li>
	<LI>Next message: <A HREF="001732.html">[X2go-Commits] x2goplasmabindings.git - master (branch) updated:	970ec47869c6e74cd68332e3c28d39c816bb2aee
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1731">[ date ]</a>
              <a href="thread.html#1731">[ thread ]</a>
              <a href="subject.html#1731">[ subject ]</a>
              <a href="author.html#1731">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/x2go-commits">More information about the X2go-commits
mailing list</a><br>
</body></html>
