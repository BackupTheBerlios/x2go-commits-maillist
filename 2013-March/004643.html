<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [X2Go-Commits] page changed: wiki:obsolete:tce-old
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/x2go-commits/2013-March/index.html" >
   <LINK REL="made" HREF="mailto:x2go-commits%40lists.berlios.de?Subject=Re%3A%20%5BX2Go-Commits%5D%20page%20changed%3A%20wiki%3Aobsolete%3Atce-old&In-Reply-To=%3C20130312200305.9396.2117797385.swift%40wiki.x2go.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="004642.html">
   <LINK REL="Next"  HREF="004644.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[X2Go-Commits] page changed: wiki:obsolete:tce-old</H1>
    <B>wiki-admin at x2go.org</B> 
    <A HREF="mailto:x2go-commits%40lists.berlios.de?Subject=Re%3A%20%5BX2Go-Commits%5D%20page%20changed%3A%20wiki%3Aobsolete%3Atce-old&In-Reply-To=%3C20130312200305.9396.2117797385.swift%40wiki.x2go.org%3E"
       TITLE="[X2Go-Commits] page changed: wiki:obsolete:tce-old">wiki-admin at x2go.org
       </A><BR>
    <I>Tue Mar 12 21:03:05 CET 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="004642.html">[X2Go-Commits] page changed: wiki:obsolete:nx-libs
</A></li>
        <LI>Next message: <A HREF="004644.html">[X2Go-Commits] page changed: wiki:obsolete:ubuntu-old
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4643">[ date ]</a>
              <a href="thread.html#4643">[ thread ]</a>
              <a href="subject.html#4643">[ subject ]</a>
              <a href="author.html#4643">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>A page in your DokuWiki was added or changed. Here are the details:

Date        : 2013/03/12 20:03
Browser     : Mozilla/5.0 (X11; Linux x86_64; rv:18.0) Gecko/20100101 Firefox/18.0 Iceweasel/18.0.1
IP-Address  : 46.142.148.41
Hostname    : 41-148-142-46.pool.kielnet.net
Old Revision: <A HREF="http://wiki.x2go.org/doku.php/wiki:obsolete:tce-old?rev=1362749499">http://wiki.x2go.org/doku.php/wiki:obsolete:tce-old?rev=1362749499</A>
New Revision: <A HREF="http://wiki.x2go.org/doku.php/wiki:obsolete:tce-old">http://wiki.x2go.org/doku.php/wiki:obsolete:tce-old</A>
Edit Summary: removed
User        : sunweaver

@@ -1,599 +1 @@
- ~~NOTOC~~
- ====== Installation ======
  
- &lt;note warning&gt;THIS PAGE IS OBSOLETE, DO NOT BELIEVE ITS CONTENT (ANYMORE)!!!&lt;/note&gt;
- 
- ===== Adding the needed Debian Repository to your system =====
- 
- To get started you'll need to configure your local system to access the official X2go Debian repository. Please keep in mind that this installation manual will guide you through the installation on a Debian Lenny system. The repository will offer you packages for i386, amd64 and powerpc architectures. 
-
Commands printed inside the yellow boxes have to be entered in a command line client (please use /bin/bash as operating shell).
- Before starting to edit your system configuration, you'll need to add the needed GPG keys of the repository. Please switch to an user which has administrator privileges on your system in your preferred command line client: 
- 
- &lt;code&gt;
- # su
- &lt;/code&gt;
- 
- The following commands will ensure that your system will be able to work with the repository key:
- 
- &lt;code&gt;
- # gpg --keyserver wwwkeys.eu.pgp.net --recv-keys C509840B96F89133
- # gpg -a --export C509840B96F89133 | apt-key add - 
- &lt;/code&gt;
- 
- Please edit the file /etc/apt/sources.list with your preferred editor (in this example &#8220;vi&#8221;) and add the X2go repository as a new line:
- 
- &lt;code&gt;
- # vi /etc/apt/sources.list
- &lt;/code&gt;
- 
- In this case the lines which have to be added to &#8220;/etc/apt/sources.list&#8221; are:\\ 
- //Dark blue boxes like the one below will show you the content of text
files//.
- 
- &lt;file&gt;
- # X2go Repository
- deb <A HREF="http://x2go.obviously-nice.de/deb/">http://x2go.obviously-nice.de/deb/</A> lenny main
- &lt;/file&gt;
- 
- Please perform an update on your debian package database:
- 
- &lt;code&gt;
- # apt-get update
- &lt;/code&gt;
- 
- After the update you should be able to access the x2go packages via the apt command:
- 
- &lt;code&gt;
- # apt-cache search x2go
- &lt;/code&gt;
- 
- Congratulations, you are now able to access the x2go packages. You may continue by installing x2goclient, x2goserver-one or x2goserver.
- 
- ===== Installing X2goserver-ONE (One Node Edition) =====
- 
- X2goserver-ONE is a meta package which will install an x2goserver for a single host. This meta package will take care of configuring your system and you'll be able to use it after very short time. This &#8220;One Node Edition&#8221; fits perfectly inside virtual machines and on single PC's. An unlimited number of users can access this PC &#8211; but you won't be able to use multi server features like &#8220;load balancing&#8221;. 
- 
- &lt;code&gt;
- # apt-get
install x2goserver-one
- &lt;/code&gt;
- 
- Depending on the already installed packages, this command will add additional software to your computer. Please make sure that the following packages are installed: SSHFS, FUSE and SQLIGHT3. 
- Congratulations &#8211; you are now able to access your PC with the help of a  configured x2goclient.
- 
- &lt;code&gt;
- # apt-get install sshfs
- &lt;/code&gt;
- 
- :!: **Warning!**
- &gt; If you add further users to your system, please make sure that they are part of the posix group &#8220;x2gousers&#8221;, so that they are able to log into the X2go system.
- 
- :!: **Warning!**
- &gt; If you would like to use the file system sharing option of X2go, you'll need to make sure that those users also are part of the posix group &#8220;fuse&#8221;. This membership is also needed by x2goprint.
- 
- ===== Installing x2goprint (low bandwith capable print service) =====
- 
- :!: **Warning!**
- &gt; This print service is intended for use on low bandwith networks &#8211; like internet connections or GSM
connections. You won't need it inside normal networks &#8211; except for the case that you want to use printers which are directly connected to the (thin-)clients. X2goprint can be used with x2goserver-one, x2goserver-home and x2goserver (full features).
- 
- You'll need a running cups printing server to use X2goprint. You can use an existing cups server on your network or you can install a cups server on the same machine X2goserver is running on. The x2go cups engine is installed this way (in this example on the same machine):
- 
- &lt;code&gt;
- # apt-get install cups-x2go
- &lt;/code&gt;
- 
- In any case, you'll need to install x2goprint on every server running X2goserver. You can install it by executing:
- 
- &lt;code&gt;
- # apt-get install x2goprint
- &lt;/code&gt;
- 
- The package &#8220;x2goprint&#8221; will add an user to the system and will configure the sudoers daemon by extending the file /etc/sudoers. After the installation, you are able to add a new printer to the cups system named &#8220;x2goprinter&#8221;. As
device you should select the &#8220;Virtual x2go Printer&#8221;(vendor: &#8220;generic&#8221;/model: &#8220;Generic CUPS-X2GO Printer&#8221;).
- You may configure further options by editing the file &#8220;/etc/cups/cups-x2go.conf&#8221;. 
- 
- ==== Using X2goprint on a centralized cups server ====
- 
- If you would like to run X2goserver and the cups service on different machines, you'll need to generate a pair of SSH keys. Please make sure that you are logged in as user &#8220;root&#8221; on the system running the cups service and add the following folders:
- 
- &lt;code&gt;
- # mkdirhier /root/.x2go/ssh/.x2goprint/
- &lt;/code&gt;
- 
- Now you can generate the keys:
- 
- &lt;code&gt;
- # ssh-keygen -N &quot;&quot; -t dsa -f /root/.x2go/ssh/.x2goprint/id_dsa
- &lt;/code&gt;
- 
- The public part of the key (/root/.x2go/ssh/.x2goprint/id_dsa.pub) needs to be added to the x2goprint user's &#8220;authorized_keys&#8221; file on the x2goserver(s). You can do this with your favourite editor. Please make sure, that you've chosen the right user and system:
- 
- &lt;code&gt;
-
<A HREF="https://lists.berlios.de/mailman/listinfo/x2go-commits">x2goprint at localhost</A>:~$ cat id_dsa-pub &gt;&gt; ~/.ssh/authorized_keys
- &lt;/code&gt;
- 
- Every x2goserver running X2goprint needs to be known by the cups server. Regarding your name resolution type, you'll need to add the host names for example to the local /etc/hosts file. Please test if you are able to reach the x2goservers by entering the following command:
- 
- &lt;code&gt;
- # ssh -i  /root/.x2go/ssh/.x2goprint/id_dsa <A HREF="https://lists.berlios.de/mailman/listinfo/x2go-commits">x2goprint at x2goserver1</A>
- # ssh -i  /root/.x2go/ssh/.x2goprint/id_dsa <A HREF="https://lists.berlios.de/mailman/listinfo/x2go-commits">x2goprint at x2goserver2</A>
- &lt;/code&gt;
- 
- ===== Installing X2goserver (complete version)=====
- 
- If you would like to use the full featured version of x2goserver, you'll need to configure X2goserver by yourself. There are a lot of different possibilities to install X2goserver in a network of existing services. This manual will describe  the installation on clean and freshly installed systems. The full featured version of X2goserver is needed, if you are planing to use more than one server and those servers should be
configured as a server group. This setup will need a PostgreSQL server to store X2go related session information. If you'll continue installation, you'll further need an LDAP server. You can start the installation by installing the base server package:
- 
- &lt;code&gt;
- # apt-get install x2goserver
- &lt;/code&gt;
- 
- Depending on the already installed packages, this command will add additional software to your computer. Please make sure that the following packages are installed: SSHFS and FUSE. You'll further need a PostgreSQL server running in your network. You may use the same server you are installing X2goserver on. If you want to do so, please enter:
- 
- &lt;code&gt;
- # apt-get install postgres
- &lt;/code&gt;
- 
- ==== Setting login permissions ====
- 
- Please make sure that every user which should be able to log into the x2go system is part of the posix group &#8220;x2gousers&#8221;. You can add an user to the &#8220;x2gousers&#8221; group by executing following command:
- 
- &lt;code&gt;
- # adduser username
x2gousers
- &lt;/code&gt;
- 
- ==== Configuriung the file sharing option ====
- 
- If you would like to use the file sharing option of x2go, you'll need to install SSHFS:
- 
- &lt;code&gt;
- # apt-get install sshfs
- &lt;/code&gt;
- 
- You will also need to check the permissions an add the selected users to the &#8220;fuse&#8221; group.
- 
- ==== Installing the database ====
- 
- X2goserver will need a database to store session information. You'll only need one PostgreSQL server in your network to do this job. If you plan to run X2goserver and PostgreSQL on the same machine, you'll need to install PostgreSQL with the following command:
- 
- &lt;code&gt;
- # apt-get install postgresql
- &lt;/code&gt;
- 
- The database itself will be installed by a simple shell script:
- 
- &lt;code&gt;
- # cd /usr/lib/x2go/script
- # ./x2gocreatebase.sh
- &lt;/code&gt;
- 
- ==== Using an existent database server on the network ====
- 
- If you want to use an already existent PostgreSQL database server in your network, you'll need to allow the
x2goserver(s) access to the database server.
- First of all, you'll need to tell the address of the target server to every x2goserver:
- 
- &lt;code&gt;
- # echo -n &#8222;address of postgres server&#8220; &gt; /etc/x2go/sql
- &lt;/code&gt;
- 
- Furthermore you'll need to allow &#8220;passwordless&#8221; authentication via SSH keys. Please don't add a &#8220;paraphrase&#8221; to the generated key:
- 
- &lt;code&gt;
- # mkdirhier /root/.x2go/ssh/.pg
- # ssh-keygen -t das -f /root/.x2go/ssh/.pg/id_dsa
- &lt;/code&gt;
- 
- To copy the public part of the key to the PostgreSQL server, you may use the &#8220;ssh-copy-id&#8221; command to combine transfer and paste command, or you can paste the key after transferring it by yourself:
- 
- &lt;code&gt;
- # cat id_dsa-pub &gt;&gt; ~postgres/.ssh/authorized_keys
- &lt;/code&gt;
- 
- You can test the needed connection by entering following command:
- 
- &lt;code&gt;
- # ssh -i /root/.x2go/ssh/.pg/id_dsa <A HREF="https://lists.berlios.de/mailman/listinfo/x2go-commits">postgres at server</A>
- &lt;/code&gt;
- 
- You'll also need to run the &#8220;x2gocreatebase.sh&#8221; script as described before on the database
server to create the needed instance.
- 
- ===== Installation of the LDAP Tools =====
- 
- :!: **Warning!**
- &gt; The following manual will guide you through the installation of the x2go LDAP tools. This will add multi server functionalities, a messaging service and other extensions to a x2goserver. You'll also be able to use additional graphical administration tools. Please be careful &#8211; the commands will alter your system configuration. Be prepared and backup your system!
- 
- You can use every directory service which can handle InetOrgPerson, PosixAccount, and SambaAccount (optional) schemas. This manual describes the installation on OpenLDAP servers.
- You'll start the installation by installing the x2goldaptools package and the graphical administration modules:
- 
- &lt;code&gt;
- # apt-get install x2goldaptools \
- x2gouseradministration x2gohostadministration \
- x2gosystemadministration x2gogroupadministration
- &lt;/code&gt;
- 
- As a dependency, openldap will be installed, too. You may
ignore any configuration dialogues during the installation. You'll build new configuration files during the configuration process.
- 
- ==== Configuring name resolution ====
- 
- X2go uses the host name of the machines for identification. Please ensure that the command hostname, the env variable $HOSTNAME and other name resolution services return the same value:
- 
- &lt;code&gt;
- # echo $HOSTNAME
- &lt;/code&gt;
- 
- Enter the host names and IP addresses of all servers into the /etc/hosts file (or the used name resolution service).
- 
- &lt;code&gt;
- # echo &quot;192.168.0.1 x2goserver.local x2goserver&quot; &gt;&gt; /etc/hosts
- &lt;/code&gt;
- 
- ==== Installation of the samba schemata (optional) ====
- 
- If you would like to use the OpenLDAP server also to store samba accounts, you should install the smb extension. You may use the graphical x2go administration tools to administrate the smb groups and the boolean permission of an account to allow smb login.
- 
- &lt;code&gt;
- # cp
/usr/share/doc/samba-doc/examples/LDAP/samba.schema.gz \
- /etc/ldap/schema
- # cd /etc/ldap/schema
- # gunzip samba.schema.gz
- &lt;/code&gt;
- 
- ==== Generate LDAP configuration ====
- 
- :!: **Warning!**
- &gt; The script &#8220;genconf&#8221; will produce a new LDAP configuration and will change existing configuration files. Please back up your /etc directory to avoid any problems. If you have an existing LDAP Server with existing users and groups &#8211; don't use this script!
- 
- Change into the directory containing the &#8220;genconf&#8221; script:
- 
- &lt;code&gt;
- # cd /usr/share/x2goldaptools/config/
- &lt;/code&gt;
- 
- The &#8220;genconf&#8221; script will create new configuration files for your /etc directory. If you execute it without any options, you'll get information about the command syntax:
- 
- &lt;code&gt;
- #./genconf
- &lt;/code&gt;
- 
- //<A HREF="Output://">Output://</A>
- Usage: ./genconf &lt;LDAP URI&gt; &lt;organization&gt; &lt;country&gt; &lt;domain&gt; &lt;netbiosname&gt; [LDAPMASTER URI]
- 
- The script will accept the HOSTNAME of the LDAP server, the name of
your organisation, your country shortcut, a name for the smb domain and a netbios name for the samba server configuration file.
- &#8220;LDAPMASTER URI&#8221; is an optional key to replicate a local LDAP server from a given master server. An example command could look like this:
- 
- &lt;code&gt;
- # ./genconf elzar planetexpress de smbgroup elzar
- &lt;/code&gt;
- 
- &#8220;elzar&#8221; is the HOSTNAME of the local x2goserver and should be identical to the environment variable &#8220;$HOSTNAME&#8221;.
- 
- 8-O Before going on, you should make an backup of your /etc directory:
- 
- &lt;code&gt;
- # tar cfvz backup_of_etc.tar.gz /etc/
- &lt;/code&gt;
- 
- Rename the file /etc/pam_ldap.conf (symbolic link):
- 
- &lt;code&gt;
- # mv /etc/pam_ldap.conf /etc/pam_ldap.bak
- &lt;/code&gt;
- 
- The next step will copy the newly generated configuration files into your real /etc directory.
- 
- //You should not do this without a valid backup!//
- 
- &lt;code&gt;
- # cp -r /usr/share/x2goldaptools/config/etc/ /
- &lt;/code&gt;
- 
- ==== Generating SSL Certificates
(for OpenLDAP) ====
- 
- Change into the script directory:
- 
- &lt;code&gt;
- # cd /usr/share/x2goldaptools/script/
- &lt;/code&gt;
- 
- Here you will find helper scripts for the creation of SSL certificates. Those are needed for secure LDAP communication between the clients and the LDAP server. Please take care when answering the questions after you'll run the makeCA command. You'll have to remember the &#8220;PEM phrase&#8221; to sign further certificates. The prompted question **&#8220;Common Name&#8221;** should be answered by the local **HOSTNAME**.
- 
- &lt;code&gt;
- # ./makeCA
- &lt;/code&gt;
- 
- //Output / <A HREF="Input://">Input://</A>
- -----
-  
- \\ 
- Enter PEM pass phrase:%%*****%%\\ 
- Verifying - Enter PEM pass phrase:%%*****%%\\ 
- %%-----%%
- \\ 
- Country Name (2 letter code) [AU]:**de**\\ 
- State or Province Name (full name) [Some-State]:**bavaria**\\ 
- Locality Name (eg, city) []:**treuchtlingen**\\ 
- Organization Name (eg, company) [Internet Widgits Pty Ltd]:**planetexpress**\\ 
- Organizational Unit Name (eg,
section) []:**spacedelivery**\\ 
- Common Name (eg, YOUR name) []:**elzar**\\ 
- Email Address []:**<A HREF="https://lists.berlios.de/mailman/listinfo/x2go-commits">prof.farnsworth at planetexpress.de</A>**\\ 
- Please enter the following 'extra' attributes\\ 
- to be sent with your certificate request\\ 
- A challenge password []:\\ 
- An optional company name []:\\ 
- Using configuration from /usr/lib/ssl/openssl.cnf\\ 
- Enter pass phrase for ./demoCA/private/./cakey.pem:%%*****%%\\ 
- Check that the request matches the signature\\ 
- Signature ok\\ 
- Certificate Details:\\ 
- Serial Number: 0 (0x0)\\ 
- Validity\\ 
- ...\\ 
- ...\\ 
- Write out database with 1 new entries\\ 
- Data Base Updated\\ 
- ----- 
- \\ 
- After creating the certificate you can sign the needed certificate against it:
- 
- &lt;code&gt;
- # ./makenewcert
- &lt;/code&gt;
- 
- Please make sure that the LDAP server is started after creating and signing the certificates. If OpenLDAP isn't running, you should check the installation again before going on. The next step will import users and
groups into the LDAP tree.
- 
- &lt;code&gt;
- # ./initsystem
- &lt;/code&gt;
- 
- After importing users and groups into the LDAP tree, they still exist in the /etc/passed /etc/shadow /etc/groups file. This means that every user can be found two times on the system. This will lead to problems when you would like to change passwords. You should uncomment or delete the users and groups in the /etc directory after you've checked that you can login to the system using LDAP authentication. Please remember: if you also delete the user &#8220;root&#8221;, you can't log in whenever the LDAP server is down (so our recommendation would be not to delete the user &#8220;root&#8221;).
- 
- :!: **Warning!**
- &gt; The following command will add your x2goserver to the LDAP tree. This will activate the &#8220;managed mode features&#8221; of x2goserver. This means, that x2goserver is now in multiserver mode and can remotely assign configurations to x2goclient. Please make sure that the LDAP server is running and everything works perfectly
&#8211; the unmanaged mode of x2goserver will be permanently deactivated.
- 
- It's time to add the x2goserver to the LDAP tree to activate the &#8220;managed mode&#8221; of x2goserver. Please use the HOSTNAME as first and the IP address as second command line parameter:
- 
- &lt;code&gt;
- # ldap.addserver x2goserver 192.168.0.1
- &lt;/code&gt;
- 
- Some functionalities of the graphical administration modules require root privileges. If you would like to use those commands without entering a password, you can avoid this by generating a pair of SSH keys:
- 
- &lt;code&gt;
- # ssh-keygen -t dsa
- # cd /root/.ssh/
- # ls
- # id_dsa id_dsa.pub known_hosts
- # cat id_dsa.pub &gt;&gt;authorized_keys
- # mv id_dsa x2go_dsa
- &lt;/code&gt;
- 
- All graphical administration modules can be found inside the KDE Control Center. If you would like to access a module outside the control center, you can do this by using the command &#8220;kcmshell&#8221;:
- 
- &lt;code&gt;
- # kcmshell x2gouseradministration
- &lt;/code&gt;
- 
- ===== Installing
x2gothinclient (PXEBoot environment) =====
- 
- X2goclient can be used as a display manager. If you combine this feature with a boot environment, you'll get an easy manageable solution for your whole network. Please read the manual carefully, because some of the commands could harm your system if executed within the wrong context. The boot environment used by x2go will be able to recognize USB mass storage and CD-ROM devices automatically. Global preferences can be edited inside the KDE Control Center. You'll need 300 MB of free disk space for this installation. First of all you'll need the network services:
- 
- &lt;code&gt;
- # apt-get install dhcp3-server atftpd nfs-kernel-server debootstrap
- &lt;/code&gt;
- 
- You'll need a directory to install the boot environment. You can choose a directory of your choice, but this manual will describe the installation inside &#8220;/opt/x2gothinclient&#8221;. This directory is also defined within some configuration files:
- 
- &lt;code&gt;
- # mkdir
/opt/x2gothinclient
- &lt;/code&gt;
- 
- You can populate the directory by running the command &#8220;debootstrap&#8221;:
- 
- &lt;code&gt;
- # debootstrap --arch i386 lenny /opt/x2gothinclient/ <A HREF="http://ftp2.de.debian.org/debian">http://ftp2.de.debian.org/debian</A>
- &lt;/code&gt;
- 
- Adding a name server entry will help you accessing the Internet inside the chroot environment:
- 
- &lt;code&gt;
- # cp /etc/resolv.conf /opt/x2gothinclient/etc/resolv.conf
- &lt;/code&gt;
- 
- You'll also need some network device:
- 
- &lt;code&gt;
- # vi /opt/x2gothinclient/etc/network/interfaces:
- &lt;/code&gt;
- 
- &lt;file&gt;
- auto lo
- iface lo inet loopback
- &lt;/file&gt;
- 
- And a host name as well as an entry of your system inside /etc/hosts:
- 
- &lt;code&gt;
- # echo x2gothinclient &gt; /opt/x2gothinclient/etc/hostname
- # echo &quot;127.0.0.1 localhost&quot; &gt;&gt;/opt/x2gothinclient/etc/hosts
- &lt;/code&gt;
- 
- You also need the x2goserver inside /etc/hosts:
- 
- &lt;code&gt;
- # echo &quot;192.168.1.1 x2goserver.planetexpress.de x2goserver&quot; &gt;&gt;/opt/x2gothinclient/etc/hosts
- &lt;/code&gt;
- 
- and access to the x2go
repository:
- 
- &lt;code&gt;
- # echo &quot;deb <A HREF="http://x2go.obviously-nice.de/deb/">http://x2go.obviously-nice.de/deb/</A> lenny main&quot; &gt;&gt;/opt/x2gothinclient/etc/apt/sources.list
- &lt;/code&gt;
- 
- :!: **Warning!**
- &gt; Please make sure that you continue working inside the boot environment. If you execute commands inside your real system, you may make it inaccessible!
- 
- The following command will take you inside the boot environment
- 
- &lt;code&gt;
- # chroot /opt/x2gothinclient /bin/bash
- &lt;/code&gt;
- 
- To get things working you'll need /proc and /dev directories. You may also use hardlinks created outside the chroot environment:
- 
- &lt;code&gt;
- # mount -t proc none /proc
- # mount -t devpts none /dev/pts/
- &lt;/code&gt;
- 
- Debootstrap didn't install a kernel, which is needed to start the boot environment:
- 
- &lt;code&gt;
- # aptitude update
- # aptitude install syslinux locales linux-image-486
- &lt;/code&gt;
- 
- If you would like to use a keymap other than us_US, you'll need to reconfigure the locales:
- 
- &lt;code&gt;
- # dpkg-reconfigure locales
-
&lt;/code&gt;
- 
- The system will be started via network, so it is necessary to tell the initramfs about your plans:
- 
- &lt;code&gt;
- # vi /etc/initramfs-tools/initramfs.conf
- &lt;/code&gt;
- 
- &lt;file&gt;
- Modify to : BOOT=nfs
- &lt;/file&gt;
- 
- The new configuration needs to be applied and the initramfs needs to be newly generated:
- 
- &lt;code&gt;
- # update-initramfs -u -v
- &lt;/code&gt;
- 
- The package x2gothinclientsystem will install a system daemon which will start x2goclient as a display manager. It will further start a deamon which will be responsible for mounting local mass storage devices automatically.
- 
- &lt;code&gt;
- # apt-get install x2gothinclientsystem
- # cd /usr/share/x2gothinclientsystem/script
- # ./x2gothinclient_install.sh
- &lt;/code&gt;
- 
- This will finish the installation of the boot environment. Before exiting the chroot environment, you'll need to umount the /proc and /dev directories:
- 
- &lt;code&gt;
- # umount /proc/
- # umount /dev/pts/
- &lt;/code&gt;
- 
- The command &#8220;exit&#8221; will leave the
chroot boot environment. If you discover any problems, you can always go back inside the boot environment by using &#8220;chroot&#8221; as described (for example for system upgrades):
- 
- &lt;code&gt;
- # exit
- &lt;/code&gt;
- 
- ==== Configuration of DHCPD ====
- 
- If you already have an DHCP server in your network, please make sure that you are able to setup an own range of IP addresses for the boot environment. Because of the conflict between devices that should access the boot environment and normal network nodes (MAC address binding), it is much easier to setup an own network for your thin client system. The following example assumes that you are running the DHCPD and the ATFTPD on the same system. 
- 
- &lt;code&gt;
- # vi /etc/dhcpd/dhcpd.conf
- &lt;/code&gt;
- 
- &lt;file&gt;
- option domain-name &quot;planetexpress.de&quot;;
- option domain-name-servers 192.168.1.1;
- # x2go thin client range/group
- subnet 192.168.0.0 netmask 255.255.255.0 {
- range 192.168.0.100 192.168.0.199;
- filename &quot;/pxelinux.0&quot;;
- next-server
192.168.0.250;
- }
- &lt;/file&gt;
- 
- Restart the DHCPD to apply the new configuration:
- 
- &lt;code&gt;
- # /etc/init.d/dhcp3-server restart
- &lt;/code&gt;
- 
- ==== Setting up atftp ====
- 
- After receiving a network address from the DHCP daemon, a kernel will be deployed using the tftp protocoll. For this purpose, you'll need to configure the **atftpd**, so that the kernel can be found. Please make sure, that **atftp** ist started by an init script and not via inet.d.
- 
- &lt;code&gt;
- # vi /etc/default/atftpd
- &lt;/code&gt;
- 
- &lt;file&gt;
- USE_INETD=false
- OPTIONS=&quot;--daemon --port 69 --tftpd-timeout 300 --retry-timeout 5 --mcast-port 1758 --mcast-addr 239.239.239.0-255 --mcast-ttl 1 --maxthread 100 --verbose=5 /tftpboot&quot;
- &lt;/file&gt;
- 
- You'll need a directory to store the necessary kernel which should be world readable (=public).
- 
- &lt;code&gt;
- # mkdir /tftpboot
- # chmod 755 /tftpboot
- &lt;/code&gt;
- 
- If inet.d was installed and used on your system, please make sure that it is not starting or runnig
**atftp** when you start it directly:
- 
- &lt;code&gt;
- # /etc/init.d/atftpd restart
- &lt;/code&gt;
- 
- If you don't want to make copies of the kernel and initrd files, just use symbolic links &#8211; that is a good idea, if you plan to maintain the boot environment:
- 
- &lt;code&gt;
- # ln -s /opt/x2gothinclient/vmlinuz /tftpboot/
- # ln -s /opt/x2gothinclient/initrd.img /tftpboot/
- &lt;/code&gt;
- 
- The configuration file of **atftp** needs to be created and edited. Please change the IP address if necessary!
- 
- &lt;code&gt;
- # mkdir /tftpboot/pxelinux.cfg
- # touch /tftpboot/pxelinux.cfg/default
- # vi /tftpboot/pxelinux.cfg/default
- # cp /opt/x2gothinclient/usr/lib/syslinux/pxelinux.0 /tftpboot/
- &lt;/code&gt;
- 
- &lt;file&gt;
- label linux
- kernel vmlinuz
- append root=/dev/nfs nfsroot=192.168.1.1:/opt/x2gothinclient ro initrd=initrd.img ip=dhcp
- &lt;/file&gt;
- 
- ==== Configuration of the NFS share ====
- 
- The root file system of the boot environment is mounted using NFS (so it can be accessed over the network).
You'll need to export the needed directory by editing the NFS configuration file:
- 
- &lt;code&gt;
- # vi /etc/exports
- &lt;/code&gt;
- 
- &lt;file&gt;
- /opt/x2gothinclient 192.168.1.0/24(ro,async,no_root_squash)
- &lt;/file&gt;
- 
- Finally restart the NFSD:
- 
- &lt;code&gt;
- # /etc/init.d/nfs-kernel-server restart
- &lt;/code&gt;
- 
- ==== Configuration of x2goclient (display manager mode) ====
- 
- Please also edit the command line options used by the x2goclient running in display manager mode (for example: change the IP address).
- 
- &lt;code&gt;
- # vi /opt/x2gothinclient/etc/default/x2gothinclient
- &lt;/code&gt;
- 
- &lt;file&gt;
- x2goclient --pgp-card &#8211;ldap=&quot;192.168.1.1:389:o=planetexpress,c=de&quot; --external-login=/ramdrive/logins --no-menu --maximize --link=lan --kbd-layout=de --kbd-type=pc105/de --set-kbd=1 --geometry=fullscreen --add-to-known-hosts --read-exports-from=/ramdrive/export &#8211;add-to-known-hosts
- &lt;/file&gt;
- 
- You are done! ;-)
- 
- PXE Boot enabled devices should now boot into the configured environment and
show the x2goclient in display manager mode. If there are problems to start x.org, you may need to add missing drivers to the boot environment.



-- 
This mail was generated by DokuWiki at
<A HREF="http://wiki.x2go.org/">http://wiki.x2go.org/</A>

</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="004642.html">[X2Go-Commits] page changed: wiki:obsolete:nx-libs
</A></li>
	<LI>Next message: <A HREF="004644.html">[X2Go-Commits] page changed: wiki:obsolete:ubuntu-old
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4643">[ date ]</a>
              <a href="thread.html#4643">[ thread ]</a>
              <a href="subject.html#4643">[ subject ]</a>
              <a href="author.html#4643">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/x2go-commits">More information about the X2Go-commits
mailing list</a><br>
</body></html>
