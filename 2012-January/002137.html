<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [X2go-Commits] x2goserver.git - build-main (branch) updated:	3.0.99.9
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/x2go-commits/2012-January/index.html" >
   <LINK REL="made" HREF="mailto:x2go-commits%40lists.berlios.de?Subject=Re%3A%20%5BX2go-Commits%5D%20x2goserver.git%20-%20build-main%20%28branch%29%20updated%3A%0A%093.0.99.9&In-Reply-To=%3C20120118134153.5707B5DB33%40ymir%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002136.html">
   <LINK REL="Next"  HREF="002138.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[X2go-Commits] x2goserver.git - build-main (branch) updated:	3.0.99.9</H1>
    <B>X2go dev team</B> 
    <A HREF="mailto:x2go-commits%40lists.berlios.de?Subject=Re%3A%20%5BX2go-Commits%5D%20x2goserver.git%20-%20build-main%20%28branch%29%20updated%3A%0A%093.0.99.9&In-Reply-To=%3C20120118134153.5707B5DB33%40ymir%3E"
       TITLE="[X2go-Commits] x2goserver.git - build-main (branch) updated:	3.0.99.9">git-admin at x2go.org
       </A><BR>
    <I>Wed Jan 18 14:41:53 CET 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="002136.html">[X2go-Commits] x2goserver.git - master (branch) updated:	3.0.99.8-47-gd578560
</A></li>
        <LI>Next message: <A HREF="002138.html">[X2go-Commits] x2goserver.git - master (branch) updated:	3.0.99.9-1-g67d66c5
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2137">[ date ]</a>
              <a href="thread.html#2137">[ thread ]</a>
              <a href="subject.html#2137">[ subject ]</a>
              <a href="author.html#2137">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>The branch, build-main has been updated
       via  d578560869faad7bc5e1c7be02d07ac7f725d6be (commit)
       via  9a2cf4f7db806415601c90866bbde1acd3fd5001 (commit)
       via  21939b511d26b0bb737fa41c2219e11ce993c842 (commit)
       via  45b1367dfa77432852ce741eb9052f83b242a75c (commit)
       via  2e398b9c0964748f404b7ad4140d7ae229e98612 (commit)
       via  5ea9eaad648e916e182ee0c3a56c3c49c97ce80f (commit)
       via  59a492c2d3632c68c543da036a742f624431cdcb (commit)
       via  3c0cb17f554b7614016018222b56a445104e8355 (commit)
       via  9029807eca96120440e57e7a5cf0fc7cab0d3841 (commit)
       via  93fa35b38ff5d2b9a67c6db1475b5422a15b5769 (commit)
       via  c0b97603f18c6d5555384c47cb88c18ba9bf660b (commit)
       via  e9cf74ecc5138a053ecc0bd1e078aa1208c11a3a (commit)
       via  92525697feca404e86cf6bc2155515c37ed43299 (commit)
       via  b8303b69146ea5c027f7dbd549c8ea708f790783 (commit)
       via  2f7093934874c7ea5c02258efba24654ba855edb (commit)
       via  50cf94a3d3f9eb433764448b4c1235c7d520db82 (commit)
       via  1a21a3f9871e698ec0938c1501cae23ad783ed3b (commit)
       via  6068dec71041582d95e8ae322b1a5601369856d8 (commit)
       via  3df68647e449f439ed33dd3b201f43e6051ab28a (commit)
       via  1dc52c5c458d2e3d35151a68363b4b825c1f7dfe (commit)
       via  197765426bc6832460670baf9aff45e101458957 (commit)
       via  cdc1a1f3713ccd23d7ca35d3263a53ed8372844c (commit)
       via  123bd195c9288a5606bd1b4f807bbdc5651e907f (commit)
       via  0ddcb23f0faddfecec4c16bcc67ee7fddf2d1772 (commit)
       via  202213dfd8d860923fd3560cbb59ae99a21a61e3 (commit)
       via  52e277550101af3b80dc306ede67a5a9b94937ff (commit)
       via  8084d7edbc6a7efaf38debe468a1a7a25fd6d1eb (commit)
       via  f21aa45a5759d2d167050e069a829e615ceb865d (commit)
       via  42323861f27f8ffd215009765e61b1312707a58c (commit)
       via  c0fea2a62ddf6b0186305858853f927a4dff252a (commit)
       via  39d5ce818f845fe1f613a5efef1311bd33eee520 (commit)
       via  e313dbe0d454ac23db65c8955bc85dc97fd9d960 (commit)
       via  8baeee936bcb2517a744c25e1d6c629750493efc (commit)
       via  22b6adf2729f67c8cc4c1f995e1d177fcb12d469 (commit)
       via  bf3d7a5a35acdf42206e6b723ec90222e1cb70f6 (commit)
       via  97506f8090c0fcb0bd641a368029342f5e1e4b9e (commit)
       via  d162a4c5ccf895e9136c930e1ce17cb860a8def7 (commit)
       via  79f81a4013f1ef1eda8ad12632f12bbd53eefa4d (commit)
       via  4e014885ad2dbbabb680f71d5353ee0f1b66d09a (commit)
       via  1e5b8ed6fc775d533f4781656a2c2c80be6624a1 (commit)
       via  3692ac5dd4771df1753012c3199cc97fabd1d694 (commit)
       via  31b58ab1c99513bf1ded60a213210cac0182615f (commit)
       via  905e1c5326ff61f9ce8bb4cb486e34adebe545df (commit)
       via  1f3c8dafa7f052840e45385ca07897b3d98cde72 (commit)
       via  52abfd0b36832e1b80a51ee27fbecfa1cacb2387 (commit)
       via  cb7f54e232fc66a16cc4434cc75caa3166a2d5d3 (commit)
       via  69eca656c070b2519f7aa3aef9c25c5ece882b12 (commit)
      from  df472e95f6b39498d50db8fff849bd93beff05c1 (commit)

Those revisions listed above that are new to this repository have
not appeared on any other notification email; so we list those
revisions in full, below.

- Log -----------------------------------------------------------------
-----------------------------------------------------------------------

Summary of changes:
 INSTALL                                            |    4 +-
 Makefile                                           |    6 +++
 debian/changelog                                   |   30 +++++++++++++
 debian/control                                     |   28 +++++++++++-
 debian/x2goserver-printing.postinst                |    2 +-
 ...rver-extensions.dirs =&gt; x2goserver-pyhoca.dirs} |    0
 debian/x2goserver-pyhoca.docs                      |    1 +
 debian/x2goserver-pyhoca.install                   |    3 +
 debian/x2goserver-pyhoca.manpages                  |    1 +
 x2goserver-compat/VERSION.x2goserver-compat        |    2 +-
 x2goserver-extensions/Makefile                     |   24 +++++-----
 .../VERSION.x2goserver-extensions                  |    2 +-
 .../x2gofeature.d/x2goserver-extensions.features   |    1 -
 x2goserver-printing/VERSION.x2goserver-printing    |    2 +-
 x2goserver-printing/bin/x2goprint                  |    2 +-
 .../Makefile                                       |    9 ++--
 x2goserver-pyhoca/VERSION.x2goserver-pyhoca        |    1 +
 .../bin/x2gosetkeyboard                            |    0
 .../man/man8/x2gosetkeyboard.8                     |    0
 .../share/x2gofeature.d/x2goserver-pyhoca.features |    2 +-
 x2goserver-xsession/Makefile                       |   11 ++++-
 x2goserver-xsession/VERSION.x2goserver-xsession    |    2 +-
 x2goserver/Makefile                                |    2 +-
 x2goserver/VERSION.x2goserver                      |    2 +-
 x2goserver/bin/x2gobasepath                        |    7 ++-
 x2goserver/{lib =&gt; bin}/x2gogetservers             |    0
 x2goserver/bin/x2gomountdirs                       |    2 +-
 x2goserver/bin/x2goresume-session                  |    6 +++
 x2goserver/bin/x2goruncommand                      |    7 +++
 x2goserver/bin/x2gostartagent                      |   46 ++++++++++++-------
 x2goserver/sbin/x2godbadmin                        |   12 ++++-
 31 files changed, 162 insertions(+), 55 deletions(-)
 copy debian/{x2goserver-extensions.dirs =&gt; x2goserver-pyhoca.dirs} (100%)
 create mode 100644 debian/x2goserver-pyhoca.docs
 create mode 100644 debian/x2goserver-pyhoca.install
 create mode 100644 debian/x2goserver-pyhoca.manpages
 copy {x2goserver-printing =&gt; x2goserver-pyhoca}/Makefile (90%)
 create mode 100644 x2goserver-pyhoca/VERSION.x2goserver-pyhoca
 rename {x2goserver-extensions =&gt; x2goserver-pyhoca}/bin/x2gosetkeyboard (100%)
 rename {x2goserver-extensions =&gt; x2goserver-pyhoca}/man/man8/x2gosetkeyboard.8 (100%)
 copy x2goserver-xsession/share/x2gofeature.d/x2goserver-xsession.features =&gt; x2goserver-pyhoca/share/x2gofeature.d/x2goserver-pyhoca.features (96%)
 rename x2goserver/{lib =&gt; bin}/x2gogetservers (100%)

The diff of changes is:
diff --git a/INSTALL b/INSTALL
index 15a0dfb..eeac765 100644
--- a/INSTALL
+++ b/INSTALL
@@ -19,11 +19,11 @@ already:
  $ chown x2goprint:x2goprint ~x2goprint
  $ chmod 0770 ~x2goprint
 
-2.) INSTALL x2goserver FILES
+2.) BUILD + INSTALL x2goserver FILES
 -----------------------------
 Extract tarball and run 
 
- $ make install
+ $ make &amp;&amp; make install
 
 in base folder of the extracted tarball. 
 
diff --git a/Makefile b/Makefile
index 657dcfc..e7efc9f 100755
--- a/Makefile
+++ b/Makefile
@@ -11,6 +11,7 @@ build_man2html:
 	cd x2goserver-compat &amp;&amp; make $@
 	cd x2goserver-extensions &amp;&amp; make $@
 	cd x2goserver-xsession &amp;&amp; make $@
+	cd x2goserver-pyhoca &amp;&amp; make $@
 
 clean:
 	cd x2goserver &amp;&amp; make $@
@@ -18,6 +19,7 @@ clean:
 	cd x2goserver-compat &amp;&amp; make $@
 	cd x2goserver-extensions &amp;&amp; make $@
 	cd x2goserver-xsession &amp;&amp; make $@
+	cd x2goserver-pyhoca &amp;&amp; make $@
 
 build-arch:
 	cd x2goserver &amp;&amp; make $@
@@ -25,6 +27,7 @@ build-arch:
 	cd x2goserver-compat &amp;&amp; make $@
 	cd x2goserver-extensions &amp;&amp; make $@
 	cd x2goserver-xsession &amp;&amp; make $@
+	cd x2goserver-pyhoca &amp;&amp; make $@
 
 build-indep:
 	cd x2goserver &amp;&amp; make $@
@@ -32,6 +35,7 @@ build-indep:
 	cd x2goserver-compat &amp;&amp; make $@
 	cd x2goserver-extensions &amp;&amp; make $@
 	cd x2goserver-xsession &amp;&amp; make $@
+	cd x2goserver-pyhoca &amp;&amp; make $@
 
 install:
 	cd x2goserver &amp;&amp; make $@
@@ -39,6 +43,7 @@ install:
 	cd x2goserver-compat &amp;&amp; make $@
 	cd x2goserver-extensions &amp;&amp; make $@
 	cd x2goserver-xsession &amp;&amp; make $@
+	cd x2goserver-pyhoca &amp;&amp; make $@
 
 uninstall:
 	cd x2goserver-extensions &amp;&amp; make $@
@@ -46,5 +51,6 @@ uninstall:
 	cd x2goserver-printing &amp;&amp; make $@
 	cd x2goserver &amp;&amp; make $@
 	cd x2goserver-xsession &amp;&amp; make $@
+	cd x2goserver-pyhoca &amp;&amp; make $@
 
 
diff --git a/debian/changelog b/debian/changelog
index d4926ac..d8935dd 100644
--- a/debian/changelog
+++ b/debian/changelog
@@ -1,3 +1,33 @@
+x2goserver (3.0.99.9-0~x2go1) unstable; urgency=low
+
+  [ Mike Gabriel ]
+  * New upstream version (3.0.99.9):
+    - Fix for install stanzas in several Makefiles.
+    - Give X2Go session windows a human readable title.
+    - Desktop sharing: fix username of user who requests desktop sharing.
+    - Fix x2gobasepath for Perl versions &lt; 5.10.x.
+    - Fix x2godbadmin for Perl versions &lt; 5.10.x.
+    - Remove x2gosetkeyboard from x2goserver-extensions package.
+    - Re-add x2gosetkeyboard via new subproject x2goserver-pyhoca.
+    - Call x2golistmounts with user privileges instead of using db_getmounts
+      in x2goprint script.
+    - Avoid potentially empty LD_LIBRARY_PATH path in x2goruncommand.
+    - Install x2gogetservers to $PREFIX/bin instead of $PREFIX/lib/x2go.
+  * Add psmisc package as dependency.
+  * Add new binary package to x2goserver source: x2goserver-pyhoca.
+  * x2goserver package suggests x2goserver-pyhoca.
+  * Fix directory permissions of $HOME directory of x2goprint system user.
+
+  [ Hayawardh Vijayakumar ]
+  * New upstream version (3.0.99.9):
+    - Fix potentially empty LD_LIBRARY_PATH in x2gostartagent.
+
+  [ Oleksandr Shneyder ]
+  * New upstream version (3.0.99.9):
+    - Add Xinerama support.
+
+ -- Mike Gabriel &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/x2go-commits">mike.gabriel at das-netzwerkteam.de</A>&gt;  Wed, 18 Jan 2012 14:39:57 +0100
+
 x2goserver (3.0.99.8-0~x2go1) unstable; urgency=low
 
   * New upstream version (3.0.99.8):
diff --git a/debian/control b/debian/control
index 8be5cdc..89dc5b2 100644
--- a/debian/control
+++ b/debian/control
@@ -26,7 +26,8 @@ Depends:
  libdbd-pg-perl,
  libdbd-sqlite3-perl,
  adduser,
- xauth
+ xauth,
+ psmisc
 Recommends:
  sshfs,
  x11-apps,
@@ -40,7 +41,8 @@ Recommends:
 Suggests:
  x2goserver-printing (= ${source:Version}),
  x2goserver-compat (= ${source:Version}),
- x2goserver-xsession (= ${source:Version})
+ x2goserver-xsession (= ${source:Version}),
+ x2goserver-pyhoca (= ${source:Version})
 Breaks:
  x2goserver-one,
  x2goserver-home,
@@ -164,3 +166,25 @@ Description: X2go server daemon scripts (Xsession runner)
  startups and many more Xsession related features on 
  X2go session login automagically.
 
+Package: x2goserver-pyhoca
+Architecture: all
+Depends:
+ ${misc:Depends},
+ x2goserver (&gt;= ${source:Version}), x2goserver (&lt;&lt; ${source:Version}.1~),
+Description: X2go server daemon scripts (add-ons for pyhoca client)
+ X2go is a server based computing environment with
+    - session resuming
+    - low bandwith support
+    - LDAP support
+    - client side mass storage mounting support
+    - audio support
+    - authentication by smartcard and USB stick
+ .
+ This X2go server add-on adds extra functionality when using
+ the pyhoca client (GUI or cmdline tool). The installation
+ of this package is completely optional, the pyhoca client
+ will work without.
+ .
+ Functionalities this package adds:
+    - renaming of session window titles
+    - setting detailled X keyboard parameters
diff --git a/debian/x2goserver-printing.postinst b/debian/x2goserver-printing.postinst
index 8ad8f80..7c1451c 100755
--- a/debian/x2goserver-printing.postinst
+++ b/debian/x2goserver-printing.postinst
@@ -57,7 +57,7 @@ case &quot;$1&quot; in
 		# make sure x2goprint spool dir permissions are set correctly
 		chown -R x2goprint:x2goprint /var/spool/x2goprint
 		# egid x2goprint needs write access to the spool dir
-		chmod 0770 /var/spool/x2goprint
+		chmod 0700 /var/spool/x2goprint
 
 		# we may be upgrading versions of x2goserver that had
 		# /usr/bin/x2goprint set to setuid x2goprint.
diff --git a/debian/x2goserver-extensions.dirs b/debian/x2goserver-pyhoca.dirs
similarity index 100%
copy from debian/x2goserver-extensions.dirs
copy to debian/x2goserver-pyhoca.dirs
diff --git a/debian/x2goserver-pyhoca.docs b/debian/x2goserver-pyhoca.docs
new file mode 100644
index 0000000..6652b35
--- /dev/null
+++ b/debian/x2goserver-pyhoca.docs
@@ -0,0 +1 @@
+x2goserver-pyhoca/.build_man2html/html
diff --git a/debian/x2goserver-pyhoca.install b/debian/x2goserver-pyhoca.install
new file mode 100644
index 0000000..7ba0b60
--- /dev/null
+++ b/debian/x2goserver-pyhoca.install
@@ -0,0 +1,3 @@
+x2goserver-pyhoca/bin/x2go*      /usr/bin/
+x2goserver-pyhoca/VERSION.x2goserver-pyhoca      /usr/share/x2go/versions/
+x2goserver-pyhoca/share/x2gofeature.d/*              /usr/share/x2go/x2gofeature.d/
diff --git a/debian/x2goserver-pyhoca.manpages b/debian/x2goserver-pyhoca.manpages
new file mode 100644
index 0000000..845a36c
--- /dev/null
+++ b/debian/x2goserver-pyhoca.manpages
@@ -0,0 +1 @@
+x2goserver-pyhoca/man/man8/*
\ No newline at end of file
diff --git a/x2goserver-compat/VERSION.x2goserver-compat b/x2goserver-compat/VERSION.x2goserver-compat
index d720f99..c7d6552 100644
--- a/x2goserver-compat/VERSION.x2goserver-compat
+++ b/x2goserver-compat/VERSION.x2goserver-compat
@@ -1 +1 @@
-3.0.99.8
\ No newline at end of file
+3.0.99.9
\ No newline at end of file
diff --git a/x2goserver-extensions/Makefile b/x2goserver-extensions/Makefile
index 2ecf49a..02a9525 100755
--- a/x2goserver-extensions/Makefile
+++ b/x2goserver-extensions/Makefile
@@ -71,18 +71,18 @@ install_scripts:
 	$(INSTALL_DIR) $(DESTDIR)$(SHAREDIR)/x2gofeature.d
 	$(INSTALL_PROGRAM) bin/*                $(DESTDIR)$(BINDIR)/
 #	$(INSTALL_PROGRAM) sbin/*               $(DESTDIR)$(SBINDIR)/
-	$(INSTALL_FILE) lib/extensions/pre-start.d/* $(DESTDIR)$(LIBDIR)/extensions/pre-start.d/
-	$(INSTALL_FILE) lib/extensions/post-start.d/* $(DESTDIR)$(LIBDIR)/extensions/post-start.d/
-	$(INSTALL_FILE) lib/extensions/fail-start.d/* $(DESTDIR)$(LIBDIR)/extensions/fail-start.d/
-	$(INSTALL_FILE) lib/extensions/pre-resume.d/* $(DESTDIR)$(LIBDIR)/extensions/pre-resume.d/
-	$(INSTALL_FILE) lib/extensions/post-resume.d/* $(DESTDIR)$(LIBDIR)/extensions/post-resume.d/
-	$(INSTALL_FILE) lib/extensions/post-fail.d/* $(DESTDIR)$(LIBDIR)/extensions/fail-resume.d/
-	$(INSTALL_FILE) lib/extensions/pre-suspend.d/* $(DESTDIR)$(LIBDIR)/extensions/pre-suspend.d/
-	$(INSTALL_FILE) lib/extensions/post-suspend.d/* $(DESTDIR)$(LIBDIR)/extensions/post-suspend.d/
-	$(INSTALL_FILE) lib/extensions/fail-suspend.d/* $(DESTDIR)$(LIBDIR)/extensions/fail-suspend.d/
-	$(INSTALL_FILE) lib/extensions/pre-terminate.d/* $(DESTDIR)$(LIBDIR)/extensions/pre-terminate.d/
-	$(INSTALL_FILE) lib/extensions/post-terminate.d/* $(DESTDIR)$(LIBDIR)/extensions/post-terminate.d/
-	$(INSTALL_FILE) lib/extensions/fail-terminate.d/* $(DESTDIR)$(LIBDIR)/extensions/fail-terminate.d/
+	$(INSTALL_FILE) lib/extensions/pre-start.d/.placeholder $(DESTDIR)$(LIBDIR)/extensions/pre-start.d/
+	$(INSTALL_FILE) lib/extensions/post-start.d/.placeholder $(DESTDIR)$(LIBDIR)/extensions/post-start.d/
+	$(INSTALL_FILE) lib/extensions/fail-start.d/.placeholder $(DESTDIR)$(LIBDIR)/extensions/fail-start.d/
+	$(INSTALL_FILE) lib/extensions/pre-resume.d/.placeholder $(DESTDIR)$(LIBDIR)/extensions/pre-resume.d/
+	$(INSTALL_FILE) lib/extensions/post-resume.d/.placeholder $(DESTDIR)$(LIBDIR)/extensions/post-resume.d/
+	$(INSTALL_FILE) lib/extensions/fail-resume.d/.placeholder $(DESTDIR)$(LIBDIR)/extensions/fail-resume.d/
+	$(INSTALL_FILE) lib/extensions/pre-suspend.d/.placeholder $(DESTDIR)$(LIBDIR)/extensions/pre-suspend.d/
+	$(INSTALL_FILE) lib/extensions/post-suspend.d/.placeholder $(DESTDIR)$(LIBDIR)/extensions/post-suspend.d/
+	$(INSTALL_FILE) lib/extensions/fail-suspend.d/.placeholder $(DESTDIR)$(LIBDIR)/extensions/fail-suspend.d/
+	$(INSTALL_FILE) lib/extensions/pre-terminate.d/.placeholder $(DESTDIR)$(LIBDIR)/extensions/pre-terminate.d/
+	$(INSTALL_FILE) lib/extensions/post-terminate.d/.placeholder $(DESTDIR)$(LIBDIR)/extensions/post-terminate.d/
+	$(INSTALL_FILE) lib/extensions/fail-terminate.d/.placeholder $(DESTDIR)$(LIBDIR)/extensions/fail-terminate.d/
 	$(INSTALL_PROGRAM) share/x2gofeature.d/*.features $(DESTDIR)$(SHAREDIR)/x2gofeature.d/
 
 install_config:
diff --git a/x2goserver-extensions/VERSION.x2goserver-extensions b/x2goserver-extensions/VERSION.x2goserver-extensions
index d720f99..c7d6552 100644
--- a/x2goserver-extensions/VERSION.x2goserver-extensions
+++ b/x2goserver-extensions/VERSION.x2goserver-extensions
@@ -1 +1 @@
-3.0.99.8
\ No newline at end of file
+3.0.99.9
\ No newline at end of file
diff --git a/x2goserver-extensions/share/x2gofeature.d/x2goserver-extensions.features b/x2goserver-extensions/share/x2gofeature.d/x2goserver-extensions.features
index 7e50dd7..509e5a4 100755
--- a/x2goserver-extensions/share/x2gofeature.d/x2goserver-extensions.features
+++ b/x2goserver-extensions/share/x2gofeature.d/x2goserver-extensions.features
@@ -29,7 +29,6 @@ X2GO_FEATURE=$1
 # check for X2go server core features
 case &quot;$X2GO_FEATURE&quot; in
 
-    &quot;X2GO_SET_KEYBOARD&quot;) echo &quot;ok&quot;; exit 0;;
     &quot;X2GO_RUN_EXTENSIONS&quot;) echo &quot;ok&quot;; exit 0;;
     *) exit -1;;
 
diff --git a/x2goserver-printing/VERSION.x2goserver-printing b/x2goserver-printing/VERSION.x2goserver-printing
index d720f99..c7d6552 100644
--- a/x2goserver-printing/VERSION.x2goserver-printing
+++ b/x2goserver-printing/VERSION.x2goserver-printing
@@ -1 +1 @@
-3.0.99.8
\ No newline at end of file
+3.0.99.9
\ No newline at end of file
diff --git a/x2goserver-printing/bin/x2goprint b/x2goserver-printing/bin/x2goprint
index fa3e4ae..480c583 100755
--- a/x2goserver-printing/bin/x2goprint
+++ b/x2goserver-printing/bin/x2goprint
@@ -100,7 +100,7 @@ chown $uid, $gid, &quot;$spooltmp&quot;;
 chmod 0700, &quot;$spooltmp&quot;;
 
 # this last part mainly uses the session user's privileges
-my ($mounts)=db_getmounts($session);
+my $mounts=`su $user -c &quot;x2golistmounts $session&quot;`;
 if ( $mounts=~m/$spooldir/)
 {
 
diff --git a/x2goserver-printing/Makefile b/x2goserver-pyhoca/Makefile
similarity index 90%
copy from x2goserver-printing/Makefile
copy to x2goserver-pyhoca/Makefile
index 04f93bf..aa6a562 100755
--- a/x2goserver-printing/Makefile
+++ b/x2goserver-pyhoca/Makefile
@@ -15,7 +15,7 @@ PREFIX=/usr/local
 ETCDIR=/etc/x2go
 BINDIR=$(PREFIX)/bin
 #SBINDIR=$(PREFIX)/sbin
-#LIBDIR=$(PREFIX)/lib/x2go
+LIBDIR=$(PREFIX)/lib/x2go
 MANDIR=$(PREFIX)/share/man
 SHAREDIR=$(PREFIX)/share/x2go
 
@@ -53,11 +53,10 @@ install: install_scripts install_config install_man install_version
 install_scripts:
 	$(INSTALL_DIR) $(DESTDIR)$(BINDIR)
 #	$(INSTALL_DIR) $(DESTDIR)$(SBINDIR)
-#	$(INSTALL_DIR) $(DESTDIR)$(LIBDIR)
 	$(INSTALL_DIR) $(DESTDIR)$(SHAREDIR)
+	$(INSTALL_DIR) $(DESTDIR)$(SHAREDIR)/x2gofeature.d
 	$(INSTALL_PROGRAM) bin/*                $(DESTDIR)$(BINDIR)/
 #	$(INSTALL_PROGRAM) sbin/*               $(DESTDIR)$(SBINDIR)/
-#	$(INSTALL_FILE) lib/*                   $(DESTDIR)$(LIBDIR)/
 	$(INSTALL_PROGRAM) share/x2gofeature.d/*.features $(DESTDIR)$(SHAREDIR)/x2gofeature.d/
 
 install_config:
@@ -76,7 +75,7 @@ install_man:
 install_version:
 	$(INSTALL_DIR) $(DESTDIR)$(SHAREDIR)
 	$(INSTALL_DIR) $(DESTDIR)$(SHAREDIR)/versions
-	$(INSTALL_FILE) VERSION.x2goserver-printing     $(DESTDIR)$(SHAREDIR)/versions/VERSION.x2goserver-printing
+	$(INSTALL_FILE) VERSION.x2goserver-pyhoca     $(DESTDIR)$(SHAREDIR)/versions/VERSION.x2goserver-pyhoca
 
 uninstall: uninstall_scripts uninstall_config uninstall_man uninstall_version
 
@@ -99,5 +98,5 @@ uninstall_man:
 	$(RM_DIR)  $(DESTDIR)$(MANDIR) || true
 
 uninstall_version:
-	$(RM_FILE) $(DESTDIR)$(SHAREDIR)/versions/VERSION.x2goserver-printing
+	$(RM_FILE) $(DESTDIR)$(SHAREDIR)/versions/VERSION.x2goserver-pyhoca
 	$(RM_DIR)  $(DESTDIR)$(SHAREDIR)/versions || true
diff --git a/x2goserver-pyhoca/VERSION.x2goserver-pyhoca b/x2goserver-pyhoca/VERSION.x2goserver-pyhoca
new file mode 100644
index 0000000..c7d6552
--- /dev/null
+++ b/x2goserver-pyhoca/VERSION.x2goserver-pyhoca
@@ -0,0 +1 @@
+3.0.99.9
\ No newline at end of file
diff --git a/x2goserver-extensions/bin/x2gosetkeyboard b/x2goserver-pyhoca/bin/x2gosetkeyboard
similarity index 100%
rename from x2goserver-extensions/bin/x2gosetkeyboard
rename to x2goserver-pyhoca/bin/x2gosetkeyboard
diff --git a/x2goserver-extensions/man/man8/x2gosetkeyboard.8 b/x2goserver-pyhoca/man/man8/x2gosetkeyboard.8
similarity index 100%
rename from x2goserver-extensions/man/man8/x2gosetkeyboard.8
rename to x2goserver-pyhoca/man/man8/x2gosetkeyboard.8
diff --git a/x2goserver-xsession/share/x2gofeature.d/x2goserver-xsession.features b/x2goserver-pyhoca/share/x2gofeature.d/x2goserver-pyhoca.features
similarity index 96%
copy from x2goserver-xsession/share/x2gofeature.d/x2goserver-xsession.features
copy to x2goserver-pyhoca/share/x2gofeature.d/x2goserver-pyhoca.features
index 9fb329e..eb0dce4 100755
--- a/x2goserver-xsession/share/x2gofeature.d/x2goserver-xsession.features
+++ b/x2goserver-pyhoca/share/x2gofeature.d/x2goserver-pyhoca.features
@@ -29,7 +29,7 @@ X2GO_FEATURE=$1
 # check for X2go server core features
 case &quot;$X2GO_FEATURE&quot; in
 
-    &quot;X2GO_XSESSION&quot;) echo &quot;ok&quot;; exit 0;;
+    &quot;X2GO_SET_KEYBOARD&quot;) echo &quot;ok&quot;; exit 0;;
     *) exit -1;;
 
 esac
diff --git a/x2goserver-xsession/Makefile b/x2goserver-xsession/Makefile
index ec4a063..2bbbd66 100755
--- a/x2goserver-xsession/Makefile
+++ b/x2goserver-xsession/Makefile
@@ -5,6 +5,7 @@ SHELL=/bin/bash
 
 INSTALL_DIR=install -d -o root -g root -m 755
 INSTALL_FILE=install -o root -g root -m 644
+INSTALL_SYMLINK=ln -s -f
 INSTALL_PROGRAM=install -o root -g root -m 755
 
 RM_FILE=rm -f
@@ -62,7 +63,15 @@ install_scripts:
 
 install_config:
 	$(INSTALL_DIR) $(DESTDIR)$(ETCDIR)
-	$(INSTALL_FILE) etc/*                   $(DESTDIR)$(ETCDIR)/
+#       provide target dirs for X11 related symlinks
+	mkdir -p /etc/X11/Xresources
+	mkdir -p /etc/X11/Xsession.d
+	touch /etc/X11/Xsession.options
+	$(INSTALL_FILE) etc/Xsession                    $(DESTDIR)$(ETCDIR)/
+	$(INSTALL_SYMLINK) /etc/X11/Xresources          $(DESTDIR)$(ETCDIR)/
+	$(INSTALL_SYMLINK) /etc/X11/Xsession.d          $(DESTDIR)$(ETCDIR)/
+	$(INSTALL_SYMLINK) /etc/X11/Xsession.options    $(DESTDIR)$(ETCDIR)/
+
 
 install_man:
 #	$(INSTALL_DIR) $(DESTDIR)$(MANDIR)
diff --git a/x2goserver-xsession/VERSION.x2goserver-xsession b/x2goserver-xsession/VERSION.x2goserver-xsession
index d720f99..c7d6552 100644
--- a/x2goserver-xsession/VERSION.x2goserver-xsession
+++ b/x2goserver-xsession/VERSION.x2goserver-xsession
@@ -1 +1 @@
-3.0.99.8
\ No newline at end of file
+3.0.99.9
\ No newline at end of file
diff --git a/x2goserver/Makefile b/x2goserver/Makefile
index 2cc1bbd..d934497 100755
--- a/x2goserver/Makefile
+++ b/x2goserver/Makefile
@@ -67,7 +67,7 @@ install_scripts:
 	$(INSTALL_PROGRAM) lib/*                   $(DESTDIR)$(LIBDIR)/
 	$(INSTALL_PROGRAM) share/x2gofeature.d/*.features $(DESTDIR)$(SHAREDIR)/x2gofeature.d/
 	chmod a-x $(DESTDIR)$(LIBDIR)/*.pm
-	chown root:x2gouser $(DESTDIR)$(LIBDIR)/x2gosqlitewrapper
+	getent group x2gouser &amp;&gt;/dev/null &amp;&amp; chown root:x2gouser $(DESTDIR)$(LIBDIR)/x2gosqlitewrapper || true
 	chmod 2755 $(DESTDIR)$(LIBDIR)/x2gosqlitewrapper
 
 install_config:
diff --git a/x2goserver/VERSION.x2goserver b/x2goserver/VERSION.x2goserver
index d720f99..c7d6552 100644
--- a/x2goserver/VERSION.x2goserver
+++ b/x2goserver/VERSION.x2goserver
@@ -1 +1 @@
-3.0.99.8
\ No newline at end of file
+3.0.99.9
\ No newline at end of file
diff --git a/x2goserver/bin/x2gobasepath b/x2goserver/bin/x2gobasepath
index 4f9198b..1716538 100755
--- a/x2goserver/bin/x2gobasepath
+++ b/x2goserver/bin/x2gobasepath
@@ -21,9 +21,10 @@
 
 use strict;
 use Cwd;
-use Cwd 'abs_path';
+use Cwd q{abs_path};
+use File::Basename;
 
-my $dir = getcwd;
-my $base_path = abs_path(&quot;$0/../..&quot;); 
+my $dir = dirname($0);
+my $base_path = abs_path(&quot;$dir/..&quot;); 
 
 print &quot;$base_path&quot;;
diff --git a/x2goserver/lib/x2gogetservers b/x2goserver/bin/x2gogetservers
similarity index 100%
rename from x2goserver/lib/x2gogetservers
rename to x2goserver/bin/x2gogetservers
diff --git a/x2goserver/bin/x2gomountdirs b/x2goserver/bin/x2gomountdirs
index 7f65d07..203eb06 100755
--- a/x2goserver/bin/x2gomountdirs
+++ b/x2goserver/bin/x2gomountdirs
@@ -31,7 +31,7 @@ openlog($0,'cons,pid','user');
 setlogmask( LOG_UPTO(x2gologlevel()) );
 
 
-syslog('info', &quot;x2golistmountdirs has been called with options: @ARGV&quot;);
+syslog('info', &quot;x2gomountdirs has been called with options: @ARGV&quot;);
 
 my $type=shift;
 my $session=shift;
diff --git a/x2goserver/bin/x2goresume-session b/x2goserver/bin/x2goresume-session
index 16a7f0c..7ad09f4 100755
--- a/x2goserver/bin/x2goresume-session
+++ b/x2goserver/bin/x2goresume-session
@@ -35,6 +35,12 @@ X2GO_ROOT=${HOME}/.x2go
 X2GO_RESIZE=0
 X2GO_FULLSCREEN=0
 
+NX_XINERAMA_CONF=$X2GO_ROOT/C-$SESSION_NAME/xinerama.conf
+if [ -e $NX_XINERAMA_CONF ]
+then
+	rm $NX_XINERAMA_CONF
+fi
+
 $X2GO_LIB_PATH/x2gosyslog &quot;$0&quot; &quot;info&quot; &quot;$(basename $0) called with options: $@&quot;
 
 if [ &quot;$X2GO_GEOMETRY&quot; == &quot;&quot; ]
diff --git a/x2goserver/bin/x2goruncommand b/x2goserver/bin/x2goruncommand
index d3f0d98..b24d2f2 100755
--- a/x2goserver/bin/x2goruncommand
+++ b/x2goserver/bin/x2goruncommand
@@ -40,8 +40,15 @@ X2GO_ROOT=${HOME}/.x2go
 MESSAGE_FILE=$X2GO_ROOT/C-$X2GO_SESSION/cmdoutput
 echo &quot;exec $cmd&quot; &gt;&gt; $MESSAGE_FILE
 
+NX_XINERAMA_CONF=$X2GO_ROOT/C-$X2GO_SESSION/xinerama.conf
+export NX_XINERAMA_CONF
+
 IMEXIT=&quot;false&quot;
 
+NX_XINERAMA_LIBS=/usr/lib/nx/X11/Xinerama
+test -n $LD_LIBRARY_PATH &amp;&amp; LD_LIBRARY_PATH=$NX_XINERAMA_LIBS:$LD_LIBRARY_PATH || LD_LIBRARY_PATH=$NX_XINERAMA_LIBS
+export LD_LIBRARY_PATH
+
 if [ &quot;$sndsys&quot; == &quot;esd&quot; ]; then
 	export ESPEAKER=localhost:$4
 elif [ &quot;$sndsys&quot; == &quot;arts&quot; ]; then
diff --git a/x2goserver/bin/x2gostartagent b/x2goserver/bin/x2gostartagent
index 32d16b8..2af8749 100755
--- a/x2goserver/bin/x2gostartagent
+++ b/x2goserver/bin/x2gostartagent
@@ -29,16 +29,19 @@ SSH_PORT=30000 #First ssh port 30001
 
 X2GO_ROOT=${HOME}/.x2go
 REMOTE=localhost
+
 X2GO_CLIENT=`echo $SSH_CLIENT | awk '{print $1}'`
-X2GO_GEOMETRY=$1
-X2GO_LINK=$2
-X2GO_PACK=$3
-X2GO_TYPE=$4
-X2GO_KBD_LAYOUT=$5
-X2GO_KBD_TYPE=$6
-X2GO_SET_KBD=$7
-X2GO_STYPE=$8
-X2GO_CMD=$9
+$X2GO_LIB_PATH/x2gosyslog &quot;$0&quot; &quot;debug&quot; &quot;client announced itself as ,,$X2GO_CLIENT''&quot;
+
+X2GO_GEOMETRY=$1; shift
+X2GO_LINK=$1; shift
+X2GO_PACK=$1; shift
+X2GO_TYPE=$1; shift
+X2GO_KBD_LAYOUT=$1; shift
+X2GO_KBD_TYPE=$1; shift
+X2GO_SET_KBD=$1; shift
+X2GO_STYPE=$1; shift
+X2GO_CMD=$1; shift
 X2GO_RESIZE=0
 X2GO_FULLSCREEN=0
 
@@ -47,15 +50,23 @@ if [ &quot;$X2GO_STYPE&quot; == &quot;S&quot; ]; then
 	SHADOW_MODE=`echo &quot;$X2GO_CMD&quot;|awk '{split($0,a,&quot;XSHAD&quot;); print a[1]}'`
 	SHADOW_USER=`echo &quot;$X2GO_CMD&quot;|awk '{split($0,a,&quot;XSHAD&quot;); print a[2]}'`
 	SHADOW_DESKTOP=`echo &quot;$X2GO_CMD&quot;|awk '{split($0,a,&quot;XSHAD&quot;); print a[3]}'`
-	$X2GO_LIB_PATH/x2gosyslog &quot;$0&quot; &quot;debug&quot; &quot;shadow session requested: mode $SHADOW_MODE, user: $SHADOW_USER, desktop: $SHADOW_DESKTOP&quot;
 
-	echo &quot;suser $SHADOW_USER user $USER &quot; &gt;&gt; /tmp/uagent
+	test -z $1 &amp;&amp; { 
+
+		# can this line be removed?
+		#echo &quot;suser $SHADOW_USER user $USER &quot; &gt;&gt; /tmp/uagent
+
+		$X2GO_LIB_PATH/x2gosyslog &quot;$0&quot; &quot;debug&quot; &quot;shadow session requested: mode $SHADOW_MODE, user: $SHADOW_USER, desktop: $SHADOW_DESKTOP&quot;
+	} || {
+		SHADREQ_USER=$1; shift
+		$X2GO_LIB_PATH/x2gosyslog &quot;$0&quot; &quot;debug&quot; &quot;preparing shadow session request for user $SHADREQ_USER, agent starts for user ${USER}&quot;
+	}
 
 	if [ &quot;$SHADOW_USER&quot; != &quot;$USER&quot; ]; then
 
 		$X2GO_LIB_PATH/x2gosyslog &quot;$0&quot; &quot;notice&quot; &quot;user ,,$USER'' requests desktop sharing from user ,,$SHADOW_USER'' for desktop ,,$SHADOW_DESKTOP''&quot;
-		$X2GO_LIB_PATH/x2gosyslog &quot;$0&quot; &quot;debug&quot; &quot;executing command: x2godesktopsharing client $X2GO_CLIENT $@ $USER&quot;
-		OUTPUT=`x2godesktopsharing client $X2GO_CLIENT $@ $USER`
+		$X2GO_LIB_PATH/x2gosyslog &quot;$0&quot; &quot;debug&quot; &quot;executing command: x2godesktopsharing client $X2GO_CLIENT $X2GO_GEOMETRY $X2GO_LINK $X2GO_PACK $X2GO_TYPE $X2GO_KBD_LAYOUT $X2GO_KBD_TYPE $X2GO_SET_KBD $X2GO_STYPE $X2GO_CMD $USER&quot;
+		OUTPUT=`x2godesktopsharing client $X2GO_CLIENT $X2GO_GEOMETRY $X2GO_LINK $X2GO_PACK $X2GO_TYPE $X2GO_KBD_LAYOUT $X2GO_KBD_TYPE $X2GO_SET_KBD $X2GO_STYPE $X2GO_CMD $USER`
 		$X2GO_LIB_PATH/x2gosyslog &quot;$0&quot; &quot;debug&quot; &quot;command result is: $OUTPUT&quot;
 		if [ &quot;$OUTPUT&quot; == &quot;DENY&quot; ]; then
 			echo &quot;ACCESS DENIED&quot; 1&gt;&amp;2
@@ -185,8 +196,6 @@ fi
 X2GO_COOKIE=`mcookie`
 
 
-LD_LIBRARY_PATH=&quot;${LD_LIBRARY_PATH}:${X2GO_LIB}&quot;
-export LD_LIBRARY_PATH
 
 PATH=&quot;${PATH}:${X2GO_BIN}/&quot;
 export PATH
@@ -227,12 +236,15 @@ fi
 # run x2goserver-extensions for pre-start
 x2gofeature X2GO_RUN_EXTENSIONS &amp;&gt;/dev/null &amp;&amp; x2goserver-run-extensions $SESSION_NAME pre-start || true
 
+SESSION_WINDOW_TITLE=&quot;X2GO-${SESSION_NAME}&quot;
+
 if  [ &quot;$X2GO_STYPE&quot; == &quot;S&quot; ]; then
-	LD_LIBRARY_PATH=$X2GO_LIB x2goagent $X2GODPIOPTION_  -$SESSION_TYPE -auth ~/.Xauthority -S -shadow $SHADOW_DESKTOP -shadowmode $SHADOW_MODE -geometry ${X2GO_GEOMETRY} -name &quot;X2GO-${SESSION_NAME}&quot;  ${NX_AGENT} 2&gt;${SESSION_DIR}/session.log &amp;
+	x2goagent $X2GODPIOPTION_  -$SESSION_TYPE -auth ~/.Xauthority -S -shadow $SHADOW_DESKTOP -shadowmode $SHADOW_MODE -geometry ${X2GO_GEOMETRY} -name &quot;${SESSION_WINDOW_TITLE}&quot;  ${NX_AGENT} 2&gt;${SESSION_DIR}/session.log &amp;
 else
-	LD_LIBRARY_PATH=$X2GO_LIB x2goagent $X2GODPIOPTION_ $XDMCPOPT  -$SESSION_TYPE -auth ~/.Xauthority -geometry ${X2GO_GEOMETRY} -name &quot;X2GO-${SESSION_NAME}&quot;  ${NX_AGENT} 2&gt;${SESSION_DIR}/session.log &amp;
+	x2goagent $X2GODPIOPTION_ $XDMCPOPT  -$SESSION_TYPE -auth ~/.Xauthority -geometry ${X2GO_GEOMETRY} -name &quot;${SESSION_WINDOW_TITLE}&quot;  ${NX_AGENT} 2&gt;${SESSION_DIR}/session.log &amp;
 fi
 
+
 X2GO_AGENT_PID=$!
 X2GO_AGENT_RETVAL=$?
 test $X2GO_AGENT_RETVAL &amp;&amp; {
diff --git a/x2goserver/sbin/x2godbadmin b/x2goserver/sbin/x2godbadmin
index 441b176..d65d752 100755
--- a/x2goserver/sbin/x2godbadmin
+++ b/x2goserver/sbin/x2godbadmin
@@ -108,11 +108,13 @@ my $user=&quot;x2gouser&quot;;
 		                      unique(display))
 		                      &quot;);
 		$sth-&gt;execute() or die;
+		$sth-&gt;finish();
 
 		my $sth=$dbh-&gt;prepare(&quot;
 		                      create table messages(mess_id varchar(20) primary key, message text)
 		                      &quot;);
 		$sth-&gt;execute() or die;
+		$sth-&gt;finish();
 
 		my $sth=$dbh-&gt;prepare(&quot;
 		                      create table user_messages(
@@ -120,6 +122,7 @@ my $user=&quot;x2gouser&quot;;
 		                      uname varchar(100) not null)
 		                      &quot;);
 		$sth-&gt;execute() or die;
+		$sth-&gt;finish();
 
 		my $sth=$dbh-&gt;prepare(&quot;
 		                      create table used_ports(
@@ -128,6 +131,7 @@ my $user=&quot;x2gouser&quot;;
 		                      port integer primary key)
 		                      &quot;);
 		$sth-&gt;execute() or die;
+		$sth-&gt;finish();
 
 		my $sth=$dbh-&gt;prepare(&quot;
 		                      create table mounts(
@@ -137,6 +141,7 @@ my $user=&quot;x2gouser&quot;;
 		                      primary key(path,client))
 		                      &quot;);
 		$sth-&gt;execute() or die;
+		$sth-&gt;finish();
 
 		my $sth=$dbh-&gt;prepare(&quot;
 		                      CREATE TRIGGER fkd_mounts_session_id
@@ -149,6 +154,7 @@ my $user=&quot;x2gouser&quot;;
 		                      END;
 		                      &quot;);
 		$sth-&gt;execute() or die; 
+		$sth-&gt;finish();
 
 		my $sth=$dbh-&gt;prepare(&quot;
 		                      CREATE TRIGGER fkd_ports_session_id
@@ -160,9 +166,11 @@ my $user=&quot;x2gouser&quot;;
 		                      END;
 		                      &quot;);
 		$sth-&gt;execute() or die; 
-
 		$sth-&gt;finish();
-		$dbh-&gt;disconnect();
+
+		# undef $dbh should be preferred to $dbh-&gt;disconnect(), see
+		# <A HREF="http://www.perlmonks.org/?node_id=665714">http://www.perlmonks.org/?node_id=665714</A>
+		undef $dbh;
 		chmod(0770, &quot;$dir&quot;);
 		chown('root',$pgid,&quot;$dir&quot;);
 		chmod(0660, &quot;$dbfile&quot;);


hooks/post-receive
-- 
x2goserver.git (X2Go Server)

This is an automated email from the git hooks/post-receive script. It was
generated because a ref change was pushed to the repository containing
the project &quot;x2goserver.git&quot; (X2Go Server).


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002136.html">[X2go-Commits] x2goserver.git - master (branch) updated:	3.0.99.8-47-gd578560
</A></li>
	<LI>Next message: <A HREF="002138.html">[X2go-Commits] x2goserver.git - master (branch) updated:	3.0.99.9-1-g67d66c5
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2137">[ date ]</a>
              <a href="thread.html#2137">[ thread ]</a>
              <a href="subject.html#2137">[ subject ]</a>
              <a href="author.html#2137">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/x2go-commits">More information about the X2go-commits
mailing list</a><br>
</body></html>
