<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [X2go-Commits] x2goclient.git - master (branch) updated:	3.99.2.2-28-g969d3fe
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/x2go-commits/2012-September/index.html" >
   <LINK REL="made" HREF="mailto:x2go-commits%40lists.berlios.de?Subject=Re%3A%20%5BX2go-Commits%5D%20x2goclient.git%20-%20master%20%28branch%29%20updated%3A%0A%093.99.2.2-28-g969d3fe&In-Reply-To=%3C20120905144122.3622D5DB1F%40ymir%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="003139.html">
   <LINK REL="Next"  HREF="003141.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[X2go-Commits] x2goclient.git - master (branch) updated:	3.99.2.2-28-g969d3fe</H1>
    <B>X2Go dev team</B> 
    <A HREF="mailto:x2go-commits%40lists.berlios.de?Subject=Re%3A%20%5BX2go-Commits%5D%20x2goclient.git%20-%20master%20%28branch%29%20updated%3A%0A%093.99.2.2-28-g969d3fe&In-Reply-To=%3C20120905144122.3622D5DB1F%40ymir%3E"
       TITLE="[X2go-Commits] x2goclient.git - master (branch) updated:	3.99.2.2-28-g969d3fe">git-admin at x2go.org
       </A><BR>
    <I>Wed Sep  5 16:41:22 CEST 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="003139.html">[X2go-Commits] x2goclient.git - master (branch) updated:	3.99.2.2-27-g77e1eb7
</A></li>
        <LI>Next message: <A HREF="003141.html">[X2go-Commits] x2gothinclient.git - master (branch) updated:	1.0.1.8-33-gcacfdec
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3140">[ date ]</a>
              <a href="thread.html#3140">[ thread ]</a>
              <a href="subject.html#3140">[ subject ]</a>
              <a href="author.html#3140">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>The branch, master has been updated
       via  969d3fec74e287fd62aaa4333892de547e8dd584 (commit)
      from  77e1eb78f99f8422bdba54fc12606c0aa574ffec (commit)

Those revisions listed above that are new to this repository have
not appeared on any other notification email; so we list those
revisions in full, below.

- Log -----------------------------------------------------------------
commit 969d3fec74e287fd62aaa4333892de547e8dd584
Author: Oleksandr Shneyder &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/x2go-commits">oleksandr.shneyder at obviously-nice.de</A>&gt;
Date:   Wed Sep 5 16:41:16 2012 +0200

    restart pulse server on windows if it crashed

-----------------------------------------------------------------------

Summary of changes:
 debian/changelog |    1 +
 onmainwindow.cpp |  290 ++++++++++++++++++++++++++++--------------------------
 onmainwindow.h   |    3 +
 3 files changed, 155 insertions(+), 139 deletions(-)

The diff of changes is:
diff --git a/debian/changelog b/debian/changelog
index 17c4e02..7af8b1d 100644
--- a/debian/changelog
+++ b/debian/changelog
@@ -26,6 +26,7 @@ x2goclient (3.99.3.0-0~x2go1) UNRELEASED; urgency=low
       Russian translation.
     - Add translation for checkbox &quot;Direct RDP Connection&quot; and update Russian
       and German translation.
+  * restart pulse server on windows if it crashed
 
  -- Oleksandr Shneyder &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/x2go-commits">oleksandr.shneyder at obviously-nice.de</A>&gt;  Wed, 05 Sep 2012 11:40:47 +0200
 
diff --git a/onmainwindow.cpp b/onmainwindow.cpp
index 5fbb941..7fb4cdd 100644
--- a/onmainwindow.cpp
+++ b/onmainwindow.cpp
@@ -177,7 +177,7 @@ ONMainWindow::ONMainWindow ( QWidget *parent ) :QMainWindow ( parent )
 
 #ifdef CFGCLIENT
     QStringList args=QCoreApplication::arguments();
-    for ( int i=1;i&lt;args.size();++i )
+    for ( int i=1; i&lt;args.size(); ++i )
     {
         if ( !parseParameter ( args[i] ) )
         {
@@ -214,7 +214,7 @@ ONMainWindow::ONMainWindow ( QWidget *parent ) :QMainWindow ( parent )
 
         homeDir=portableDataPath;
         x2goDebug&lt;&lt;&quot;running in \&quot;portable\&quot; mode\n&quot;&lt;&lt;
-        &quot;Data Dir is &quot;&lt;&lt;portableDataPath;
+                 &quot;Data Dir is &quot;&lt;&lt;portableDataPath;
         QTimer *timer = new QTimer(this);
         connect(timer, SIGNAL(timeout()), this, SLOT(slotCheckPortableDir()));
         timer-&gt;start(1000);
@@ -528,7 +528,7 @@ void ONMainWindow::installTranslator()
     if ( !qtTranslator-&gt;load ( filename ) )
     {
         x2goDebug&lt;&lt; &quot;Can't load translator &quot;&lt;&lt;
-        filename.toLocal8Bit().data() ;
+                 filename.toLocal8Bit().data() ;
     }
     else
     {
@@ -1124,7 +1124,7 @@ void ONMainWindow::removeAppsFromTray()
     if (!trayIcon)
         return;
     x2goDebug&lt;&lt;&quot;remove apps\n&quot;;
-    for (int i=0;i&lt;=Application::OTHER;++i)
+    for (int i=0; i&lt;=Application::OTHER; ++i)
     {
         appMenu[i]-&gt;clear();
         appMenu[i]-&gt;menuAction()-&gt;setVisible(false);
@@ -1180,7 +1180,7 @@ void ONMainWindow::slotResize ( const QSize sz )
             {
                 QList&lt;UserButton*&gt;::iterator it;
                 QList&lt;UserButton*&gt;::iterator end=names.end();
-                for ( it=names.begin();it!=end;it++ )
+                for ( it=names.begin(); it!=end; it++ )
                 {
                     if ( !miniMode )
                         ( *it )-&gt;move (
@@ -1197,7 +1197,7 @@ void ONMainWindow::slotResize ( const QSize sz )
                 QList&lt;SessionButton*&gt;::iterator it;
                 QList&lt;SessionButton*&gt;::iterator end=
                     sessions.end();
-                for ( it=sessions.begin();it!=end;it++ )
+                for ( it=sessions.begin(); it!=end; it++ )
                 {
                     if ( !miniMode )
                         ( *it )-&gt;move (
@@ -1270,7 +1270,7 @@ void ONMainWindow::closeClient()
     }
     if (useLdap)
     {
-        for (int i=0;i&lt;serverSshConnections.count();++i)
+        for (int i=0; i&lt;serverSshConnections.count(); ++i)
         {
             if (serverSshConnections[i])
             {
@@ -1334,6 +1334,8 @@ void ONMainWindow::closeClient()
 #ifdef Q_OS_WIN
     if ( pulseServer )
     {
+        delete pulseTimer;
+
         x2goDebug&lt;&lt;&quot;terminate pulse&quot;;
         pulseServer-&gt;kill();
         x2goDebug&lt;&lt;&quot;done\ndelete pulse process&quot;;
@@ -1529,7 +1531,7 @@ void ONMainWindow::displayUsers()
     QList&lt;user&gt;::iterator it;
     QList&lt;user&gt;::iterator end=userList.end();
     int i=0;
-    for ( it=userList.begin();it!=end;it++ )
+    for ( it=userList.begin(); it!=end; it++ )
     {
         int val=i+1;
         UserButton* l;
@@ -1708,7 +1710,7 @@ void ONMainWindow::slotPassEnter()
     QString freeServer;
     QString firstServer;
     bool isFirstServerSet=false;
-    for ( ;it!=end;++it )
+    for ( ; it!=end; ++it )
     {
         serv server;
         server.name=LDAPSession::getStringAttrValues (
@@ -1776,7 +1778,7 @@ void ONMainWindow::slotUnameChanged ( const QString&amp; text )
         return;
     QList&lt;UserButton*&gt;::iterator it;
     QList&lt;UserButton*&gt;::iterator endit=names.end();
-    for ( it=names.begin();it!=endit;it++ )
+    for ( it=names.begin(); it!=endit; it++ )
     {
         QString username= ( *it )-&gt;username();
         if ( username.indexOf ( text,0,Qt::CaseInsensitive ) ==0 )
@@ -1806,7 +1808,7 @@ void ONMainWindow::slotUnameEntered()
         UserButton* user=NULL;
         QList&lt;UserButton*&gt;::iterator it;
         QList&lt;UserButton*&gt;::iterator endit=names.end();
-        for ( it=names.begin();it!=endit;it++ )
+        for ( it=names.begin(); it!=endit; it++ )
         {
             QString username= ( *it )-&gt;username();
             if ( username==text )
@@ -1822,7 +1824,7 @@ void ONMainWindow::slotUnameEntered()
         SessionButton* sess=NULL;
         QList&lt;SessionButton*&gt;::iterator it;
         QList&lt;SessionButton*&gt;::iterator endit=sessions.end();
-        for ( it=sessions.begin();it!=endit;it++ )
+        for ( it=sessions.begin(); it!=endit; it++ )
         {
             QString name= ( *it )-&gt;name();
             if ( name==text )
@@ -1882,7 +1884,7 @@ void ONMainWindow::readUsers()
     list&lt;LDAPBinEntry&gt;::iterator it=result.begin();
     list&lt;LDAPBinEntry&gt;::iterator end=result.end();
 
-    for ( ;it!=end;++it )
+    for ( ; it!=end; ++it )
     {
         user u;
         QString uin=LDAPSession::getBinAttrValues (
@@ -1913,7 +1915,7 @@ void ONMainWindow::readUsers()
     if ( defaultUser )
     {
         defaultUser=false;
-        for ( int i=0;i&lt;userList.size();++i )
+        for ( int i=0; i&lt;userList.size(); ++i )
         {
             if ( userList[i].uid ==defaultUserName )
             {
@@ -1963,9 +1965,9 @@ void ONMainWindow::slotConfig()
         if ( !embedMode )
         {
 
-            for ( i=0;i&lt;names.size();++i )
+            for ( i=0; i&lt;names.size(); ++i )
                 names[i]-&gt;close();
-            for ( i=0;i&lt;sessions.size();++i )
+            for ( i=0; i&lt;sessions.size(); ++i )
                 sessions[i]-&gt;close();
 
             userList.clear();
@@ -2042,13 +2044,13 @@ void ONMainWindow::slotCreateDesktopIcon ( SessionButton* bt )
         cmd=&quot;x2goclient --hide&quot;;
     QTextStream out ( &amp;file );
     out &lt;&lt; &quot;[Desktop Entry]\n&quot;&lt;&lt;
-    &quot;Exec[$e]=&quot;&lt;&lt;cmd&lt;&lt;&quot; --sessionid=&quot;&lt;&lt;bt-&gt;id() &lt;&lt;&quot;\n&quot;&lt;&lt;
-    &quot;Icon=&quot;&lt;&lt;sessIcon&lt;&lt;&quot;\n&quot;&lt;&lt;
-    &quot;Name=&quot;&lt;&lt;name&lt;&lt;&quot;\n&quot;&lt;&lt;
-    &quot;StartupNotify=true\n&quot;&lt;&lt;
-    &quot;Terminal=false\n&quot;&lt;&lt;
-    &quot;Type=Application\n&quot;&lt;&lt;
-    &quot;X-KDE-SubstituteUID=false\n&quot;;
+        &quot;Exec[$e]=&quot;&lt;&lt;cmd&lt;&lt;&quot; --sessionid=&quot;&lt;&lt;bt-&gt;id() &lt;&lt;&quot;\n&quot;&lt;&lt;
+        &quot;Icon=&quot;&lt;&lt;sessIcon&lt;&lt;&quot;\n&quot;&lt;&lt;
+        &quot;Name=&quot;&lt;&lt;name&lt;&lt;&quot;\n&quot;&lt;&lt;
+        &quot;StartupNotify=true\n&quot;&lt;&lt;
+        &quot;Terminal=false\n&quot;&lt;&lt;
+        &quot;Type=Application\n&quot;&lt;&lt;
+        &quot;X-KDE-SubstituteUID=false\n&quot;;
     file.close();
 #else
     QString scrname=QDir::tempPath() +&quot;\\mklnk.vbs&quot;;
@@ -2065,17 +2067,17 @@ void ONMainWindow::slotCreateDesktopIcon ( SessionButton* bt )
         args+=&quot; --hide&quot;;
     QTextStream out ( &amp;file );
     out &lt;&lt; &quot;Set Shell = CreateObject(\&quot;WScript.Shell\&quot;)\n&quot;&lt;&lt;
-    &quot;DesktopPath = Shell.SpecialFolders(\&quot;Desktop\&quot;)\n&quot;&lt;&lt;
-    &quot;Set link = Shell.CreateShortcut(DesktopPath &amp; \&quot;\\&quot;&lt;&lt;name&lt;&lt;
-    &quot;.lnk\&quot;)\n&quot;&lt;&lt;
-    &quot;link.Arguments = \&quot;&quot;&lt;&lt;args&lt;&lt;&quot;\&quot;\n&quot;&lt;&lt;
-    &quot;link.Description = \&quot;&quot;&lt;&lt;tr ( &quot;X2Go Link to session &quot; ) &lt;&lt;
-    &quot;--&quot;&lt;&lt;name&lt;&lt;&quot;--&quot;&lt;&lt;&quot;\&quot;\n&quot;&lt;&lt;
-    &quot;link.TargetPath = \&quot;&quot;&lt;&lt;progname&lt;&lt;&quot;\&quot;\n&quot;&lt;&lt;
-    &quot;link.iconLocation = \&quot;&quot;&lt;&lt;progname&lt;&lt;&quot;\&quot;\n&quot;&lt;&lt;
-    &quot;link.WindowStyle = 1\n&quot;&lt;&lt;
-    &quot;link.WorkingDirectory = \&quot;&quot;&lt;&lt;workDir&lt;&lt;&quot;\&quot;\n&quot;&lt;&lt;
-    &quot;link.Save\n&quot;;
+        &quot;DesktopPath = Shell.SpecialFolders(\&quot;Desktop\&quot;)\n&quot;&lt;&lt;
+        &quot;Set link = Shell.CreateShortcut(DesktopPath &amp; \&quot;\\&quot;&lt;&lt;name&lt;&lt;
+        &quot;.lnk\&quot;)\n&quot;&lt;&lt;
+        &quot;link.Arguments = \&quot;&quot;&lt;&lt;args&lt;&lt;&quot;\&quot;\n&quot;&lt;&lt;
+        &quot;link.Description = \&quot;&quot;&lt;&lt;tr ( &quot;X2Go Link to session &quot; ) &lt;&lt;
+        &quot;--&quot;&lt;&lt;name&lt;&lt;&quot;--&quot;&lt;&lt;&quot;\&quot;\n&quot;&lt;&lt;
+        &quot;link.TargetPath = \&quot;&quot;&lt;&lt;progname&lt;&lt;&quot;\&quot;\n&quot;&lt;&lt;
+        &quot;link.iconLocation = \&quot;&quot;&lt;&lt;progname&lt;&lt;&quot;\&quot;\n&quot;&lt;&lt;
+        &quot;link.WindowStyle = 1\n&quot;&lt;&lt;
+        &quot;link.WorkingDirectory = \&quot;&quot;&lt;&lt;workDir&lt;&lt;&quot;\&quot;\n&quot;&lt;&lt;
+        &quot;link.Save\n&quot;;
     file.close();
     system ( scrname.toAscii() );
     QFile::remove ( scrname );
@@ -2099,7 +2101,7 @@ void ONMainWindow::slotReadSessions()
         config.key=QString::null;
         config.user=QString::null;
         config.sessiondata=QString::null;
-        for (int i=sessions.count()-1;i&gt;=0;--i)
+        for (int i=sessions.count()-1; i&gt;=0; --i)
         {
             SessionButton* but=sessions.takeAt(i);
             if (but)
@@ -2122,7 +2124,7 @@ void ONMainWindow::slotReadSessions()
         QMessageBox::critical(this,tr(&quot;Error&quot;),tr(&quot;X2Go sessions not found&quot;));
         close();
     }
-    for ( int i=0;i&lt;slst.size();++i )
+    for ( int i=0; i&lt;slst.size(); ++i )
     {
         if ( slst[i]!=&quot;embedded&quot; )
             createBut ( slst[i] );
@@ -2150,7 +2152,7 @@ void ONMainWindow::slotReadSessions()
         defaultSession=false;
         if ( defaultSessionId.length() &gt;0 )
         {
-            for ( int i=0;i&lt;sessions.size();++i )
+            for ( int i=0; i&lt;sessions.size(); ++i )
             {
                 if ( sessions[i]-&gt;id() ==defaultSessionId )
                 {
@@ -2162,7 +2164,7 @@ void ONMainWindow::slotReadSessions()
         }
         else
         {
-            for ( int i=0;i&lt;sessions.size();++i )
+            for ( int i=0; i&lt;sessions.size(); ++i )
             {
                 if ( sessions[i]-&gt;name() ==defaultSessionName )
                 {
@@ -2235,7 +2237,7 @@ SessionButton* ONMainWindow::createBut ( const QString&amp; id )
 void ONMainWindow::placeButtons()
 {
     qSort ( sessions.begin(),sessions.end(),SessionButton::lessThen );
-    for ( int i=0;i&lt;sessions.size();++i )
+    for ( int i=0; i&lt;sessions.size(); ++i )
     {
         if ( !miniMode )
             sessions[i]-&gt;move ( ( users-&gt;width()-360 ) /2,
@@ -2511,7 +2513,7 @@ void ONMainWindow::slotSnameChanged ( const QString&amp; text )
         return;
     QList&lt;SessionButton*&gt;::iterator it;
     QList&lt;SessionButton*&gt;::iterator endit=sessions.end();
-    for ( it=sessions.begin();it!=endit;it++ )
+    for ( it=sessions.begin(); it!=endit; it++ )
     {
         QString name= ( *it )-&gt;name();
         if ( name.indexOf ( text,0,Qt::CaseInsensitive ) ==0 )
@@ -2731,7 +2733,7 @@ SshMasterConnection* ONMainWindow::startSshConnection ( QString host, QString po
 
     SshMasterConnection* con;
     x2goDebug&lt;&lt;&quot;start new ssh connection to server:&quot;&lt;&lt;host&lt;&lt;&quot;:&quot;&lt;&lt;port&lt;&lt;&quot;krb: &quot;&lt;&lt;krbLogin&lt;&lt;endl;
-    for ( int i=0;i&lt;sshEnv.size();++i )
+    for ( int i=0; i&lt;sshEnv.size(); ++i )
     {
 #ifndef Q_OS_WIN
         QStringList args=sshEnv[i].split ( &quot;=&quot; );
@@ -2817,7 +2819,7 @@ void ONMainWindow::slotSshConnectionOk()
 
 SshMasterConnection*  ONMainWindow::findServerSshConnection(QString host)
 {
-    for (int i=0;i&lt;serverSshConnections.count();++i)
+    for (int i=0; i&lt;serverSshConnections.count(); ++i)
     {
         if (serverSshConnections[i])
         {
@@ -2988,7 +2990,7 @@ void ONMainWindow::continueNormalSession()
     SshProcess* proc=new SshProcess ( sshConnection, this );
     connect ( proc,SIGNAL ( sshFinished ( bool,QString,SshProcess* ) ),
               this,SLOT ( slotListSessions ( bool, QString,
-                                             SshProcess* ) ) );
+                          SshProcess* ) ) );
     if ( !shadowSession )
         proc-&gt;startNormal ( &quot;export HOSTNAME &amp;&amp; x2golistsessions&quot; );
     else
@@ -3262,7 +3264,7 @@ void ONMainWindow::slotListSessions ( bool result,QString output,
                 selectSession ( sessions );
             else
             {
-                for ( int i=0;i&lt;sessions.size();++i )
+                for ( int i=0; i&lt;sessions.size(); ++i )
                 {
                     x2goSession s=getSessionFromString (
                                       sessions[i] );
@@ -3360,7 +3362,7 @@ void ONMainWindow::startNewSession()
         type=defaultKbdType;
         command=defaultCmd;
         shadowSession=false;
-        for ( int j=0;j&lt;x2goServers.size();++j )
+        for ( int j=0; j&lt;x2goServers.size(); ++j )
         {
             if ( x2goServers[j].connOk )
             {
@@ -3645,7 +3647,7 @@ void ONMainWindow::startNewSession()
 
     connect ( proc,SIGNAL ( sshFinished ( bool, QString,SshProcess* ) ),
               this,SLOT ( slotRetResumeSess ( bool,
-                                              QString,SshProcess* ) ) );
+                          QString,SshProcess* ) ) );
 
     proc-&gt;startNormal ( cmd );
     passForm-&gt;hide();
@@ -3886,7 +3888,7 @@ void ONMainWindow::resumeSession ( const x2goSession&amp; s )
 
     connect ( proc,SIGNAL ( sshFinished ( bool, QString,SshProcess* ) ),
               this,SLOT ( slotRetResumeSess ( bool, QString,
-                                              SshProcess* ) ) );
+                          SshProcess* ) ) );
 
     proc-&gt;startNormal ( cmd );
     resumingSession=s;
@@ -3961,7 +3963,7 @@ void ONMainWindow::selectSession ( QStringList&amp; sessions )
             model-&gt;setItem ( row,S_IP,item );
             item= new QStandardItem ( s.sessionId );
             model-&gt;setItem ( row,S_ID,item );
-            for ( int j=0;j&lt;8;++j )
+            for ( int j=0; j&lt;8; ++j )
             {
                 QString txt=
                     model-&gt;index ( row,j ).data().toString();
@@ -4550,7 +4552,7 @@ void ONMainWindow::slotRetResumeSess ( bool result,
 
     connect ( tunnel,SIGNAL ( sshFinished ( bool,  QString,SshProcess* ) ),
               this,SLOT ( slotTunnelFailed ( bool,
-                                             QString,SshProcess* ) ) );
+                          QString,SshProcess* ) ) );
     connect ( tunnel,SIGNAL ( sshTunnelOk() ),
               this,SLOT ( slotTunnelOk() ) );
 
@@ -4753,7 +4755,7 @@ x2goSession ONMainWindow::getSelectedSession()
 {
     QString sessId=sessTv-&gt;model()-&gt;index ( sessTv-&gt;currentIndex().row(),
                                             S_ID ).data().toString();
-    for ( int i=0;i&lt;selectedSessions.size();++i )
+    for ( int i=0; i&lt;selectedSessions.size(); ++i )
     {
         if ( selectedSessions[i].sessionId==sessId )
             return selectedSessions[i];
@@ -4823,10 +4825,10 @@ void ONMainWindow::slotTunnelOk()
     nxroot=cygwinPath ( nxroot );
 #endif
     out &lt;&lt; &quot;nx/nx,root=&quot;&lt;&lt;nxroot&lt;&lt;&quot;,connect=localhost,cookie=&quot;&lt;&lt;
-    resumingSession.cookie&lt;&lt;&quot;,port=&quot;
-    &lt;&lt;localGraphicPort/*resumingSession.grPort*/&lt;&lt;
-    &quot;,errors=&quot;&lt;&lt;dirpath&lt;&lt;&quot;/sessions:&quot;&lt;&lt;
-    resumingSession.display;
+        resumingSession.cookie&lt;&lt;&quot;,port=&quot;
+        &lt;&lt;localGraphicPort/*resumingSession.grPort*/&lt;&lt;
+        &quot;,errors=&quot;&lt;&lt;dirpath&lt;&lt;&quot;/sessions:&quot;&lt;&lt;
+        resumingSession.display;
     file.close();
     xmodExecuted=false;
 
@@ -4837,7 +4839,7 @@ void ONMainWindow::slotTunnelOk()
 #if defined ( Q_OS_WIN ) || defined ( Q_OS_DARWIN )
     int dispInd=-1;
 #endif
-    for ( int l=0;l&lt;env.size();++l )
+    for ( int l=0; l&lt;env.size(); ++l )
     {
 // 		x2goDebug&lt;&lt;env[l]&lt;&lt;endl;
         if ( env[l].indexOf ( &quot;X2GO_LIB&quot; ) ==0 )
@@ -5709,8 +5711,8 @@ void ONMainWindow::runCommand()
         connect ( proc,SIGNAL ( sshFinished ( bool, QString,
                                               SshProcess* ) ),
                   this,SLOT ( slotRetRunCommand ( bool,
-                                                  QString,
-                                                  SshProcess* ) ) );
+                              QString,
+                              SshProcess* ) ) );
 
         proc-&gt;startNormal ( cmd );
     }
@@ -5760,8 +5762,8 @@ void ONMainWindow::readApplications()
     connect ( proc,SIGNAL ( sshFinished ( bool, QString,
                                           SshProcess* ) ),
               this,SLOT ( slotReadApplications ( bool,
-                                                 QString,
-                                                 SshProcess* ) ) );
+                          QString,
+                          SshProcess* ) ) );
     proc-&gt;startNormal ( &quot;x2gogetapps&quot; );
     sbApps-&gt;setEnabled(false);
 }
@@ -6520,21 +6522,21 @@ void ONMainWindow::slotGetServers ( bool result, QString output,
     uname-&gt;setEnabled ( false );
     u-&gt;setEnabled ( false );
     QStringList servers=output.trimmed().split ( '\n' );
-    for ( int i=0;i&lt;servers.size();++i )
+    for ( int i=0; i&lt;servers.size(); ++i )
     {
         QStringList lst=servers[i].simplified().split ( ' ' );
         if ( lst.size() &gt;1 )
         {
-            for ( int j=0;j&lt;x2goServers.size();++j )
+            for ( int j=0; j&lt;x2goServers.size(); ++j )
                 if ( x2goServers[j].name==lst[0] )
                 {
                     x2goServers[j].sess=
                         lst[1].toInt() *
                         x2goServers[j].factor;
                     x2goDebug&lt;&lt;x2goServers[j].name&lt;&lt;
-                    &quot;: sessions &quot;&lt;&lt;
-                    lst[1].toInt() &lt;&lt;
-                    &quot;, multiplied &quot;&lt;&lt;x2goServers[j].sess;
+                             &quot;: sessions &quot;&lt;&lt;
+                             lst[1].toInt() &lt;&lt;
+                             &quot;, multiplied &quot;&lt;&lt;x2goServers[j].sess;
                     break;
                 }
         }
@@ -6549,13 +6551,13 @@ void ONMainWindow::slotGetServers ( bool result, QString output,
     QString passwd;
     QString user=getCurrentUname();
     passwd=getCurrentPass();
-    for (int i=0; i&lt; serverSshConnections.count();++i)
+    for (int i=0; i&lt; serverSshConnections.count(); ++i)
     {
         if (serverSshConnections[i])
             serverSshConnections[i]-&gt;disconnectSession();
     }
     serverSshConnections.clear();
-    for ( int j=0;j&lt;x2goServers.size();++j )
+    for ( int j=0; j&lt;x2goServers.size(); ++j )
     {
         QString host=x2goServers[j].name;
         sshPort=x2goServers[j].sshPort;
@@ -6589,7 +6591,7 @@ void ONMainWindow::slotListAllSessions ( bool result,QString output,
                                 QMessageBox::Ok,
                                 QMessageBox::NoButton );
         QString sv=output.split ( &quot;:&quot; ) [0];
-        for ( int j=0;j&lt;x2goServers.size();++j )
+        for ( int j=0; j&lt;x2goServers.size(); ++j )
         {
             if ( x2goServers[j].name==sv )
             {
@@ -6774,7 +6776,7 @@ void ONMainWindow::exportDefaultDirs()
                             ( QVariant ) QString::null ).toString();
             QStringList lst=exd.split ( &quot;;&quot;,
                                         QString::SkipEmptyParts );
-            for ( int i=0;i&lt;lst.size();++i )
+            for ( int i=0; i&lt;lst.size(); ++i )
             {
 #ifndef Q_OS_WIN
                 QStringList tails=lst[i].split (
@@ -6974,7 +6976,7 @@ void ONMainWindow::slotCopyKey ( bool result, QString output, SshProcess* proc )
 
 directory* ONMainWindow::getExpDir ( QString key )
 {
-    for ( int i=0;i&lt;exportDir.size();++i )
+    for ( int i=0; i&lt;exportDir.size(); ++i )
     {
         if ( exportDir[i].key==key )
             return &amp;exportDir[i];
@@ -6990,7 +6992,7 @@ void ONMainWindow::slotRetExportDir ( bool result,QString output,
 {
 
     QString key;
-    for ( int i=0;i&lt;exportDir.size();++i )
+    for ( int i=0; i&lt;exportDir.size(); ++i )
         if ( exportDir[i].proc==proc )
         {
             key=exportDir[i].key;
@@ -7088,10 +7090,10 @@ void ONMainWindow::slotExtTimer()
         x2goDebug &lt;&lt;&quot;Wrong permissions on &quot;&lt;&lt;readLoginsFrom &lt;&lt;&quot;:&quot;&lt;&lt;endl;
         x2goDebug &lt;&lt; ( int ) ( QFile::permissions (
                                    readLoginsFrom+&quot;/.&quot; ) )
-        &lt;&lt;&quot;must be&quot;&lt;&lt; ( int ) ( QFile::ReadUser|QFile::WriteUser
-                                |QFile::ExeUser|QFile::ReadOwner|
-                                QFile::WriteOwner|
-                                QFile::ExeOwner ) &lt;&lt;endl;
+                  &lt;&lt;&quot;must be&quot;&lt;&lt; ( int ) ( QFile::ReadUser|QFile::WriteUser
+                                          |QFile::ExeUser|QFile::ReadOwner|
+                                          QFile::WriteOwner|
+                                          QFile::ExeOwner ) &lt;&lt;endl;
         if ( extLogin )
             extTimer-&gt;stop();
         return;
@@ -7100,7 +7102,7 @@ void ONMainWindow::slotExtTimer()
     QString logoutDir;
     QDir dir ( readLoginsFrom );
     QStringList list = dir.entryList ( QDir::Files );
-    for ( int i=0;i&lt;list.size();++i )
+    for ( int i=0; i&lt;list.size(); ++i )
     {
         QFile file ( readLoginsFrom+&quot;/&quot;+list[i] );
         if ( !file.open ( QIODevice::ReadOnly | QIODevice::Text ) )
@@ -7122,8 +7124,8 @@ void ONMainWindow::slotExtTimer()
                 if ( args[0]==&quot;logout&quot; )
                 {
                     x2goDebug &lt;&lt;
-                    &quot; I HAVE external logout&quot;&lt;&lt;
-                    endl;
+                              &quot; I HAVE external logout&quot;&lt;&lt;
+                              endl;
                     args[1].replace ( &quot;\n&quot;,&quot;&quot; );
                     if ( args[1].size() )
                         logoutDir=args[1];
@@ -7161,13 +7163,13 @@ void ONMainWindow::slotExportTimer()
             QFile::ReadOwner|QFile::WriteOwner|QFile::ExeOwner ) )
     {
         x2goDebug &lt;&lt;&quot;Wrong permissions on &quot;&lt;&lt;
-        readExportsFrom &lt;&lt;&quot;:&quot;&lt;&lt;endl;
+                  readExportsFrom &lt;&lt;&quot;:&quot;&lt;&lt;endl;
         x2goDebug &lt;&lt; ( int ) ( QFile::permissions (
                                    readExportsFrom+&quot;/.&quot; ) )
-        &lt;&lt;&quot;must be&quot;&lt;&lt; ( int ) ( QFile::ReadUser|QFile::WriteUser
-                                |QFile::ExeUser|QFile::ReadOwner|
-                                QFile::WriteOwner|
-                                QFile::ExeOwner ) &lt;&lt;endl;
+                  &lt;&lt;&quot;must be&quot;&lt;&lt; ( int ) ( QFile::ReadUser|QFile::WriteUser
+                                          |QFile::ExeUser|QFile::ReadOwner|
+                                          QFile::WriteOwner|
+                                          QFile::ExeOwner ) &lt;&lt;endl;
         exportTimer-&gt;stop();
         return;
     }
@@ -7178,7 +7180,7 @@ void ONMainWindow::slotExportTimer()
     QString unexpList;
     QString loginDir;
     QString logoutDir;
-    for ( int i=0;i&lt;list.size();++i )
+    for ( int i=0; i&lt;list.size(); ++i )
     {
         QFile file ( readExportsFrom+&quot;/&quot;+list[i] );
         if ( !file.open ( QIODevice::ReadOnly | QIODevice::Text ) )
@@ -7222,7 +7224,7 @@ void ONMainWindow::slotExportTimer()
     QString host=resumingSession.server;
     QString sessionId=resumingSession.sessionId;
 
-    for ( int i=0;i&lt;args.size();++i )
+    for ( int i=0; i&lt;args.size(); ++i )
     {
         SshProcess* sproc=new SshProcess (
             sshConnection, this );
@@ -7328,7 +7330,7 @@ void ONMainWindow::slotRereadUsers()
     list&lt;LDAPBinEntry&gt;::iterator it=result.begin();
     list&lt;LDAPBinEntry&gt;::iterator end=result.end();
 
-    for ( ;it!=end;++it )
+    for ( ; it!=end; ++it )
     {
         user u;
         QString uin=LDAPSession::getBinAttrValues (
@@ -7352,9 +7354,9 @@ void ONMainWindow::slotRereadUsers()
 void ONMainWindow::reloadUsers()
 {
     int i;
-    for ( i=0;i&lt;names.size();++i )
+    for ( i=0; i&lt;names.size(); ++i )
         names[i]-&gt;close();
-    for ( i=0;i&lt;sessions.size();++i )
+    for ( i=0; i&lt;sessions.size(); ++i )
         sessions[i]-&gt;close();
 
     userList.clear();
@@ -7382,7 +7384,7 @@ void ONMainWindow::reloadUsers()
 
 bool ONMainWindow::findInList ( const QString&amp; uid )
 {
-    for ( int i=0;i&lt;userList.size();++i )
+    for ( int i=0; i&lt;userList.size(); ++i )
     {
         if ( userList[i].uid==uid )
             return true;
@@ -7404,7 +7406,7 @@ void ONMainWindow::setUsersEnabled ( bool enable )
         QList&lt;UserButton*&gt;::iterator endit=names.end();
         if ( !enable )
         {
-            for ( it=names.begin();it!=endit;it++ )
+            for ( it=names.begin(); it!=endit; it++ )
             {
                 QPoint pos= ( *it )-&gt;pos();
                 if ( ( pos.y() &gt;upos-height ) &amp;&amp;
@@ -7416,7 +7418,7 @@ void ONMainWindow::setUsersEnabled ( bool enable )
         }
         else
         {
-            for ( it=names.begin();it!=endit;it++ )
+            for ( it=names.begin(); it!=endit; it++ )
             {
                 if ( ! ( *it )-&gt;isEnabled() )
                     ( *it )-&gt;setEnabled ( true );
@@ -7561,7 +7563,7 @@ void ONMainWindow::slotGpgFinished ( int exitCode,
                                      QProcess::ExitStatus exitStatus )
 {
     x2goDebug&lt;&lt;&quot;gpg finished, exit code:&quot;&lt;&lt;exitCode&lt;&lt;&quot; exit status:&quot;&lt;&lt;
-    exitStatus&lt;&lt;endl;
+             exitStatus&lt;&lt;endl;
     if ( exitStatus==0 )
     {
         QString stdOut ( gpg-&gt;readAllStandardOutput() );
@@ -7571,7 +7573,7 @@ void ONMainWindow::slotGpgFinished ( int exitCode,
         QString login;
         QString appId;
         QString authKey;
-        for ( int i=0;i&lt;lines.count();++i )
+        for ( int i=0; i&lt;lines.count(); ++i )
         {
             if ( lines[i].indexOf ( &quot;Application ID&quot; ) !=-1 )
             {
@@ -7634,8 +7636,8 @@ void ONMainWindow::startGPGAgent ( const QString&amp; login, const QString&amp; appId )
     }
     QTextStream out ( &amp;file );
     out &lt;&lt; &quot;#!/bin/bash\n\n&quot;
-    &quot;if [ \&quot;$6\&quot; != \&quot;0x0002\&quot; ] &amp;&amp; [ \&quot;$6\&quot; != &quot;
-    &quot;\&quot;0x0007\&quot; ]\n\
+        &quot;if [ \&quot;$6\&quot; != \&quot;0x0002\&quot; ] &amp;&amp; [ \&quot;$6\&quot; != &quot;
+        &quot;\&quot;0x0007\&quot; ]\n\
 	then\n\
 	kill -9 $_assuan_pipe_connect_pid\n\
 	fi&quot;&lt;&lt;endl;
@@ -7648,7 +7650,7 @@ void ONMainWindow::startGPGAgent ( const QString&amp; login, const QString&amp; appId )
     gpgAgent=new QProcess ( this );
     QStringList arguments;
     arguments&lt;&lt;&quot;--pinentry-program&quot;&lt;&lt;&quot;/usr/bin/pinentry-x2go&quot;&lt;&lt;
-    &quot;--enable-ssh-support&quot;&lt;&lt;&quot;--daemon&quot;&lt;&lt;&quot;--no-detach&quot;;
+             &quot;--enable-ssh-support&quot;&lt;&lt;&quot;--daemon&quot;&lt;&lt;&quot;--no-detach&quot;;
 
     connect ( gpgAgent,SIGNAL ( finished ( int,QProcess::ExitStatus ) ),
               this,
@@ -8092,7 +8094,7 @@ int ONMainWindow::startSshFsTunnel()
 {
     fsTunReady=false;
     x2goDebug&lt;&lt;&quot;starting fs tunnel for:&quot;&lt;&lt;resumingSession.sessionId&lt;&lt;
-    &quot;\nfs port: &quot;&lt;&lt;resumingSession.fsPort;
+             &quot;\nfs port: &quot;&lt;&lt;resumingSession.fsPort;
 
     if ( resumingSession.fsPort.length() &lt;=0 )
     {
@@ -8113,7 +8115,7 @@ int ONMainWindow::startSshFsTunnel()
     connect ( fsTunnel,SIGNAL ( sshFinished ( bool,
                                 QString,SshProcess* ) ),
               this,SLOT ( slotFsTunnelFailed ( bool,
-                                               QString,SshProcess* ) ) );
+                          QString,SshProcess* ) ) );
 
     connect ( fsTunnel,SIGNAL ( sshTunnelOk() ),
               this,SLOT ( slotFsTunnelOk() ) );
@@ -8212,7 +8214,7 @@ void ONMainWindow::startX2goMount()
 
     QString cuser;
 #ifndef Q_WS_HILDON
-    for ( int i=0;i&lt;env.size();++i )
+    for ( int i=0; i&lt;env.size(); ++i )
     {
         QStringList ls=env[i].split ( &quot;=&quot; );
         if ( ls[0]==&quot;USER&quot; )
@@ -8299,7 +8301,7 @@ void ONMainWindow::startX2goMount()
 
     connect ( proc,SIGNAL ( sshFinished ( bool, QString,SshProcess* ) ),
               this,SLOT ( slotRetExportDir ( bool,
-                                             QString,SshProcess* ) ) );
+                          QString,SshProcess* ) ) );
 
     proc-&gt;startNormal ( cmd );
 }
@@ -8308,7 +8310,7 @@ void ONMainWindow::slotCheckPrintSpool()
 {
     QDir dir ( spoolDir );
     QStringList list = dir.entryList ( QDir::Files );
-    for ( int i=0;i&lt;list.size();++i )
+    for ( int i=0; i&lt;list.size(); ++i )
     {
         if ( !list[i].endsWith ( &quot;.ready&quot; ) )
             continue;
@@ -8344,7 +8346,7 @@ void ONMainWindow::cleanPrintSpool()
 {
     QDir dir ( spoolDir );
     QStringList list = dir.entryList ( QDir::Files );
-    for ( int i=0;i&lt;list.size();++i )
+    for ( int i=0; i&lt;list.size(); ++i )
     {
         QFile::remove ( spoolDir+&quot;/&quot;+list[i] );
     }
@@ -8356,7 +8358,7 @@ void ONMainWindow::cleanAskPass()
     QString path=homeDir +&quot;/.x2go/ssh/&quot;;
     QDir dir ( path );
     QStringList list = dir.entryList ( QDir::Files );
-    for ( int i=0;i&lt;list.size();++i )
+    for ( int i=0; i&lt;list.size(); ++i )
     {
         if ( list[i].startsWith ( &quot;askpass&quot; ) )
             QFile::remove ( path+list[i] );
@@ -8541,7 +8543,7 @@ void ONMainWindow::startXOrg ()
         xorgLogMutex.unlock();
 //run xming with clipboard support
         args&lt;&lt;dispString&lt;&lt;&quot;-multiwindow&quot;&lt;&lt;&quot;-notrayicon&quot;&lt;&lt;&quot;-clipboard&quot;&lt;&lt;
-        &quot;-logfile&quot;&lt;&lt;xorgLogFile;
+            &quot;-logfile&quot;&lt;&lt;xorgLogFile;
         xorg-&gt;setEnvironment ( env );
         xorg-&gt; setWorkingDirectory ( workingDir);
     }
@@ -8595,7 +8597,7 @@ void ONMainWindow::slotCheckXOrgConnection()
 }
 
 WinServerStarter::WinServerStarter ( daemon server, ONMainWindow * par ) :
-        QThread ( 0 )
+    QThread ( 0 )
 {
     mode=server;
     parent=par;
@@ -8611,9 +8613,6 @@ void WinServerStarter::run()
     case X:
         parent-&gt;startXOrg();
         break;
-    case PULSE:
-        parent-&gt;startPulsed();
-        break;
     }
 }
 
@@ -8633,8 +8632,7 @@ void ONMainWindow::startWinServers()
     WinServerStarter* sshStarter = new WinServerStarter (
         WinServerStarter::SSH, this );
 
-    WinServerStarter* pulseStarter = new WinServerStarter (
-        WinServerStarter::PULSE, this );
+
 
     if ( !embedMode || !config.confFS || ( config.confFS &amp;&amp; config.useFs ) )
     {
@@ -8647,7 +8645,7 @@ void ONMainWindow::startWinServers()
     if ( !embedMode || !config.confSnd ||
             ( config.confSnd &amp;&amp; config.useSnd ) )
     {
-        pulseStarter-&gt;start();
+        startPulsed();
     }
 // #ifdef CFGCLIENT
 //     x2goDebug&lt;&lt;&quot;xorg settings: &quot;&lt;&lt;startXorgOnStart &lt;&lt;&quot; &quot;&lt;&lt; useXming&lt;&lt;endl;
@@ -8872,7 +8870,7 @@ void ONMainWindow::startPulsed()
     dr.mkpath ( pulseDir );
     x2goDebug&lt;&lt;&quot;pulse tmp file: &quot;&lt;&lt;pulseDir&lt;&lt;endl;
     QStringList pEnv=QProcess::systemEnvironment();
-    for ( int i=0; i&lt;pEnv.size();++i )
+    for ( int i=0; i&lt;pEnv.size(); ++i )
     {
         if ( pEnv[i].indexOf ( &quot;USERPROFILE=&quot; ) !=-1 )
             pEnv[i]=&quot;USERPROFILE=&quot;+
@@ -8888,14 +8886,14 @@ void ONMainWindow::startPulsed()
         return;
     QTextStream out ( &amp;file );
     out &lt;&lt; &quot;load-module module-native-protocol-tcp port=&quot;+
-    QString::number ( pulsePort ) &lt;&lt;endl;
+        QString::number ( pulsePort ) &lt;&lt;endl;
     out &lt;&lt; &quot;load-module module-esound-protocol-tcp port=&quot;+
-    QString::number ( esdPort ) &lt;&lt;endl;
+        QString::number ( esdPort ) &lt;&lt;endl;
     out &lt;&lt; &quot;load-module module-waveout&quot;&lt;&lt;endl;
     file.close();
     pulseServer=new QProcess ( 0 );
     pulseServer-&gt;setEnvironment ( pEnv );
-    QStringList args;
+    pulseArgs.clear();
 #ifdef Q_OS_WIN
     QDir drr(homeDir+&quot;/.x2go/pulse/.pulse/&quot;+QHostInfo::localHostName ()+&quot;-runtime&quot;);
     if (!drr.exists())
@@ -8903,16 +8901,30 @@ void ONMainWindow::startPulsed()
     if (QFile::exists(homeDir+&quot;/.x2go/pulse/.pulse/&quot;+QHostInfo::localHostName ()+&quot;-runtime/pid&quot;))
         QFile::remove(homeDir+&quot;/.x2go/pulse/.pulse/&quot;+QHostInfo::localHostName ()+&quot;-runtime/pid&quot;);
     pulseDir.replace(&quot;/&quot;,&quot;\\&quot;);
-    args&lt;&lt;&quot;--exit-idle-time=-1&quot;&lt;&lt;&quot;-n&quot;&lt;&lt;&quot;-F&quot;&lt;&lt;pulseDir+&quot;\\config.pa&quot;;
+    pulseArgs&lt;&lt;&quot;--exit-idle-time=-1&quot;&lt;&lt;&quot;-n&quot;&lt;&lt;&quot;-F&quot;&lt;&lt;pulseDir+&quot;\\config.pa&quot;;
 #else
-    args&lt;&lt;&quot;--exit-idle-time=-1&quot;&lt;&lt;&quot;-n&quot;&lt;&lt;&quot;-F&quot;&lt;&lt;pulseDir+&quot;/config.pa&quot;;
+    pulseArgs&lt;&lt;&quot;--exit-idle-time=-1&quot;&lt;&lt;&quot;-n&quot;&lt;&lt;&quot;-F&quot;&lt;&lt;pulseDir+&quot;/config.pa&quot;;
 #endif
     pulseServer-&gt;setWorkingDirectory ( wapiShortFileName (
                                            appDir+&quot;\\pulse&quot; ) );
-    pulseServer-&gt;start ( &quot;pulse\\pulseaudio.exe&quot;,args );
-    x2goDebug&lt;&lt;&quot;starting pulse\\pulseaudio.exe &quot;&lt;&lt;args.join ( &quot; &quot; ) &lt;&lt;
-    &quot; working dir: &quot;&lt;&lt;
-    wapiShortFileName ( appDir+&quot;\\pulse&quot; ) &lt;&lt;endl;
+    pulseServer-&gt;start ( &quot;pulse\\pulseaudio.exe&quot;,pulseArgs );
+    x2goDebug&lt;&lt;&quot;starting pulse\\pulseaudio.exe &quot;&lt;&lt;pulseArgs.join ( &quot; &quot; ) &lt;&lt;
+             &quot; working dir: &quot;&lt;&lt;
+             wapiShortFileName ( appDir+&quot;\\pulse&quot; ) &lt;&lt;endl;
+    pulseTimer=new QTimer(this);
+    x2goDebug&lt;&lt;&quot;connect timer&quot;;
+    connect (pulseTimer, SIGNAL(timeout()), this, SLOT(slotCheckPulse()));
+    pulseTimer-&gt;start(2000);
+}
+
+void ONMainWindow::slotCheckPulse()
+{
+    //restart pulse server
+    if(pulseServer-&gt;state()!=QProcess::Running)
+    {
+        pulseServer-&gt;start ( &quot;pulse\\pulseaudio.exe&quot;,pulseArgs );
+        x2goDebug&lt;&lt;&quot;restarting pulse\\pulseaudio.exe &quot;&lt;&lt;pulseArgs.join ( &quot; &quot; );
+    }
 }
 
 
@@ -8991,8 +9003,8 @@ void ONMainWindow::generateEtcFiles()
             return;
         QTextStream out ( &amp;file );
         out &lt;&lt;&quot;sshuser::&quot;&lt;&lt;rid&lt;&lt;&quot;:&quot;&lt;&lt;grid&lt;&lt;&quot;:&quot;&lt;&lt;sys&lt;&lt;&quot;\\sshuser,&quot;
-        &lt;&lt;sid&lt;&lt;&quot;:&quot;&lt;&lt;cygwinPath ( wapiShortFileName ( homeDir ) ) &lt;&lt;
-        &quot;/.x2go&quot;&lt;&lt;&quot;:/bin/bash\n&quot;;
+            &lt;&lt;sid&lt;&lt;&quot;:&quot;&lt;&lt;cygwinPath ( wapiShortFileName ( homeDir ) ) &lt;&lt;
+            &quot;/.x2go&quot;&lt;&lt;&quot;:/bin/bash\n&quot;;
         file.close();
     }
 
@@ -9004,12 +9016,12 @@ void ONMainWindow::generateEtcFiles()
             return;
         QTextStream out ( &amp;file );
         out&lt;&lt;&quot;StrictModes no\n&quot;&lt;&lt;
-        &quot;UsePrivilegeSeparation no\n&quot;&lt;&lt;
+           &quot;UsePrivilegeSeparation no\n&quot;&lt;&lt;
 #ifdef Q_OS_WIN
-        &quot;Subsystem sftp /bin/sftp-server\n&quot;;
+           &quot;Subsystem sftp /bin/sftp-server\n&quot;;
 #else
-        &quot;Subsystem sftp &quot;
-        &lt;&lt;appDir&lt;&lt;&quot;/sftp-server\n&quot;;
+           &quot;Subsystem sftp &quot;
+           &lt;&lt;appDir&lt;&lt;&quot;/sftp-server\n&quot;;
 #endif
         file.close();
         x2goDebug&lt;&lt;etcDir +&quot;/sshd_config created&quot;;
@@ -9035,7 +9047,7 @@ void ONMainWindow::generateHostDsaKey()
 #endif
         QStringList args;
         args&lt;&lt;&quot;-t&quot;&lt;&lt;&quot;dsa&quot;&lt;&lt;&quot;-N&quot;&lt;&lt;&quot;&quot;&lt;&lt;&quot;-C&quot;&lt;&lt;
-        &quot;x2goclient DSA host key&quot;&lt;&lt;&quot;-f&quot;&lt;&lt;fname;
+            &quot;x2goclient DSA host key&quot;&lt;&lt;&quot;-f&quot;&lt;&lt;fname;
         QProcess::execute ( &quot;ssh-keygen&quot;,args );
     }
 }
@@ -9100,7 +9112,7 @@ void ONMainWindow::startSshd()
     sshd=new QProcess ( this );
     QStringList arguments;
     arguments&lt;&lt;&quot;-f&quot;&lt;&lt;etcDir +&quot;/sshd_config&quot;&lt;&lt; &quot;-h&quot; &lt;&lt;
-    etcDir+&quot;/ssh_host_dsa_key&quot;&lt;&lt;&quot;-D&quot;&lt;&lt;&quot;-p&quot;&lt;&lt;clientSshPort;
+             etcDir+&quot;/ssh_host_dsa_key&quot;&lt;&lt;&quot;-D&quot;&lt;&lt;&quot;-p&quot;&lt;&lt;clientSshPort;
     sshd-&gt;start ( appDir+&quot;/sshd&quot;,arguments );
     x2goDebug&lt;&lt;&quot;Usermode sshd started&quot;;
 #endif
@@ -9257,7 +9269,7 @@ void ONMainWindow::slotConfigXinerama()
     x2goDebug&lt;&lt;&quot;New proxy geometry: &quot;&lt;&lt;lastDisplayGeometry&lt;&lt;endl;
     QDesktopWidget* root=QApplication::desktop();
     QList&lt;QRect&gt; newXineramaScreens;
-    for (int i=0; i&lt; root-&gt;numScreens();++i)
+    for (int i=0; i&lt; root-&gt;numScreens(); ++i)
     {
         QRect intersection;
         if (resumingSession.fullscreen)
@@ -9283,7 +9295,7 @@ void ONMainWindow::slotConfigXinerama()
         QStringList screens;
         foreach (QRect disp, xineramaScreens)
         screens&lt;&lt;QString::number(disp.x())+&quot; &quot;+QString::number(disp.y())+&quot; &quot;+QString::number(disp.width())+
-        &quot; &quot;+QString::number(disp.height());
+               &quot; &quot;+QString::number(disp.height());
         QString cmd=&quot;export DISPLAY=:&quot;+resumingSession.display+&quot;;echo -e &quot;+screens.join(&quot;\\\\n&quot;)+&quot; &gt;  ~/.x2go/C-&quot;+
                     resumingSession.sessionId+&quot;/xinerama.conf&quot;;
 
@@ -9319,7 +9331,7 @@ void ONMainWindow::slotXineramaConfigured()
 void ONMainWindow::slotFindProxyWin()
 {
 #ifndef Q_OS_DARWIN
-    x2goDebug&lt;&lt;&quot;search proxy win: &quot;&lt;&lt;&quot;X2GO-&quot;+resumingSession.sessionId;
+//     x2goDebug&lt;&lt;&quot;search proxy win: &quot;&lt;&lt;&quot;X2GO-&quot;+resumingSession.sessionId;
     proxyWinId=findWindow ( &quot;X2GO-&quot;+resumingSession.sessionId );
     bool xinerama=defaultXinerama;
     if ( proxyWinId )
@@ -9531,7 +9543,7 @@ void ONMainWindow::processSessionConfig()
     QStringList lines=m_x2goconfig.split ( &quot;\n&quot; );
 
 
-    for ( int i=0;i&lt;lines.count();++i )
+    for ( int i=0; i&lt;lines.count(); ++i )
     {
         QString line = lines[i];
         if ( ( line==&quot;-----BEGIN DSA PRIVATE KEY-----&quot; ) ||
@@ -10449,8 +10461,8 @@ void ONMainWindow::slotSndTunOk()
 
 
 void ONMainWindow::slotPCookieReady (	bool result,
-                                      QString ,
-                                      SshProcess* )
+                                        QString ,
+                                        SshProcess* )
 {
     if ( result )
         slotStartParec();
@@ -10604,7 +10616,7 @@ void ONMainWindow::filterDesktops ( const QString&amp; filter, bool strict )
             modelDesktop-&gt;setItem ( nextRow,D_USER,item );
             item= new QStandardItem ( desktop[1] );
             modelDesktop-&gt;setItem ( nextRow++,D_DISPLAY,item );
-            for ( int j=0;j&lt;2;++j )
+            for ( int j=0; j&lt;2; ++j )
             {
                 QString txt=
                     modelDesktop-&gt;index (
@@ -10708,7 +10720,7 @@ QString ONMainWindow::u3DataPath()
 {
     QStringList env=QProcess::systemEnvironment();
     QString dpath;
-    for ( int i=0;i&lt;env.size();++i )
+    for ( int i=0; i&lt;env.size(); ++i )
     {
 // 		x2goDebug &lt;&lt; env[i];
         //check if we have U3 System
@@ -10749,7 +10761,7 @@ void ONMainWindow::removeDir ( QString path )
     x2goDebug&lt;&lt;&quot;entering &quot; &lt;&lt;path;
     QDir dr ( path );
     QStringList files=dr.entryList ( QDir::Files );
-    for ( int i=0;i&lt;files.size();++i )
+    for ( int i=0; i&lt;files.size(); ++i )
     {
         if ( files[i]!=&quot;known_hosts&quot; || cleanAllFiles)
         {
@@ -10758,7 +10770,7 @@ void ONMainWindow::removeDir ( QString path )
         }
     }
     QStringList dirs=dr.entryList ( QDir::AllDirs|QDir::NoDotAndDotDot );
-    for ( int i=0;i&lt;dirs.size();++i )
+    for ( int i=0; i&lt;dirs.size(); ++i )
     {
         removeDir ( path+&quot;/&quot;+dirs[i] );
     }
@@ -10779,7 +10791,7 @@ long ONMainWindow::X11FindWindow ( QString text, long rootWin )
     if ( XQueryTree ( QX11Info::display(),rootWin,&amp;wRoot,&amp;wParent,
                       &amp;child_list,&amp;nChildren ) )
     {
-        for ( uint i=0;i&lt;nChildren;++i )
+        for ( uint i=0; i&lt;nChildren; ++i )
         {
             char *wname;
             if ( XFetchName ( QX11Info::display(),
diff --git a/onmainwindow.h b/onmainwindow.h
index f3969d5..9fd3527 100644
--- a/onmainwindow.h
+++ b/onmainwindow.h
@@ -716,6 +716,8 @@ private:
     static QString u3Device;
 
     QProcess* pulseServer;
+    QStringList pulseArgs;
+    QTimer* pulseTimer;
     int xDisplay;
     int sshdPort;
     bool winServersReady;
@@ -859,6 +861,7 @@ private slots:
     void startWinServers();
     void slotCheckXOrgLog();
     void slotCheckXOrgConnection();
+    void slotCheckPulse();
 #endif
 private slots:
     void slotAppDialog();


hooks/post-receive
-- 
x2goclient.git (X2Go Client)

This is an automated email from the git hooks/post-receive script. It was
generated because a ref change was pushed to the repository containing
the project &quot;x2goclient.git&quot; (X2Go Client).

</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="003139.html">[X2go-Commits] x2goclient.git - master (branch) updated:	3.99.2.2-27-g77e1eb7
</A></li>
	<LI>Next message: <A HREF="003141.html">[X2go-Commits] x2gothinclient.git - master (branch) updated:	1.0.1.8-33-gcacfdec
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3140">[ date ]</a>
              <a href="thread.html#3140">[ thread ]</a>
              <a href="subject.html#3140">[ subject ]</a>
              <a href="author.html#3140">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/x2go-commits">More information about the X2go-commits
mailing list</a><br>
</body></html>
