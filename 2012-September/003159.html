<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [X2go-Commits] pyhoca-gui.git - master (branch) updated:	0.2.0.4-9-g46be5e3
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/x2go-commits/2012-September/index.html" >
   <LINK REL="made" HREF="mailto:x2go-commits%40lists.berlios.de?Subject=Re%3A%20%5BX2go-Commits%5D%20pyhoca-gui.git%20-%20master%20%28branch%29%20updated%3A%0A%090.2.0.4-9-g46be5e3&In-Reply-To=%3C20120914070317.5AD5C5DB70%40ymir%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="003158.html">
   <LINK REL="Next"  HREF="003160.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[X2go-Commits] pyhoca-gui.git - master (branch) updated:	0.2.0.4-9-g46be5e3</H1>
    <B>X2Go dev team</B> 
    <A HREF="mailto:x2go-commits%40lists.berlios.de?Subject=Re%3A%20%5BX2go-Commits%5D%20pyhoca-gui.git%20-%20master%20%28branch%29%20updated%3A%0A%090.2.0.4-9-g46be5e3&In-Reply-To=%3C20120914070317.5AD5C5DB70%40ymir%3E"
       TITLE="[X2go-Commits] pyhoca-gui.git - master (branch) updated:	0.2.0.4-9-g46be5e3">git-admin at x2go.org
       </A><BR>
    <I>Fri Sep 14 09:03:17 CEST 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="003158.html">[X2go-Commits] x2goclient.git - master (branch) updated:	3.99.2.2-37-gdcdb037
</A></li>
        <LI>Next message: <A HREF="003160.html">[X2go-Commits] python-x2go.git - master (branch) updated:	0.2.0.9-8-gf60c4d3
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3159">[ date ]</a>
              <a href="thread.html#3159">[ thread ]</a>
              <a href="subject.html#3159">[ subject ]</a>
              <a href="author.html#3159">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>The branch, master has been updated
       via  46be5e3b5b1f56c6c3084bccc5e36e6eb81b574b (commit)
       via  794df417583d5de50cb34ebedb922fe16aa0d423 (commit)
       via  7b18f2d1e27306b0cea947cfb88eedce4cb56bd2 (commit)
      from  804944e3c211b676a3e08c668cba238d4e3b238a (commit)

Those revisions listed above that are new to this repository have
not appeared on any other notification email; so we list those
revisions in full, below.

- Log -----------------------------------------------------------------
commit 46be5e3b5b1f56c6c3084bccc5e36e6eb81b574b
Author: Mike Gabriel &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/x2go-commits">mike.gabriel at das-netzwerkteam.de</A>&gt;
Date:   Fri Sep 14 09:02:48 2012 +0200

    Make session icon handling more robust, be more compatible with X2Go Client about the session icon name. Rewrite mistakes pyhoca-gui &lt;= 0.2.0.4 did on the icon attribute in the session profile config.

commit 794df417583d5de50cb34ebedb922fe16aa0d423
Author: Mike Gabriel &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/x2go-commits">mike.gabriel at das-netzwerkteam.de</A>&gt;
Date:   Thu Sep 13 21:44:08 2012 +0200

    Make sure RDP (X2Go-proxy) sessions stored by PyHoca-GUI get recognized as such by X2goClient.

commit 7b18f2d1e27306b0cea947cfb88eedce4cb56bd2
Author: Mike Gabriel &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/x2go-commits">mike.gabriel at das-netzwerkteam.de</A>&gt;
Date:   Thu Sep 13 21:25:09 2012 +0200

    Session profile file option ,,export'': stay empty if no exports are definded.

-----------------------------------------------------------------------

Summary of changes:
 debian/changelog               |    8 ++++++-
 po/PyHoca-GUI.pot              |   38 ++++++++++++++++++------------------
 pyhoca/wxgui/profilemanager.py |   41 ++++++++++++++++++++++++++-------------
 3 files changed, 53 insertions(+), 34 deletions(-)

The diff of changes is:
diff --git a/debian/changelog b/debian/changelog
index 666b16f..e8f019e 100644
--- a/debian/changelog
+++ b/debian/changelog
@@ -2,7 +2,13 @@ pyhoca-gui (0.2.0.5-0~x2go1) UNRELEASED; urgency=low
 
   [ Mike Gabriel ]
   * New upstream version (0.2.0.5):
-    - Continue development...
+    - Session profile file option ,,export'': stay empty if no exports are
+      definded.
+    - Make sure RDP (X2Go-proxy) sessions stored by PyHoca-GUI get recognized
+      as such by X2goClient.
+    - Make session icon handling more robust, be more compatible with X2Go Client
+      about the session icon name. Rewrite mistakes pyhoca-gui &lt;= 0.2.0.4 did
+      on the icon attribute in the session profile config.
   * /debian/control:
     + Add Oleksandr Shneyder to Uploaders.
 
diff --git a/po/PyHoca-GUI.pot b/po/PyHoca-GUI.pot
index 96396f3..1bf667b 100644
--- a/po/PyHoca-GUI.pot
+++ b/po/PyHoca-GUI.pot
@@ -8,7 +8,7 @@ msgid &quot;&quot;
 msgstr &quot;&quot;
 &quot;Project-Id-Version: PACKAGE VERSION\n&quot;
 &quot;Report-Msgid-Bugs-To: \n&quot;
-&quot;POT-Creation-Date: 2012-06-10 21:18+0200\n&quot;
+&quot;POT-Creation-Date: 2012-09-05 12:22+0200\n&quot;
 &quot;PO-Revision-Date: YEAR-MO-DA HO:MI+ZONE\n&quot;
 &quot;Last-Translator: FULL NAME &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/x2go-commits">EMAIL at ADDRESS</A>&gt;\n&quot;
 &quot;Language-Team: LANGUAGE &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/x2go-commits">LL at li.org</A>&gt;\n&quot;
@@ -548,7 +548,7 @@ msgstr &quot;&quot;
 
 #: ../pyhoca/wxgui/profilemanager.py:365
 #: ../pyhoca/wxgui/profilemanager.py:1078
-#: ../pyhoca/wxgui/profilemanager.py:1832
+#: ../pyhoca/wxgui/profilemanager.py:1829
 msgid &quot;automatically&quot;
 msgstr &quot;&quot;
 
@@ -603,50 +603,50 @@ msgstr &quot;&quot;
 msgid &quot;&lt;xkbvariant&gt;&quot;
 msgstr &quot;&quot;
 
-#: ../pyhoca/wxgui/profilemanager.py:1284
+#: ../pyhoca/wxgui/profilemanager.py:1281
 msgid &quot;Icon Files (*.png)|*.png|All files (*.*)|*&quot;
 msgstr &quot;&quot;
 
-#: ../pyhoca/wxgui/profilemanager.py:1287
+#: ../pyhoca/wxgui/profilemanager.py:1284
 msgid &quot;Choose an icon for this session profile&quot;
 msgstr &quot;&quot;
 
-#: ../pyhoca/wxgui/profilemanager.py:1509
+#: ../pyhoca/wxgui/profilemanager.py:1506
 msgid &quot;All files (*.*)|*&quot;
 msgstr &quot;&quot;
 
-#: ../pyhoca/wxgui/profilemanager.py:1511
-#: ../pyhoca/wxgui/profilemanager.py:1533
+#: ../pyhoca/wxgui/profilemanager.py:1508
+#: ../pyhoca/wxgui/profilemanager.py:1530
 msgid &quot;Choose a public SSH key&quot;
 msgstr &quot;&quot;
 
-#: ../pyhoca/wxgui/profilemanager.py:1784
+#: ../pyhoca/wxgui/profilemanager.py:1781
 msgid &quot;Choose a folder to share within a session&quot;
 msgstr &quot;&quot;
 
+#: ../pyhoca/wxgui/profilemanager.py:1909
 #: ../pyhoca/wxgui/profilemanager.py:1912
 #: ../pyhoca/wxgui/profilemanager.py:1915
-#: ../pyhoca/wxgui/profilemanager.py:1918
-#: ../pyhoca/wxgui/profilemanager.py:1923
-#: ../pyhoca/wxgui/profilemanager.py:1933 ../pyhoca/wxgui/menus_taskbar.py:118
+#: ../pyhoca/wxgui/profilemanager.py:1920
+#: ../pyhoca/wxgui/profilemanager.py:1930 ../pyhoca/wxgui/menus_taskbar.py:118
 msgid &quot;Profile Manager&quot;
 msgstr &quot;&quot;
 
-#: ../pyhoca/wxgui/profilemanager.py:1912
+#: ../pyhoca/wxgui/profilemanager.py:1909
 msgid &quot;Profile name is missing, profile unusable!!!&quot;
 msgstr &quot;&quot;
 
+#: ../pyhoca/wxgui/profilemanager.py:1912
 #: ../pyhoca/wxgui/profilemanager.py:1915
-#: ../pyhoca/wxgui/profilemanager.py:1918
 #, python-format
 msgid &quot;Profile name %s already exists!!!&quot;
 msgstr &quot;&quot;
 
-#: ../pyhoca/wxgui/profilemanager.py:1923
+#: ../pyhoca/wxgui/profilemanager.py:1920
 msgid &quot;The SSH proxy configuration is incomplete. Try again.&quot;
 msgstr &quot;&quot;
 
-#: ../pyhoca/wxgui/profilemanager.py:1933
+#: ../pyhoca/wxgui/profilemanager.py:1930
 #, python-format
 msgid &quot;&quot;
 &quot;Another session profile (%s) already uses [%s]:%s for binding a local SSH &quot;
@@ -654,21 +654,21 @@ msgid &quot;&quot;
 &quot;Please change the SSH proxy settings accordingly.&quot;
 msgstr &quot;&quot;
 
-#: ../pyhoca/wxgui/profilemanager.py:1960
+#: ../pyhoca/wxgui/profilemanager.py:1957
 #, python-format
 msgid &quot;%s - profile added&quot;
 msgstr &quot;&quot;
 
-#: ../pyhoca/wxgui/profilemanager.py:1961
+#: ../pyhoca/wxgui/profilemanager.py:1958
 msgid &quot;A new session profile has been added.&quot;
 msgstr &quot;&quot;
 
-#: ../pyhoca/wxgui/profilemanager.py:1965
+#: ../pyhoca/wxgui/profilemanager.py:1962
 #, python-format
 msgid &quot;%s - modified&quot;
 msgstr &quot;&quot;
 
-#: ../pyhoca/wxgui/profilemanager.py:1966
+#: ../pyhoca/wxgui/profilemanager.py:1963
 msgid &quot;Changes to profile have been saved.&quot;
 msgstr &quot;&quot;
 
diff --git a/pyhoca/wxgui/profilemanager.py b/pyhoca/wxgui/profilemanager.py
index 2ff1987..2349547 100644
--- a/pyhoca/wxgui/profilemanager.py
+++ b/pyhoca/wxgui/profilemanager.py
@@ -184,13 +184,22 @@ class PyHocaGUI_ProfileManager(wx.Dialog):
         self.UseDefaultSessionWindowTitle = wx.CheckBox(self.tab_Profile, -1, _(u&quot;Use a default session window title&quot;))
         self.CustomSessionWindowTitleLabel = wx.StaticText(self.tab_Profile, -1, _(u&quot;Custom session window title&quot;) + &quot;:&quot;)
         self.CustomSessionWindowTitle = wx.TextCtrl(self.tab_Profile, -1, &quot;&quot;)
-        _share_location = os.path.split(_icons_location)[0]
-        if 'icon' in self.profile_config:
-            path_to_icon = self.profile_config['icon']
-            path_to_icon = path_to_icon.lstrip(':')
-            path_to_icon = os.path.join(os.path.normpath(_share_location), os.path.normpath(path_to_icon))
-        if not os.path.exists(path_to_icon) or not 'icon' in self.profile_config:
-            path_to_icon = os.path.normpath('%s/icons/PyHoca/128x128/pyhoca-session.png' % _share_location)
+        path_to_icon = os.path.normpath('%s/PyHoca/128x128/pyhoca-session.png' % _icons_location)
+        self.default_icon = True
+        if 'icon' in self.profile_config and self.profile_config['icon'] == ':icons/128x128/x2gosession.png':
+            # interpret the default x2gosession.png icon entry in session profile config as the PyHoca icon...
+            pass
+        elif 'icon' in self.profile_config and self.profile_config['icon'] == path_to_icon:
+            # rewrite absolute path to PyHoca icon in session profile config back to the default icon path used
+            # by X2Go Client, fixes behaviour of PyHoca-GUI &lt;= 0.2.0.4.
+            pass
+        elif 'icon' in self.profile_config:
+            path_to_icon = self.profile_config['icon'].strip()
+            path_to_icon = os.path.normpath(path_to_icon)
+            self.default_icon = False
+        if not os.path.exists(path_to_icon):
+            path_to_icon = os.path.normpath('%s/PyHoca/128x128/pyhoca-session.png' % _icons_location)
+            self.default_icon = True
         self.IconPath = path_to_icon
         self.IconButtonLabel = wx.StaticText(self.tab_Profile, -1, _(u&quot;Window Icon&quot;)+':')
         self.IconButton = wx.BitmapButton(self.tab_Profile, -1, wx.Bitmap(path_to_icon, wx.BITMAP_TYPE_ANY), size=wx.Size(136,136), )
@@ -1154,7 +1163,10 @@ class PyHocaGUI_ProfileManager(wx.Dialog):
         self.profile_config['autostart'] = self.AutoStartSession.GetValue()
         self.profile_config['autologin'] = self.AutoLoginSessionProfile.GetValue()
         self.profile_config['published'] = self.UsePublishedApplications.GetValue()
-        self.profile_config['icon'] = self.IconPath
+        if not self.default_icon:
+            self.profile_config['icon'] = self.IconPath
+        else:
+            self.profile_config['icon'] = ':icons/128x128/x2gosession.png'
         self.profile_config['user'] = self.UserName.GetValue()
         self.profile_config['key'] = self.SSHKeyFile.GetValue()
         if self.UseSSHProxy.GetValue():
@@ -1184,7 +1196,7 @@ class PyHocaGUI_ProfileManager(wx.Dialog):
             self.profile_config['rootless'] = self.RootlessSession.GetValue()
         elif _session_type == 'RDP':
             _command = _session_type
-            self.profile_config['rootless'] = True
+            self.profile_config['rootless'] = False
         elif _session_type == 'PUBLISHEDAPPLICATIONS':
             _command = &quot;&quot;
             self.profile_config['rootless'] = True
@@ -1245,7 +1257,10 @@ class PyHocaGUI_ProfileManager(wx.Dialog):
 
             _item_id = self.SharedFoldersList.GetNextItem(_item_id)
 
-        self.profile_config['export'] = '&quot;%s;&quot;' % ';'.join([ f for f in _shared_folders if f ])
+        if _shared_folders:
+            self.profile_config['export'] = '&quot;%s;&quot;' % ';'.join([ f for f in _shared_folders if f ])
+        else:
+            self.profile_config['export'] = ''
         self.profile_config['useiconv'] = self.UseEncodingConverter.GetValue()
         self.profile_config['iconvfrom'] = self.ClientEncoding.GetValue()
         self.profile_config['iconvto'] = self.ServerEncoding.GetValue()
@@ -1274,7 +1289,6 @@ class PyHocaGUI_ProfileManager(wx.Dialog):
         @type event: C{obj}
 
         &quot;&quot;&quot;
-        _share_location = os.path.split(_icons_location)[0]
         iconsdir = _icons_location
         if not os.path.exists(iconsdir):
             iconsdir = os.getcwd()
@@ -1289,9 +1303,8 @@ class PyHocaGUI_ProfileManager(wx.Dialog):
             # This returns a Python list of files that were selected.
             path_to_icon = dlg.GetPath()
             self.IconButton.SetBitmapLabel(wx.Bitmap(path_to_icon, wx.BITMAP_TYPE_ANY))
-            rel_path = path_to_icon.replace('%s/' % _share_location, ':')
-            rel_path = rel_path.replace( 'icons/PyHoca/128x128/pyhoca-session.png', 'icons/128x128/x2gosession.png')
-            self.IconPath = rel_path
+            self.IconPath = path_to_icon
+            default_icon = False
 
     def OnSetSessionWindowTitle(self, event):
         &quot;&quot;&quot;\


hooks/post-receive
-- 
pyhoca-gui.git (Python X2Go Client (wxPython GUI))

This is an automated email from the git hooks/post-receive script. It was
generated because a ref change was pushed to the repository containing
the project &quot;pyhoca-gui.git&quot; (Python X2Go Client (wxPython GUI)).

</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="003158.html">[X2go-Commits] x2goclient.git - master (branch) updated:	3.99.2.2-37-gdcdb037
</A></li>
	<LI>Next message: <A HREF="003160.html">[X2go-Commits] python-x2go.git - master (branch) updated:	0.2.0.9-8-gf60c4d3
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3159">[ date ]</a>
              <a href="thread.html#3159">[ thread ]</a>
              <a href="subject.html#3159">[ subject ]</a>
              <a href="author.html#3159">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/x2go-commits">More information about the X2go-commits
mailing list</a><br>
</body></html>
