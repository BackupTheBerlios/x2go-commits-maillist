<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [X2Go-Commits] x2goserver.git - build-baikal (branch) updated:	3.0.99-2-74-gbdbf47f
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/x2go-commits/2014-January/index.html" >
   <LINK REL="made" HREF="mailto:x2go-commits%40lists.berlios.de?Subject=Re%3A%20%5BX2Go-Commits%5D%20x2goserver.git%20-%20build-baikal%20%28branch%29%20updated%3A%0A%093.0.99-2-74-gbdbf47f&In-Reply-To=%3C20140103195215.5D45A5DB2C%40ymir%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="019222.html">
   <LINK REL="Next"  HREF="019248.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[X2Go-Commits] x2goserver.git - build-baikal (branch) updated:	3.0.99-2-74-gbdbf47f</H1>
    <B>X2Go dev team</B> 
    <A HREF="mailto:x2go-commits%40lists.berlios.de?Subject=Re%3A%20%5BX2Go-Commits%5D%20x2goserver.git%20-%20build-baikal%20%28branch%29%20updated%3A%0A%093.0.99-2-74-gbdbf47f&In-Reply-To=%3C20140103195215.5D45A5DB2C%40ymir%3E"
       TITLE="[X2Go-Commits] x2goserver.git - build-baikal (branch) updated:	3.0.99-2-74-gbdbf47f">git-admin at x2go.org
       </A><BR>
    <I>Fri Jan  3 20:52:15 CET 2014</I>
    <P><UL>
        <LI>Previous message: <A HREF="019222.html">[X2Go-Commits] x2goserver.git - build-baikal (branch) updated:	3.0.99-2-79-g1f1ea43
</A></li>
        <LI>Next message: <A HREF="019248.html">[X2Go-Commits] x2goserver.git - build-baikal (branch) updated:	3.0.99-2-78-g5c60ad1
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19226">[ date ]</a>
              <a href="thread.html#19226">[ thread ]</a>
              <a href="subject.html#19226">[ subject ]</a>
              <a href="author.html#19226">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>The branch, build-baikal has been updated
       via  bdbf47f40a422883e18b49f7fa87c098219fa133 (commit)
      from  108e3eb7b165843884c9c04252b8d8f489ce4da5 (commit)

Those revisions listed above that are new to this repository have
not appeared on any other notification email; so we list those
revisions in full, below.

- Log -----------------------------------------------------------------
-----------------------------------------------------------------------

Summary of changes:
 debian/changelog                     |    1 +
 x2goserver/bin/x2gocmdexitmessage    |    1 +
 x2goserver/bin/x2golistdesktops      |   44 +-
 x2goserver/bin/x2golistsessions      |   65 ++-
 x2goserver/bin/x2gomountdirs         |  296 ++++++------
 x2goserver/bin/x2goprint             |   34 +-
 x2goserver/bin/x2goresume-session    |   18 +-
 x2goserver/bin/x2goruncommand        |  120 ++---
 x2goserver/bin/x2goshowblocks        |    6 +-
 x2goserver/bin/x2gostartagent        |  245 ++++------
 x2goserver/bin/x2goumount-session    |  140 +++---
 x2goserver/lib/x2godbwrapper.pm      |  874 +++++++++++++++++-----------------
 x2goserver/lib/x2golistsessions_root |   60 ++-
 x2goserver/lib/x2golistsessions_sql  |   18 +-
 x2goserver/lib/x2gosessionlimit      |   82 ++--
 15 files changed, 951 insertions(+), 1053 deletions(-)

The diff of changes is:
diff --git a/debian/changelog b/debian/changelog
index 718c8d3..77f3189 100644
--- a/debian/changelog
+++ b/debian/changelog
@@ -6,6 +6,7 @@ x2goserver (3.0.99.5-0~x2go3) UNRELEASED; urgency=low
   * React to bug #627990, prefer man2html-base over man2html.
   * Re-arranged script files in /bin and /lib directories, this is
     still compensated by dh_install and dh_link and needs more work.
+  * Tab'ified all script files, proper indentation, coding style.
 
   [Martin Oehler]
   * Removes old debug code fragment, fixes x2golistsessions parsing.
diff --git a/x2goserver/bin/x2gocmdexitmessage b/x2goserver/bin/x2gocmdexitmessage
index 9c5e7bd..3f8e1e7 100755
--- a/x2goserver/bin/x2gocmdexitmessage
+++ b/x2goserver/bin/x2gocmdexitmessage
@@ -23,4 +23,5 @@
 X2GO_ROOT=${HOME}/.x2go
 MESSAGE_FILE=$X2GO_ROOT/C-$1/cmdoutput
 
+# return command output of the command that was issued by x2goruncommand
 cat $MESSAGE_FILE
\ No newline at end of file
diff --git a/x2goserver/bin/x2golistdesktops b/x2goserver/bin/x2golistdesktops
index 8ba46ae..2679d6a 100755
--- a/x2goserver/bin/x2golistdesktops
+++ b/x2goserver/bin/x2golistdesktops
@@ -26,16 +26,16 @@ use Sys::Hostname;
 my $serv=shift;
 if( ! $serv)
 {
-   $serv=hostname;
+	$serv=hostname;
 }
 
 my $rsess=`x2golistsessions x2goserver |grep _stR`;
 my @rsess=split(&quot;\n&quot;,&quot;$rsess&quot;);
 my @rdisplays;
-for(my $i=0;$i&lt;@rsess;$i++)
+for (my $i=0;$i&lt;@rsess;$i++)
 {
-     my @sinfo=split(&quot;\\|&quot;<A HREF="https://lists.berlios.de/mailman/listinfo/x2go-commits">, at rsess</A>[$i]);
-     @rdisplays[$i]=@sinfo[2];
+	my @sinfo=split(&quot;\\|&quot;<A HREF="https://lists.berlios.de/mailman/listinfo/x2go-commits">, at rsess</A>[$i]);
+	@rdisplays[$i]=@sinfo[2];
 }
 
 my $rdisp=join(&quot;I&quot;<A HREF="https://lists.berlios.de/mailman/listinfo/x2go-commits">, at rdisplays</A>);
@@ -46,19 +46,19 @@ my $outp=`ls -1 /tmp/.X11-unix/`;
 my @outp=split(&quot;\n&quot;,&quot;$outp&quot;);
 for(my $i=0;$i&lt;@outp;$i++)
 {
-     my $display=@outp[$i];
-     $display=~s/X/:/;
-     my $checkdisp=$display;
-     $checkdisp=~s/:/I/;
-     $checkdisp=&quot;${checkdisp}I&quot;;
-     if (!( $rdisp =~ m/$checkdisp/ ))
-     {
-          my $inf=`xwininfo -root -display $display 2&gt; /dev/null`;
-          if ( $inf=~ m/geometry/)
-          {
-              print &quot;$uname\@$display\n&quot;;
-          }
-     }
+	my $display=@outp[$i];
+	$display=~s/X/:/;
+	my $checkdisp=$display;
+	$checkdisp=~s/:/I/;
+	$checkdisp=&quot;${checkdisp}I&quot;;
+	if (!( $rdisp =~ m/$checkdisp/ ))
+	{
+		my $inf=`xwininfo -root -display $display 2&gt; /dev/null`;
+		if ( $inf=~ m/geometry/)
+		{
+			print &quot;$uname\@$display\n&quot;;
+		}
+	}
 }
 
 $outp=`ls -1 /tmp/ | grep x2godesktopsharing_`;
@@ -66,9 +66,9 @@ $outp=`ls -1 /tmp/ | grep x2godesktopsharing_`;
 
 for(my $i=0;$i&lt;@outp;$i++)
 {
-    my @ln=split(&quot;\@&quot;<A HREF="https://lists.berlios.de/mailman/listinfo/x2go-commits">, at outp</A>[$i]);
-    if( @ln[1] ne $uname )
-    {
-           print &quot;@ln[1]\@@ln[2]\n&quot;;
-    }
+	my @ln=split(&quot;\@&quot;<A HREF="https://lists.berlios.de/mailman/listinfo/x2go-commits">, at outp</A>[$i]);
+	if ( @ln[1] ne $uname )
+	{
+		print &quot;@ln[1]\@@ln[2]\n&quot;;
+	}
 }
diff --git a/x2goserver/bin/x2golistsessions b/x2goserver/bin/x2golistsessions
index 0119f3b..5e8f7f5 100755
--- a/x2goserver/bin/x2golistsessions
+++ b/x2goserver/bin/x2golistsessions
@@ -29,53 +29,52 @@ use x2godbwrapper;
 
 sub check_stat
 {
-   my $sess=shift;
-   my $log=&quot;$ENV{'HOME'}/.x2go/C-$sess/session.log&quot;;
-   my $text=`tail -1 $log`;
-   if($text =~ m/Session suspended/)
-   {
-       return 0;
-   }
-   return 1;
+	my $sess=shift;
+	my $log=&quot;$ENV{'HOME'}/.x2go/C-$sess/session.log&quot;;
+	my $text=`tail -1 $log`;
+	if ($text =~ m/Session suspended/)
+	{
+		return 0;
+	}
+	return 1;
 }
 
 my $serv=shift;
 if( ! $serv)
 {
-   $serv=hostname;
+	$serv=hostname;
 }
 
 my @outp;
 if($serv eq &quot;--all-servers&quot;)
 {
- @outp=db_listsessions_all();
+	@outp=db_listsessions_all();
 }
 else
 {
- @outp=db_listsessions($serv);
+	@outp=db_listsessions($serv);
 }
 
-for(my $i=0;$i&lt;@outp;$i++)
+for (my $i=0;$i&lt;@outp;$i++)
 {
-     @outp[$i] =~ s/ //g;
-     @outp[$i] =~ s/\*/ /g;
-     my @sinfo=split('\\|',&quot;@outp[$i]&quot;);
-     if(@sinfo[4]eq 'F')
-     {
-           print &quot;@outp[$i]\n&quot;;
-     }       
-     else
-     { 
-       if(@sinfo[4]eq 'R')
-       {
-           if(!check_stat(@sinfo[1]))
-	   {
-               db_changestatus( 'S', @sinfo[1] );
-	       @outp[$i] =~ s/\|R\|/\|S\|/;
-               system( &quot;x2goumount-session @sinfo[1]&quot;);
-
-	   }
-       }       
-       print &quot;@outp[$i]\n&quot;;
-     }
+	@outp[$i] =~ s/ //g;
+	@outp[$i] =~ s/\*/ /g;
+	my @sinfo=split('\\|',&quot;@outp[$i]&quot;);
+	if (@sinfo[4]eq 'F')
+	{
+		print &quot;@outp[$i]\n&quot;;
+	}
+	else
+	{ 
+		if (@sinfo[4]eq 'R')
+		{
+			if(!check_stat(@sinfo[1]))
+			{
+				db_changestatus( 'S', @sinfo[1] );
+				@outp[$i] =~ s/\|R\|/\|S\|/;
+				system( &quot;x2goumount-session @sinfo[1]&quot;);
+			}
+		}
+		print &quot;@outp[$i]\n&quot;;
+	}
 }
diff --git a/x2goserver/bin/x2gomountdirs b/x2goserver/bin/x2gomountdirs
index e84149d..7eb0442 100755
--- a/x2goserver/bin/x2gomountdirs
+++ b/x2goserver/bin/x2gomountdirs
@@ -34,38 +34,38 @@ my $i=0;
 @dl[$i]=shift;
 while(@dl[$i])
 {
-    $i++;
-    @dl[$i]=shift;
+	$i++;
+	@dl[$i]=shift;
 }
 my $dirlist=join(&quot; &quot;<A HREF="https://lists.berlios.de/mailman/listinfo/x2go-commits">, at dl</A>);
 chop($dirlist);
 my $reverse=0;
 my $port=&quot;22&quot;;
 print &quot;dirs:$dirlist\n&quot;;
-if($dirlist =~ m/__REVERSESSH_PORT__/)
+if ($dirlist =~ m/__REVERSESSH_PORT__/)
 {
-    @dl=split(&quot;__REVERSESSH_PORT__&quot;,&quot;$dirlist&quot;);
-    $dirlist=@dl[0];
-    $port=@dl[1];
-    $reverse=1;
+	@dl=split(&quot;__REVERSESSH_PORT__&quot;,&quot;$dirlist&quot;);
+	$dirlist=@dl[0];
+	$port=@dl[1];
+	$reverse=1;
 }
 
-if($dirlist =~ m/__SSH_PORT__/)
+if ($dirlist =~ m/__SSH_PORT__/)
 {
-   @dl=split(&quot;__SSH_PORT__&quot;,&quot;$dirlist&quot;);
-   $dirlist=@dl[0];
-   $port=@dl[1];
+	@dl=split(&quot;__SSH_PORT__&quot;,&quot;$dirlist&quot;);
+	$dirlist=@dl[0];
+	$port=@dl[1];
 }
 
 print &quot;ssh port:$port\n&quot;;
 my $host;
 if($reverse == 0)
 {
-   $host=(split(&quot; &quot;,$ENV{'SSH_CLIENT'}))[0];
+	$host=(split(&quot; &quot;,$ENV{'SSH_CLIENT'}))[0];
 }
 else
 {
-  $host='127.0.0.1';
+	$host='127.0.0.1';
 }
 print &quot;Host:$host\n&quot;;
 print &quot;User:$user\n&quot;;
@@ -96,200 +96,198 @@ my $spooldir=&quot;/tmp/spool_$ENV{'USER'}&quot;;
 my $mimeboxdir_lnk=&quot;$ENV{'HOME'}/.x2go/C-$session/mimebox&quot;;
 my $mimeboxdir=&quot;/tmp/mimebox_$ENV{'USER'}&quot;;
 
-if(! -e $mdir)
+if (! -e $mdir)
 {
-   mkdir($mdir);
+	mkdir($mdir);
 }
 chmod(0700,$mdir);
 
-if(! -e &quot;$mdir/disk&quot;)
+if (! -e &quot;$mdir/disk&quot;)
 {
-   mkdir(&quot;$mdir/disk&quot;);
+	mkdir(&quot;$mdir/disk&quot;);
 }
 chmod(0700,&quot;$mdir/disk&quot;);
 
-if(! -e &quot;$mdir/cd&quot;)
+if (! -e &quot;$mdir/cd&quot;)
 {
-   mkdir(&quot;$mdir/cd&quot;);
+	mkdir(&quot;$mdir/cd&quot;);
 }
 chmod(0700,&quot;$mdir/cd&quot;);
 
-if(! -e &quot;$mdir/rm&quot;)
+if (! -e &quot;$mdir/rm&quot;)
 {
-   mkdir(&quot;$mdir/rm&quot;);
+	mkdir(&quot;$mdir/rm&quot;);
 }
 chmod(0700,&quot;$mdir/rm&quot;);
 
 my $plasmstamp=$mdir.&quot;/&quot;.$session.&quot;.plasmoid&quot;;
 
-if(! -e $spooldir)
+if (! -e $spooldir)
 {
-   mkdir($spooldir);
+	mkdir($spooldir);
 }
 chmod(0700,$spooldir);
 
 $spooldir=&quot;$spooldir/$session&quot;;
-if(! -e $spooldir)
+if (! -e $spooldir)
 {
-   mkdir($spooldir);
+	mkdir($spooldir);
 }
 chmod(0700,$spooldir);
 
-if(! -e $mimeboxdir)
+if (! -e $mimeboxdir)
 {
-   mkdir($mimeboxdir);
+	mkdir($mimeboxdir);
 }
 chmod(0700,$mimeboxdir);
 
 $mimeboxdir=&quot;$mimeboxdir/$session&quot;;
-if(! -e $mimeboxdir)
+if (! -e $mimeboxdir)
 {
-   mkdir($mimeboxdir);
+	mkdir($mimeboxdir);
 }
 chmod(0700,$mimeboxdir);
 
-if( -d $ldir)
+if ( -d $ldir)
 {
-    rmdir($ldir);
+	rmdir($ldir);
 }
 
-if( ! -l $ldir)
+if ( ! -l $ldir)
 {
-   system (&quot;ln -s $mdir $ldir&quot;);
+	system (&quot;ln -s $mdir $ldir&quot;);
 }
 
-if( -d $spooldir_lnk)
+if ( -d $spooldir_lnk)
 {
-    rmdir($spooldir_lnk);
+	rmdir($spooldir_lnk);
 }
 
-if( ! -l $spooldir_lnk)
+if ( ! -l $spooldir_lnk)
 {
-   system (&quot;ln -s $spooldir $spooldir_lnk&quot;);
+	system (&quot;ln -s $spooldir $spooldir_lnk&quot;);
 }
 
-if( -d $mimeboxdir_lnk)
+if ( -d $mimeboxdir_lnk)
 {
-    rmdir($mimeboxdir_lnk);
+	rmdir($mimeboxdir_lnk);
 }
 
-if( ! -l $mimeboxdir_lnk)
+if ( ! -l $mimeboxdir_lnk)
 {
-   system (&quot;ln -s $mimeboxdir $mimeboxdir_lnk&quot;);
+	system (&quot;ln -s $mimeboxdir $mimeboxdir_lnk&quot;);
 }
 
 my $uname=$ENV{'USER'};
 
 my @dirs=split(':',$dirlist);
-for(my $i=0;$i&lt;@dirs;$i++)
+for (my $i=0;$i&lt;@dirs;$i++)
 {
-       my $printspool=0;
-       my $mimeboxspool=0;
-       my $mntpath;
-       if(@dirs[$i]=~m/__PRINT_SPOOL_/)
-       {
-            @dirs[$i]=~s/__PRINT_SPOOL_//;
-            $printspool=1;
-            $mntpath=$spooldir;
-       }
-       elsif(@dirs[$i]=~m/__MIMEBOX_SPOOL_/)
-       {
-            @dirs[$i]=~s/__MIMEBOX_SPOOL_//;
-            $mimeboxspool=1;
-            $mntpath=$mimeboxdir;
-       }
-       else
-       {
-            my $p=@dirs[$i];
-            if($type ne &quot;dir&quot;)
-            {
-                $p=~s/\/ramdrive\/mnt\///;
-                if($p =~ m/CDROM/)
-                {
-                    $mdir=$mdir.&quot;/cd&quot;;
-                }
-                else
-                {
-                    $mdir=$mdir.&quot;/rm&quot;;
-                }
-
-            }
-            else
-            {
-                $mdir=$mdir.&quot;/disk&quot;;
-            }
-            $p=~s/\//_/g;
-            $p=~s/ /_/g;
-            $p=~s/_cygdrive_//g;
-            $p=~s/~//g;
-            mkdir(&quot;$mdir/$p&quot;);
-            $mntpath=&quot;$mdir/$p&quot;;
-       }
-
-       if(db_insertmount( $session, $mntpath, $host))
-       {
-             my $code_conv=$ENV{'X2GO_ICONV'};
-             if($code_conv ne &quot;&quot;)
-             {
-                 $code_conv=&quot;-o $code_conv&quot;;
-             }
-            print &quot;inserted,\nsshfs $code_conv -o IdentityFile=$key,UserKnownHostsFile=$key.ident $user\@$host:\&quot;@dirs[$i]\&quot; \&quot;$mntpath\&quot; -p $port\n&quot;;
-            if(system(&quot;sshfs  $code_conv -o ServerAliveInterval=300,Cipher=blowfish,IdentityFile=$key,UserKnownHostsFile=$key.ident $user\@$host:\&quot;@dirs[$i]\&quot; \&quot;$mntpath\&quot; -p $port 2&gt;&gt;~/mounts.log&quot;)==0)
-            {
-                print &quot;mount @dirs[$i] ok\n&quot;;
-
-                # check if kde4 plasmoid running
-                my $useplasmoid=0;
-                if( -e $plasmstamp )
-                {
-                    open(STMP,&quot;&lt;$plasmstamp&quot;);
-                    my $stamp=&lt;STMP&gt;;
-                    close (STMP);
-                    if(abs($stamp-time())&lt;15)
-                    {
-                        $useplasmoid=1;
-                    }
-                }
-                if(! $printspool &amp;&amp; ! $mimeboxspool &amp;&amp; ! $useplasmoid)
-                {
-                    my $fname=&quot;$ENV{'HOME'}/Desktop&quot;;
-                    my $p=@dirs[$i];
-                    $p=~s/\/cygdrive\///g;
-                    $p=~s/\//_/g;
-                    $fname=&quot;$fname/$p&quot;;
-                    if($type eq &quot;dir&quot;)
-                    {
-                        $fname=&quot;$fname(sshfs-disk)&quot;;
-                    }
-                    else
-                    {
-                        if($fname =~ m/CDROM/)
-                        {
-                            $fname=&quot;$fname(sshfs-cdrom)&quot;;
-                        }
-                        else
-                        {
-                            $fname=&quot;$fname(sshfs-removable)&quot;;
-                        }
-                        $fname=~s/_ramdrive_mnt_//;
-                    }
-                    print &quot;fname: $fname\n&quot;;
-                    open(F,&quot;&gt;$fname&quot;);
-                    print F &quot;$mntpath\n$session\n\n\0&quot;;
-                    close(F);
-                }
-            }
-            else
-            {
-               print &quot;mount @dirs[$i] failed\n&quot;;
-               db_deletemount( $session, $mntpath);
-               rmdir($mntpath);
-            }
-       }
-       else
-       {
-            print &quot;insertion failed(already mounted?), not mounting\n&quot;;
-       }
+	my $printspool=0;
+	my $mimeboxspool=0;
+	my $mntpath;
+	if(@dirs[$i]=~m/__PRINT_SPOOL_/)
+	{
+		@dirs[$i]=~s/__PRINT_SPOOL_//;
+		$printspool=1;
+		$mntpath=$spooldir;
+	}
+	elsif(@dirs[$i]=~m/__MIMEBOX_SPOOL_/)
+	{
+		@dirs[$i]=~s/__MIMEBOX_SPOOL_//;
+		$mimeboxspool=1;
+		$mntpath=$mimeboxdir;
+	}
+	else
+	{
+		my $p=@dirs[$i];
+		if ($type ne &quot;dir&quot;)
+		{
+			$p=~s/\/ramdrive\/mnt\///;
+			if ($p =~ m/CDROM/)
+			{
+				$mdir=$mdir.&quot;/cd&quot;;
+			}
+			else
+			{
+				$mdir=$mdir.&quot;/rm&quot;;
+			}
+		}
+		else
+		{
+			$mdir=$mdir.&quot;/disk&quot;;
+		}
+		$p=~s/\//_/g;
+		$p=~s/ /_/g;
+		$p=~s/_cygdrive_//g;
+		$p=~s/~//g;
+		mkdir(&quot;$mdir/$p&quot;);
+		$mntpath=&quot;$mdir/$p&quot;;
+	}
+
+	if (db_insertmount( $session, $mntpath, $host))
+	{
+		my $code_conv=$ENV{'X2GO_ICONV'};
+		if ($code_conv ne &quot;&quot;)
+		{
+			$code_conv=&quot;-o $code_conv&quot;;
+		}
+		print &quot;inserted,\nsshfs $code_conv -o IdentityFile=$key,UserKnownHostsFile=$key.ident $user\@$host:\&quot;@dirs[$i]\&quot; \&quot;$mntpath\&quot; -p $port\n&quot;;
+		if (system(&quot;sshfs  $code_conv -o ServerAliveInterval=300,Cipher=blowfish,IdentityFile=$key,UserKnownHostsFile=$key.ident $user\@$host:\&quot;@dirs[$i]\&quot; \&quot;$mntpath\&quot; -p $port 2&gt;&gt;~/mounts.log&quot;)==0)
+		{
+			print &quot;mount @dirs[$i] ok\n&quot;;
+			# check if kde4 plasmoid running
+			my $useplasmoid=0;
+			if ( -e $plasmstamp )
+			{
+				open(STMP,&quot;&lt;$plasmstamp&quot;);
+				my $stamp=&lt;STMP&gt;;
+				close (STMP);
+				if (abs($stamp-time())&lt;15)
+				{
+					$useplasmoid=1;
+				}
+			}
+			if (! $printspool &amp;&amp; ! $mimeboxspool &amp;&amp; ! $useplasmoid)
+			{
+				my $fname=&quot;$ENV{'HOME'}/Desktop&quot;;
+				my $p=@dirs[$i];
+				$p=~s/\/cygdrive\///g;
+				$p=~s/\//_/g;
+				$fname=&quot;$fname/$p&quot;;
+				if ($type eq &quot;dir&quot;)
+				{
+					$fname=&quot;$fname(sshfs-disk)&quot;;
+				}
+				else
+				{
+					if ($fname =~ m/CDROM/)
+					{
+						$fname=&quot;$fname(sshfs-cdrom)&quot;;
+					}
+					else
+					{
+						$fname=&quot;$fname(sshfs-removable)&quot;;
+					}
+					$fname=~s/_ramdrive_mnt_//;
+				}
+				print &quot;fname: $fname\n&quot;;
+				open(F,&quot;&gt;$fname&quot;);
+				print F &quot;$mntpath\n$session\n\n\0&quot;;
+				close(F);
+			}
+		}
+		else
+		{
+			print &quot;mount @dirs[$i] failed\n&quot;;
+			db_deletemount( $session, $mntpath);
+			rmdir($mntpath);
+		}
+	}
+	else
+	{
+		print &quot;insertion failed(already mounted?), not mounting\n&quot;;
+	}
 }
 
 unlink($key);
diff --git a/x2goserver/bin/x2goprint b/x2goserver/bin/x2goprint
index 1a4ebaf..9360cf9 100755
--- a/x2goserver/bin/x2goprint
+++ b/x2goserver/bin/x2goprint
@@ -30,12 +30,12 @@ use x2godbwrapper;
 
 if (scalar(@ARGV) ==1)
 {
-     system (&quot;su @ARGV[0] -c \&quot;x2golistsessions --all-servers\&quot; &quot;);
+	system (&quot;su @ARGV[0] -c \&quot;x2golistsessions --all-servers\&quot; &quot;);
 }
 elsif (scalar(@ARGV) != 4)
 {
-    print STDERR &quot;ERROR: Usage:\nx2goprint user session file titleFile\nx2goprint user\n&quot;;
-    exit 1;
+	print STDERR &quot;ERROR: Usage:\nx2goprint user session file titleFile\nx2goprint user\n&quot;;
+	exit 1;
 }
 
 my ($user, $session, $file, $titleFile)=@ARGV;
@@ -46,10 +46,10 @@ my $printdir=$homedir;
 my $title;
 if( -e &quot;$printdir/$titleFile&quot;)
 {
-     open (TITLE,&quot;&lt;$printdir/$titleFile&quot;);
-     $title=&lt;TITLE&gt;;
-     close (TITLE);
-     unlink(&quot;$printdir/$titleFile&quot;);
+	open (TITLE,&quot;&lt;$printdir/$titleFile&quot;);
+	$title=&lt;TITLE&gt;;
+	close (TITLE);
+	unlink(&quot;$printdir/$titleFile&quot;);
 }
 
 
@@ -63,20 +63,20 @@ chown $uid, $gid, &quot;$spooltmp&quot;;
 chmod 0700, &quot;$spooltmp&quot;;
 
 my ($mounts)=db_getmounts($session);
-if( $mounts=~m/$spooldir/)
+if ( $mounts=~m/$spooldir/)
 {
-     move(&quot;$printdir/$file&quot;, &quot;$spooltmp&quot;) or die &quot;$!: Can't move $file to $spooltmp/&quot;;
-     chown $uid, $gid, &quot;$spooltmp/$file&quot;;
-     system(&quot;su $user -c \&quot;mv $spooltmp/$file $spooldir\&quot;&quot;);
+	move(&quot;$printdir/$file&quot;, &quot;$spooltmp&quot;) or die &quot;$!: Can't move $file to $spooltmp/&quot;;
+	chown $uid, $gid, &quot;$spooltmp/$file&quot;;
 
-     open (RFILE,&quot;&gt;$spooltmp/$file.ready&quot;);
-     print RFILE &quot;$file\n$title&quot;;
-     close (RFILE);
+	system(&quot;su $user -c \&quot;mv $spooltmp/$file $spooldir\&quot;&quot;);
+	open (RFILE,&quot;&gt;$spooltmp/$file.ready&quot;);
+	print RFILE &quot;$file\n$title&quot;;
+	close (RFILE);
 
-     chown $uid, $gid, &quot;$spooltmp/$file.ready&quot;;
-     system (&quot;su $user -c \&quot;mv $spooltmp/$file.ready $spooldir\&quot;&quot;);
+	chown $uid, $gid, &quot;$spooltmp/$file.ready&quot;;
+	system (&quot;su $user -c \&quot;mv $spooltmp/$file.ready $spooldir\&quot;&quot;);
 }
 else
 {
-     unlink(&quot;$printdir/$file&quot;);
+	unlink(&quot;$printdir/$file&quot;);
 }
diff --git a/x2goserver/bin/x2goresume-session b/x2goserver/bin/x2goresume-session
index 25e7832..0f90311 100755
--- a/x2goserver/bin/x2goresume-session
+++ b/x2goserver/bin/x2goresume-session
@@ -28,24 +28,21 @@ X2GO_KBD_LAYOUT=$5
 X2GO_KBD_TYPE=$6
 X2GO_SET_KBD=$7
 
-
-
 X2GO_AGENT_PID=`x2gogetagent $SESSION_NAME`
 
-
 X2GO_ROOT=${HOME}/.x2go
 X2GO_RESIZE=0
 X2GO_FULLSCREEN=0
 
 if [ &quot;$X2GO_GEOMETRY&quot; == &quot;&quot; ]
 then
-    X2GO_GEOMETRY=fullscreen
+	X2GO_GEOMETRY=fullscreen
 fi
 
 if [ &quot;$X2GO_GEOMETRY&quot; == &quot;fullscreen&quot; ]
 then
-    X2GO_RESIZE=1
-    X2GO_FULLSCREEN=1
+	X2GO_RESIZE=1
+	X2GO_FULLSCREEN=1
 fi
 
 SESSION_DIR=${X2GO_ROOT}/C-${SESSION_NAME}
@@ -58,13 +55,12 @@ LSTR=`echo &quot;$OPTIONS&quot; | awk -F, {'print $2'}`
 PSTR=`echo &quot;$OPTIONS&quot; | awk -F, {'print $3'}`
 KTSTR=`echo &quot;$OPTIONS&quot; | awk -F, {'print $12'}`
 
-
 KTSTR=`echo $KTSTR | sed &quot;s/\//\\\\\\\\\//&quot;`
 X2GO_KBD_TYPE=`echo $X2GO_KBD_TYPE | sed &quot;s/\//\\\\\\\\\//&quot;`
 
 if [ &quot;$X2GO_SET_KBD&quot; == &quot;0&quot; ]
 then
-    X2GO_KBD_TYPE=&quot;null\/null&quot;
+	X2GO_KBD_TYPE=&quot;null\/null&quot;
 fi
 
 NEWOPTIONS=`echo &quot;$OPTIONS&quot; | sed  -e  &quot;s/$LSTR/link=$X2GO_LINK/&quot;\
@@ -74,14 +70,10 @@ NEWOPTIONS=`echo &quot;$OPTIONS&quot; | sed  -e  &quot;s/$LSTR/link=$X2GO_LINK/&quot;\
  -e &quot;s/$RSTR/resize=$X2GO_RESIZE/&quot;\
  -e &quot;s/$FSTR/fullscreen=$X2GO_FULLSCREEN/&quot;`
 
-
-#echo -e &quot;old options:$OPTIONS\n\nnew options:$NEWOPTIONS&quot;
-
-
 X2GO_CLIENT=`echo $SSH_CLIENT | awk '{print $1}'`
 if [ &quot;$X2GO_CLIENT&quot; == &quot;&quot; ]
 then
-   X2GO_CLIENT=$HOSTNAME
+	X2GO_CLIENT=$HOSTNAME
 fi
 
 echo &quot;$NEWOPTIONS&quot; &gt;${SESSION_DIR}/options
diff --git a/x2goserver/bin/x2goruncommand b/x2goserver/bin/x2goruncommand
index b639774..1af50c2 100755
--- a/x2goserver/bin/x2goruncommand
+++ b/x2goserver/bin/x2goruncommand
@@ -37,75 +37,56 @@ echo &quot;exec $cmd&quot; &gt;&gt; $MESSAGE_FILE
 
 IMEXIT=&quot;false&quot;
 
-if [ &quot;$sndsys&quot; == &quot;esd&quot; ]
-then
-  export ESPEAKER=localhost:$4
-elif [ &quot;$sndsys&quot; == &quot;arts&quot; ]
-then 
-  export ARTS_SERVER=localhost:$4
+if [ &quot;$sndsys&quot; == &quot;esd&quot; ]; then
+	export ESPEAKER=localhost:$4
+elif [ &quot;$sndsys&quot; == &quot;arts&quot; ]; then
+	export ARTS_SERVER=localhost:$4
 fi
 
-if [ &quot;$cmd&quot; == &quot;WWWBROWSER&quot; ]
-then
-     if [ -e &quot;/usr/bin/firefox&quot; ]
-     then
-         cmd=&quot;/usr/bin/firefox&quot;
-     elif  [ -e &quot;/usr/bin/iceweasel&quot; ]
-     then
-         cmd=&quot;/usr/bin/iceweasel&quot;
-     elif  [ -e &quot;/usr/bin/abrowser&quot; ]
-     then
-         cmd=&quot;/usr/bin/abrowser&quot;
-     elif  [ -e &quot;/usr/bin/konqueror&quot; ]
-     then
-         cmd=&quot;/usr/bin/konqueror&quot;
-     elif  [ -e &quot;/usr/bin/galeon&quot; ]
-     then
-         cmd=&quot;/usr/bin/galeon&quot;
-     fi
+if [ &quot;$cmd&quot; == &quot;WWWBROWSER&quot; ]; then
+	if [ -e &quot;/usr/bin/firefox&quot; ]; then
+		cmd=&quot;/usr/bin/firefox&quot;
+	elif  [ -e &quot;/usr/bin/iceweasel&quot; ]; then
+		cmd=&quot;/usr/bin/iceweasel&quot;
+	elif  [ -e &quot;/usr/bin/abrowser&quot; ]; then
+		cmd=&quot;/usr/bin/abrowser&quot;
+	elif  [ -e &quot;/usr/bin/konqueror&quot; ]; then
+		cmd=&quot;/usr/bin/konqueror&quot;
+	elif  [ -e &quot;/usr/bin/galeon&quot; ]; then
+		cmd=&quot;/usr/bin/galeon&quot;
+	fi
 fi
 
-if [ &quot;$cmd&quot; == &quot;MAILCLIENT&quot; ]
-then
-     if [ -e &quot;/usr/bin/thunderbird&quot; ]
-     then
-         cmd=&quot;/usr/bin/thunderbird&quot;
-     elif  [ -e &quot;/usr/bin/icedove&quot; ]
-     then
-         cmd=&quot;/usr/bin/icedove&quot;
-     elif  [ -e &quot;/usr/bin/kmail&quot; ]
-     then
-         cmd=&quot;/usr/bin/kmail&quot;
-     elif  [ -e &quot;/usr/bin/evolution&quot; ]
-     then
-         cmd=&quot;/usr/bin/evolution&quot;
-     fi
+if [ &quot;$cmd&quot; == &quot;MAILCLIENT&quot; ]; then
+	if [ -e &quot;/usr/bin/thunderbird&quot; ]; then
+		cmd=&quot;/usr/bin/thunderbird&quot;
+	elif  [ -e &quot;/usr/bin/icedove&quot; ]; then
+		cmd=&quot;/usr/bin/icedove&quot;
+	elif  [ -e &quot;/usr/bin/kmail&quot; ]; then
+		cmd=&quot;/usr/bin/kmail&quot;
+	elif  [ -e &quot;/usr/bin/evolution&quot; ]; then
+		cmd=&quot;/usr/bin/evolution&quot;
+	fi
 fi
 
-if [ &quot;$cmd&quot; == &quot;OFFICE&quot; ]
-then
-     if [ -e &quot;/usr/bin/ooffice&quot; ]
+if [ &quot;$cmd&quot; == &quot;OFFICE&quot; ]; then
+	if [ -e &quot;/usr/bin/ooffice&quot; ]
      then
          cmd=&quot;/usr/bin/ooffice&quot;
      fi
 fi
 
-if [ &quot;$cmd&quot; == &quot;TERMINAL&quot; ]
-then
-     IMEXIT=&quot;true&quot;
-     if [ -e &quot;/usr/bin/konsole&quot; ]
-     then
-         cmd=&quot;/usr/bin/konsole&quot;
-     elif  [ -e &quot;/usr/bin/gnome-terminal&quot; ]
-     then
-         cmd=&quot;/usr/bin/gnome-terminal&quot;
-     elif  [ -e &quot;/usr/bin/rxvt&quot; ]
-     then
-         cmd=&quot;/usr/bin/rxvt&quot;
-     elif  [ -e &quot;/usr/bin/xterm&quot; ]
-     then
-         cmd=&quot;/usr/bin/xterm&quot;
-     fi
+if [ &quot;$cmd&quot; == &quot;TERMINAL&quot; ]; then
+	IMEXIT=&quot;true&quot;
+	if [ -e &quot;/usr/bin/konsole&quot; ]; then
+		cmd=&quot;/usr/bin/konsole&quot;
+	elif  [ -e &quot;/usr/bin/gnome-terminal&quot; ]; then
+		cmd=&quot;/usr/bin/gnome-terminal&quot;
+	elif  [ -e &quot;/usr/bin/rxvt&quot; ]; then
+		cmd=&quot;/usr/bin/rxvt&quot;
+	elif  [ -e &quot;/usr/bin/xterm&quot; ]; then
+		cmd=&quot;/usr/bin/xterm&quot;
+	fi
 fi
 
 EXEC=`which $cmd`
@@ -113,22 +94,19 @@ EXEC=`which $cmd`
 BNAME=`basename $EXEC`
 if [ &quot;$BNAME&quot; == &quot;rdesktop&quot; ]
 then
-     IMEXIT=&quot;true&quot;
+	IMEXIT=&quot;true&quot;
 fi
 
-if [ &quot;$EXEC&quot; != &quot;&quot; ] &amp;&amp; [ -x `which $cmd` ]
-then
-  $cmd
-  #### some applications can quit immediately, we waiting until x2goagent exists
-  if [  &quot;$X2GO_SESS_TYPE&quot; == &quot;R&quot; ] &amp;&amp; [ &quot;$IMEXIT&quot; == &quot;false&quot; ]
-  then
-     while [ -d /proc/$X2GO_AGENT_PID ]
-     do
-         sleep 1
-     done
-  fi
+if [ &quot;$EXEC&quot; != &quot;&quot; ] &amp;&amp; [ -x `which $cmd` ]; then
+	$cmd
+	#### some applications can quit immediately, we waiting until x2goagent exists
+	if [  &quot;$X2GO_SESS_TYPE&quot; == &quot;R&quot; ] &amp;&amp; [ &quot;$IMEXIT&quot; == &quot;false&quot; ]; then
+		while [ -d /proc/$X2GO_AGENT_PID ]; do
+			sleep 1
+		done
+	fi
 else
-   echo &quot;X2GORUNCOMMAND ERR NOEXEC:$cmd&quot; &gt; $MESSAGE_FILE
+	echo &quot;X2GORUNCOMMAND ERR NOEXEC:$cmd&quot; &gt; $MESSAGE_FILE
 fi 
 
 kill -TERM  $X2GO_AGENT_PID
diff --git a/x2goserver/bin/x2goshowblocks b/x2goserver/bin/x2goshowblocks
index ad64f65..e5f3d1f 100755
--- a/x2goserver/bin/x2goshowblocks
+++ b/x2goserver/bin/x2goshowblocks
@@ -30,8 +30,8 @@ my $uname=shift;
 my $id=shift;
 my $tbl=&quot;mounts&quot;;
 my @outp=dbsys_getmounts( $id);
-for(my $i=0;$i&lt;@outp;$i++)
+for (my $i=0;$i&lt;@outp;$i++)
 {
-    my $path=(split(&quot;\\|&quot;<A HREF="https://lists.berlios.de/mailman/listinfo/x2go-commits">, at outp</A>[$i]))[1];
-    print `su $uname -c &quot;lsof 2&gt;/dev/null | grep $path&quot;`;
+	my $path=(split(&quot;\\|&quot;<A HREF="https://lists.berlios.de/mailman/listinfo/x2go-commits">, at outp</A>[$i]))[1];
+	print `su $uname -c &quot;lsof 2&gt;/dev/null | grep $path&quot;`;
 }
diff --git a/x2goserver/bin/x2gostartagent b/x2goserver/bin/x2gostartagent
index ff19983..37fe767 100755
--- a/x2goserver/bin/x2gostartagent
+++ b/x2goserver/bin/x2gostartagent
@@ -38,47 +38,43 @@ X2GO_CMD=$9
 X2GO_RESIZE=0
 X2GO_FULLSCREEN=0
 
-if [ &quot;$X2GO_STYPE&quot; == &quot;S&quot; ]
-then
-    
-    SHADOW_MODE=`echo &quot;$X2GO_CMD&quot;|awk '{split($0,a,&quot;XSHAD&quot;); print a[1]}'`
-    SHADOW_USER=`echo &quot;$X2GO_CMD&quot;|awk '{split($0,a,&quot;XSHAD&quot;); print a[2]}'`
-    SHADOW_DESKTOP=`echo &quot;$X2GO_CMD&quot;|awk '{split($0,a,&quot;XSHAD&quot;); print a[3]}'`
-    
-    echo &quot;suser $SHADOW_USER user $USER &quot; &gt;&gt; /tmp/uagent
-    
-    if [ &quot;$SHADOW_USER&quot; != &quot;$USER&quot; ]
-    then
-        
-        OUTPUT=`x2godesktopsharing client $X2GO_CLIENT $@`
-        if [ &quot;$OUTPUT&quot; == &quot;DENY&quot; ]
-	then
-            echo &quot;ACCESS DENIED&quot; 1&gt;&amp;2
-            exit -1
+if [ &quot;$X2GO_STYPE&quot; == &quot;S&quot; ]; then
+
+	SHADOW_MODE=`echo &quot;$X2GO_CMD&quot;|awk '{split($0,a,&quot;XSHAD&quot;); print a[1]}'`
+	SHADOW_USER=`echo &quot;$X2GO_CMD&quot;|awk '{split($0,a,&quot;XSHAD&quot;); print a[2]}'`
+	SHADOW_DESKTOP=`echo &quot;$X2GO_CMD&quot;|awk '{split($0,a,&quot;XSHAD&quot;); print a[3]}'`
+
+	echo &quot;suser $SHADOW_USER user $USER &quot; &gt;&gt; /tmp/uagent
+
+	if [ &quot;$SHADOW_USER&quot; != &quot;$USER&quot; ]; then
+
+		OUTPUT=`x2godesktopsharing client $X2GO_CLIENT $@`
+		if [ &quot;$OUTPUT&quot; == &quot;DENY&quot; ]; then
+			echo &quot;ACCESS DENIED&quot; 1&gt;&amp;2
+			exit -1
+		fi
+		X2GO_COOKIE=`echo $OUTPUT | awk '{print $2}'`
+		X2GO_PORT=`echo $OUTPUT | awk '{print $1}'`
+		xauth add ${HOSTNAME}/unix:${X2GO_PORT} MIT-MAGIC-COOKIE-1 ${X2GO_COOKIE}
+		xauth add ${HOSTNAME}:${X2GO_PORT} MIT-MAGIC-COOKIE-1 ${X2GO_COOKIE}
+
+		echo $X2GO_PORT
+		echo $X2GO_COOKIE        
+		echo $OUTPUT | awk '{print $3}'
+		echo $OUTPUT | awk '{print $4}'
+		echo $OUTPUT | awk '{print $5}'
+		echo $OUTPUT | awk '{print $6}'
+		echo $OUTPUT | awk '{print $7}'
+		exit 0
 	fi
-	X2GO_COOKIE=`echo $OUTPUT | awk '{print $2}'`
-	X2GO_PORT=`echo $OUTPUT | awk '{print $1}'`
-	xauth add ${HOSTNAME}/unix:${X2GO_PORT} MIT-MAGIC-COOKIE-1 ${X2GO_COOKIE}
-        xauth add ${HOSTNAME}:${X2GO_PORT} MIT-MAGIC-COOKIE-1 ${X2GO_COOKIE}
-
-        echo $X2GO_PORT
-        echo $X2GO_COOKIE        
-        echo $OUTPUT | awk '{print $3}'
-        echo $OUTPUT | awk '{print $4}'
-        echo $OUTPUT | awk '{print $5}'
-        echo $OUTPUT | awk '{print $6}'
-        echo $OUTPUT | awk '{print $7}'
-    exit
-    fi
 fi
 
 LIMIT=`x2gosessionlimit`
 LWORD=`echo $LIMIT | awk '{print $1}'`
 
-if [ &quot;$LWORD&quot; == &quot;LIMIT&quot; ]
-then
-   echo  $LIMIT 1&gt;&amp;2
-   exit -1
+if [ &quot;$LWORD&quot; == &quot;LIMIT&quot; ]; then
+	echo  $LIMIT 1&gt;&amp;2
+	exit -1
 fi
 
 export NX_CLIENT=/usr/bin/x2gosuspend-agent
@@ -87,113 +83,93 @@ COLORDEPTH=`echo &quot;$X2GO_TYPE&quot;|awk '{split($0,a,&quot;-depth_&quot;); print a[2]}'`
 
 SESSION_TYPE=&quot;D&quot;
 
-if [ &quot;$X2GO_STYPE&quot; == &quot;R&quot; ]
-then
-  SESSION_TYPE=&quot;R&quot;
-elif  [ &quot;$X2GO_STYPE&quot; == &quot;S&quot; ]
-then
-  SESSION_TYPE=&quot;S&quot;
+if [ &quot;$X2GO_STYPE&quot; == &quot;R&quot; ]; then
+	SESSION_TYPE=&quot;R&quot;
+elif  [ &quot;$X2GO_STYPE&quot; == &quot;S&quot; ]; then
+	SESSION_TYPE=&quot;S&quot;
 fi
 
-if [ &quot;$X2GO_CLIENT&quot; == &quot;&quot; ]
-then
-   X2GO_CLIENT=$HOSTNAME
+if [ &quot;$X2GO_CLIENT&quot; == &quot;&quot; ]; then
+	X2GO_CLIENT=$HOSTNAME
 fi
 
-
 USED_DISPLAYS=`x2gogetdisplays $HOSTNAME`
 
 
-while [ &quot;$OUTPUT&quot;  != &quot;inserted&quot; ]
-do
- X2GO_PORT=$(($X2GO_PORT + 1))
- X2GO_PORT=`echo &quot;for(\\$i=$X2GO_PORT;\\$br ne \&quot;true\&quot;;\\$i++){ if(\&quot;$USED_DISPLAYS\&quot; =~ m/\\|\\$i\\|/){\\$br=\&quot;false\&quot;;}else{\\$br=\&quot;true\&quot;;print \\$i;}}&quot;|perl`
-
- if  [ -e &quot;/tmp/.X${X2GO_PORT}-lock&quot; ] || [ -e &quot;/tmp/.X11-unix/X${X2GO_PORT}&quot; ] 
- then
-    OUTPUT=&quot;XXX&quot;
- else
-   SESSION_NAME=${USER}-${X2GO_PORT}-`date +&quot;%s&quot;`
-   if [ &quot;$COLORDEPTH&quot; != &quot;&quot; ]
-   then
-       SESSION_NAME=&quot;$SESSION_NAME&quot;_st${SESSION_TYPE}${X2GO_CMD}_dp${COLORDEPTH}
-       SESSION_NAME=`echo &quot;$SESSION_NAME&quot; | sed  -e  &quot;s/:/PP/g&quot;`
-   fi
-   OUTPUT=`x2goinsertsession $X2GO_PORT $HOSTNAME $SESSION_NAME`
- fi 
+while [ &quot;$OUTPUT&quot;  != &quot;inserted&quot; ]; do
+	X2GO_PORT=$(($X2GO_PORT + 1))
+	X2GO_PORT=`echo &quot;for(\\$i=$X2GO_PORT;\\$br ne \&quot;true\&quot;;\\$i++){ if(\&quot;$USED_DISPLAYS\&quot; =~ m/\\|\\$i\\|/){\\$br=\&quot;false\&quot;;}else{\\$br=\&quot;true\&quot;;print \\$i;}}&quot;|perl`
+
+	if  [ -e &quot;/tmp/.X${X2GO_PORT}-lock&quot; ] || [ -e &quot;/tmp/.X11-unix/X${X2GO_PORT}&quot; ]; then
+		OUTPUT=&quot;XXX&quot;
+	else
+		SESSION_NAME=${USER}-${X2GO_PORT}-`date +&quot;%s&quot;`
+		if [ &quot;$COLORDEPTH&quot; != &quot;&quot; ]; then
+			SESSION_NAME=&quot;$SESSION_NAME&quot;_st${SESSION_TYPE}${X2GO_CMD}_dp${COLORDEPTH}
+			SESSION_NAME=`echo &quot;$SESSION_NAME&quot; | sed  -e  &quot;s/:/PP/g&quot;`
+		fi
+		OUTPUT=`x2goinsertsession $X2GO_PORT $HOSTNAME $SESSION_NAME`
+	fi 
 done
 
 
 USED_PORTS=`x2gogetports $HOSTNAME`
 
 
-while [ &quot;$GR_PORT&quot; == &quot;&quot; ] || [ &quot;$SOUND_PORT&quot; == &quot;&quot; ] || [ &quot;$FS_PORT&quot; == &quot;&quot; ]
-do
-  OUTPUT=&quot;&quot;
-  while [ &quot;$OUTPUT&quot;  != &quot;inserted&quot; ]
-  do
-    SSH_PORT=$(($SSH_PORT + 1))
+while [ &quot;$GR_PORT&quot; == &quot;&quot; ] || [ &quot;$SOUND_PORT&quot; == &quot;&quot; ] || [ &quot;$FS_PORT&quot; == &quot;&quot; ]; do
+	OUTPUT=&quot;&quot;
+	while [ &quot;$OUTPUT&quot;  != &quot;inserted&quot; ]; do
+		SSH_PORT=$(($SSH_PORT + 1))
 
-    ##check if port in /etc/services
+		#check if port in /etc/services
+		SSH_PORT=`echo &quot;for(\\$i=$SSH_PORT;\\$br ne \&quot;true\&quot;;\\$i++){ if(\&quot;$USED_PORTS\&quot; =~ m/\\|\\$i\\|/){\\$br=\&quot;false\&quot;;}else{\\$br=\&quot;true\&quot;;print \\$i;}}&quot;|perl`
 
-    SSH_PORT=`echo &quot;for(\\$i=$SSH_PORT;\\$br ne \&quot;true\&quot;;\\$i++){ if(\&quot;$USED_PORTS\&quot; =~ m/\\|\\$i\\|/){\\$br=\&quot;false\&quot;;}else{\\$br=\&quot;true\&quot;;print \\$i;}}&quot;|perl`
-
-    SERV=`grep $SSH_PORT /etc/services`
-    if [ &quot;$SERV&quot; == &quot;&quot; ]
-    then
-      CR=`echo &quot;use IO::Socket; \\$sock = new IO::Socket::INET ( LocalAddr =&gt; 'localhost',LocalPort =&gt; \&quot;$SSH_PORT\&quot;,\
+		SERV=`grep $SSH_PORT /etc/services`
+		if [ &quot;$SERV&quot; == &quot;&quot; ]; then
+			CR=`echo &quot;use IO::Socket; \\$sock = new IO::Socket::INET ( LocalAddr =&gt; 'localhost',LocalPort =&gt; \&quot;$SSH_PORT\&quot;,\
                                   Proto =&gt; 'tcp',Listen =&gt; 1,Reuse =&gt;1 ) or die ;print \&quot;OK\&quot;;close(\\$sock);&quot;|perl 2&gt;/dev/null`
-      if [ &quot;$CR&quot; == &quot;OK&quot; ]
-      then
-         OUTPUT=`x2goinsertport $HOSTNAME $SESSION_NAME $SSH_PORT`
-      fi
-    fi
-  done
-  if [ &quot;$GR_PORT&quot; == &quot;&quot; ]
-  then
-     GR_PORT=$SSH_PORT
-  elif [ &quot;$SOUND_PORT&quot; == &quot;&quot; ]
-  then
-     SOUND_PORT=$SSH_PORT
-  else
-     FS_PORT=$SSH_PORT
-  fi
+			if [ &quot;$CR&quot; == &quot;OK&quot; ]; then
+				OUTPUT=`x2goinsertport $HOSTNAME $SESSION_NAME $SSH_PORT`
+			fi
+		fi
+	done
+	if [ &quot;$GR_PORT&quot; == &quot;&quot; ]; then
+		GR_PORT=$SSH_PORT
+	elif [ &quot;$SOUND_PORT&quot; == &quot;&quot; ]; then
+		SOUND_PORT=$SSH_PORT
+	else
+		FS_PORT=$SSH_PORT
+	fi
 done
 
 
-
-if [ &quot;$X2GO_GEOMETRY&quot; == &quot;&quot; ]
-then
-    X2GO_GEOMETRY=fullscreen
+if [ &quot;$X2GO_GEOMETRY&quot; == &quot;&quot; ]; then
+	X2GO_GEOMETRY=fullscreen
 fi
 
-if [ &quot;$X2GO_GEOMETRY&quot; == &quot;fullscreen&quot; ]
-then
-    X2GO_RESIZE=1
-    X2GO_FULLSCREEN=1
+if [ &quot;$X2GO_GEOMETRY&quot; == &quot;fullscreen&quot; ]; then
+	X2GO_RESIZE=1
+	X2GO_FULLSCREEN=1
 fi
-if [ &quot;$X2GO_STYPE&quot; == &quot;S&quot; ]
-then
-    X2GO_GEOMETRY=`DISPLAY=$SHADOW_DESKTOP xwininfo -root | grep geometry`
-    X2GO_GEOMETRY=`echo &quot;$X2GO_GEOMETRY&quot; | sed  -e  &quot;s/ //g&quot;`
-    X2GO_GEOMETRY=`echo &quot;$X2GO_GEOMETRY&quot; | sed  -e  &quot;s/-geometry//&quot;`
+
+if [ &quot;$X2GO_STYPE&quot; == &quot;S&quot; ]; then
+	X2GO_GEOMETRY=`DISPLAY=$SHADOW_DESKTOP xwininfo -root | grep geometry`
+	X2GO_GEOMETRY=`echo &quot;$X2GO_GEOMETRY&quot; | sed  -e  &quot;s/ //g&quot;`
+	X2GO_GEOMETRY=`echo &quot;$X2GO_GEOMETRY&quot; | sed  -e  &quot;s/-geometry//&quot;`
 fi
 
 SESSION_DIR=${X2GO_ROOT}/C-${SESSION_NAME}
 
-if [ ! -d $X2GO_ROOT ]
-then
-    mkdir $X2GO_ROOT
+if [ ! -d $X2GO_ROOT ]; then
+	mkdir $X2GO_ROOT
 fi
 
-if [ ! -d $X2GO_ROOT/ssh ]
-then
-    mkdir $X2GO_ROOT/ssh
+if [ ! -d $X2GO_ROOT/ssh ]; then
+	mkdir $X2GO_ROOT/ssh
 fi
 
-if [ ! -d $SESSION_DIR ]
-then
-    mkdir $SESSION_DIR
+if [ ! -d $SESSION_DIR ]; then
+	mkdir $SESSION_DIR
 fi
 
 X2GO_COOKIE=`mcookie`
@@ -210,55 +186,38 @@ xauth add ${HOSTNAME}/unix:${X2GO_PORT} MIT-MAGIC-COOKIE-1 ${X2GO_COOKIE}
 xauth add ${HOSTNAME}:${X2GO_PORT} MIT-MAGIC-COOKIE-1 ${X2GO_COOKIE}
 
 
-
 if [ &quot;$X2GO_SET_KBD&quot; == &quot;0&quot; ]
 then
-X2GO_HOST=nx/nx,link=${X2GO_LINK},pack=${X2GO_PACK},limit=0,root=${SESSION_DIR},cache=8M,images=32M,type=${X2GO_TYPE},\
-id=${SESSION_NAME},\
-cookie=$X2GO_COOKIE,errors=${SESSION_DIR}/session.log,kbtype=null/null,\
-geometry=${X2GO_GEOMETRY},resize=${X2GO_RESIZE},fullscreen=${X2GO_FULLSCREEN},accept=${REMOTE},listen=${GR_PORT},client=linux,menu=0
+    X2GO_HOST=&quot;nx/nx,link=${X2GO_LINK},pack=${X2GO_PACK},limit=0,root=${SESSION_DIR},cache=8M,images=32M,type=${X2GO_TYPE},id=${SESSION_NAME},cookie=$X2GO_COOKIE,errors=${SESSION_DIR}/session.log,kbtype=null/null,geometry=${X2GO_GEOMETRY},resize=${X2GO_RESIZE},fullscreen=${X2GO_FULLSCREEN},accept=${REMOTE},listen=${GR_PORT},client=linux,menu=0&quot;
 else
-X2GO_HOST=nx/nx,link=${X2GO_LINK},pack=${X2GO_PACK},limit=0,root=${SESSION_DIR},cache=8M,images=32M,type=${X2GO_TYPE},\
-id=${SESSION_NAME},\
-cookie=$X2GO_COOKIE,errors=${SESSION_DIR}/session.log,kbtype=${X2GO_KBD_TYPE},\
-geometry=${X2GO_GEOMETRY},resize=${X2GO_RESIZE},fullscreen=${X2GO_FULLSCREEN},accept=${REMOTE},listen=${GR_PORT},client=linux,menu=0
+    X2GO_HOST=&quot;nx/nx,link=${X2GO_LINK},pack=${X2GO_PACK},limit=0,root=${SESSION_DIR},cache=8M,images=32M,type=${X2GO_TYPE},id=${SESSION_NAME},cookie=$X2GO_COOKIE,errors=${SESSION_DIR}/session.log,kbtype=${X2GO_KBD_TYPE},geometry=${X2GO_GEOMETRY},resize=${X2GO_RESIZE},fullscreen=${X2GO_FULLSCREEN},accept=${REMOTE},listen=${GR_PORT},client=linux,menu=0&quot;
 fi
 
 
-
 echo &quot;${X2GO_HOST}:${X2GO_PORT}&quot; &gt;${SESSION_DIR}/options
 
-NX_AGENT=:${X2GO_PORT}
-
-
-SAVED_DISPLAY=$DISPLAY
-
-DISPLAY=nx/nx,options=${SESSION_DIR}/options:${X2GO_PORT} 
+NX_AGENT=&quot;:${X2GO_PORT}&quot;
+SAVED_DISPLAY=&quot;$DISPLAY&quot;
+DISPLAY=&quot;nx/nx,options=${SESSION_DIR}/options:${X2GO_PORT}&quot;
 export DISPLAY
 
 
-if [ &quot;$X2GODPI&quot; == &quot;&quot; ]
-then
-     X2GODPIOPTION_=&quot;&quot;
+if [ &quot;$X2GODPI&quot; == &quot;&quot; ]; then
+	X2GODPIOPTION_=&quot;&quot;
 else
-     X2GODPIOPTION_=&quot;-dpi $X2GODPI&quot;
+	X2GODPIOPTION_=&quot;-dpi $X2GODPI&quot;
 fi
 
-if [ &quot;$X2GOXDMCP&quot; == &quot;&quot; ]
-then
-    XDMCPOPT=&quot;&quot;
+if [ &quot;$X2GOXDMCP&quot; == &quot;&quot; ] ;then
+	XDMCPOPT=&quot;&quot;
 else
-    XDMCPOPT=&quot;-query $X2GOXDMCP&quot;
+	XDMCPOPT=&quot;-query $X2GOXDMCP&quot;
 fi
 
-if  [ &quot;$X2GO_STYPE&quot; == &quot;S&quot; ]
-then
-   LD_LIBRARY_PATH=$X2GO_LIB x2goagent $X2GODPIOPTION_  -$SESSION_TYPE -auth ~/.Xauthority \
-   -S -shadow $SHADOW_DESKTOP -shadowmode $SHADOW_MODE \
-   -geometry ${X2GO_GEOMETRY} -name &quot;X2GO-${SESSION_NAME}&quot;  ${NX_AGENT} 2&gt;${SESSION_DIR}/session.log &amp;
+if  [ &quot;$X2GO_STYPE&quot; == &quot;S&quot; ]; then
+	LD_LIBRARY_PATH=$X2GO_LIB x2goagent $X2GODPIOPTION_  -$SESSION_TYPE -auth ~/.Xauthority -S -shadow $SHADOW_DESKTOP -shadowmode $SHADOW_MODE -geometry ${X2GO_GEOMETRY} -name &quot;X2GO-${SESSION_NAME}&quot;  ${NX_AGENT} 2&gt;${SESSION_DIR}/session.log &amp;
 else
-   LD_LIBRARY_PATH=$X2GO_LIB x2goagent $X2GODPIOPTION_ $XDMCPOPT  -$SESSION_TYPE -auth ~/.Xauthority \
-   -geometry ${X2GO_GEOMETRY} -name &quot;X2GO-${SESSION_NAME}&quot;  ${NX_AGENT} 2&gt;${SESSION_DIR}/session.log &amp;
+	LD_LIBRARY_PATH=$X2GO_LIB x2goagent $X2GODPIOPTION_ $XDMCPOPT  -$SESSION_TYPE -auth ~/.Xauthority -geometry ${X2GO_GEOMETRY} -name &quot;X2GO-${SESSION_NAME}&quot;  ${NX_AGENT} 2&gt;${SESSION_DIR}/session.log &amp;
 fi
 
 X2GO_AGENT_PID=$!
diff --git a/x2goserver/bin/x2goumount-session b/x2goserver/bin/x2goumount-session
index 92228a6..c673ad0 100755
--- a/x2goserver/bin/x2goumount-session
+++ b/x2goserver/bin/x2goumount-session
@@ -34,12 +34,12 @@ my $only_path=shift;
 my $uname=$ENV{'USER'};
 my $serv=hostname;
 
-if($only_path)
+if ($only_path)
 {
-    $only_path=~s/\/ramdrive\/mnt\///;
-    $only_path=~ s/\//_/g;
-    my $end=&quot;_media&quot;;
-    $only_path=&quot;$ENV{'HOME'}/media/$only_path&quot;;
+	$only_path=~s/\/ramdrive\/mnt\///;
+	$only_path=~ s/\//_/g;
+	my $end=&quot;_media&quot;;
+	$only_path=&quot;$ENV{'HOME'}/media/$only_path&quot;;
 }
 
 
@@ -55,82 +55,80 @@ close(F);
 
 my $use_zenity=0;
 
-if($ENV{'GNOME_DESKTOP_SESSION_ID'} ne &quot;&quot;)
+if ($ENV{'GNOME_DESKTOP_SESSION_ID'} ne &quot;&quot;)
 {
-     $use_zenity=1;
+	$use_zenity=1;
 }
 
 
-for($i=0;$i&lt;@outp;$i++)
+for ($i=0;$i&lt;@outp;$i++)
 {
-    @outp[$i]=~s/ //g;
-    chomp(@outp[$i]);
-    chomp(@outp[$i]);
-    chomp(@outp[$i]);    
-    my @line=split('\|',&quot;@outp[$i]&quot;);
-    my $path=&quot;@line[0]:@line[1]&quot;;
-    if($only_path)
-    {
-         if (@line[1] ne $only_path)
-	 {
-	       goto cont;
-	 }
-    }
-    my $j;
-    my $found=0;
-    my $remote;
-    for($j;$j&lt;@mounts;$j++)
-    {
-          if(@mounts[$j]=~m/sshfs/ &amp;&amp; @mounts[$j]=~m/@line[0]/ &amp;&amp; @mounts[$j]=~m/@line[1]/ )
-	  {
-	      $found=1;
-	      $remote=(split(&quot; &quot;<A HREF="https://lists.berlios.de/mailman/listinfo/x2go-commits">, at mounts</A>[$j]))[0];
-              goto break;
-	  }
-    }
-break:
-    if($found) 
-    {
-       if(system( &quot;fusermount -u @line[1]&quot; ) == 0)
-       {       
-	    $found=0;
-       }
-       else
-       {
-                 $ENV{'DISPLAY'}=&quot;:$display&quot;;
-                 if($use_zenity == 0)
-		 {
-        	    system(&quot;kdialog --error \&quot;@line[1]\&quot;&amp;&quot;);
-		 }
-		 else
-		 {
-                    system(&quot;zenity --error --text \&quot;@line[1]\&quot;&amp;&quot;);
-		 }
-       }
-    }
-    if(! $found)
-    {
-	$remote=~s/\//_/g;
-	$remote=(split(&quot;:&quot;,&quot;$remote&quot;))[1];
-	$remote=&quot;$ENV{'HOME'}/Desktop/$remote&quot;;
-	if( -e &quot;$remote(sshfs-disk)&quot;)
+	@outp[$i]=~s/ //g;
+	chomp(@outp[$i]);
+	chomp(@outp[$i]);
+	chomp(@outp[$i]);    
+	my @line=split('\|',&quot;@outp[$i]&quot;);
+	my $path=&quot;@line[0]:@line[1]&quot;;
+	if ($only_path)
+	{
+		if (@line[1] ne $only_path)
+		{
+			goto cont;
+		}
+	}
+	my $j;
+	my $found=0;
+	my $remote;
+	for ($j;$j&lt;@mounts;$j++)
 	{
-	   unlink(&quot;$remote(sshfs-disk)&quot;);
+		if (@mounts[$j]=~m/sshfs/ &amp;&amp; @mounts[$j]=~m/@line[0]/ &amp;&amp; @mounts[$j]=~m/@line[1]/ )
+		{
+			$found=1;
+			$remote=(split(&quot; &quot;<A HREF="https://lists.berlios.de/mailman/listinfo/x2go-commits">, at mounts</A>[$j]))[0];
+			goto break;
+		}
 	}
-	
-	$remote=~s/%2framdrive%2fmnt%2f//;
-	if( -e &quot;$remote(sshfs-removable)&quot;)
+break:
+	if ($found)
 	{
-	   unlink(&quot;$remote(sshfs-removable)&quot;);
+		if (system( &quot;fusermount -u @line[1]&quot; ) == 0)
+		{
+			$found=0;
+		}
+		else
+		{
+			$ENV{'DISPLAY'}=&quot;:$display&quot;;
+			if ($use_zenity == 0)
+			{
+				system(&quot;kdialog --error \&quot;@line[1]\&quot;&amp;&quot;);
+			}
+			else
+			{
+				system(&quot;zenity --error --text \&quot;@line[1]\&quot;&amp;&quot;);
+			}
+		}
 	}
-	if( -e &quot;$remote(sshfs-cdrom)&quot;)
+	if (! $found)
 	{
-	   unlink(&quot;$remote(sshfs-cdrom)&quot;);
+		$remote=~s/\//_/g;
+		$remote=(split(&quot;:&quot;,&quot;$remote&quot;))[1];
+		$remote=&quot;$ENV{'HOME'}/Desktop/$remote&quot;;
+		if ( -e &quot;$remote(sshfs-disk)&quot;)
+		{
+		   unlink(&quot;$remote(sshfs-disk)&quot;);
+		}
+		$remote=~s/%2framdrive%2fmnt%2f//;
+		if ( -e &quot;$remote(sshfs-removable)&quot;)
+		{
+			unlink(&quot;$remote(sshfs-removable)&quot;);
+		}
+		if ( -e &quot;$remote(sshfs-cdrom)&quot;)
+		{
+			unlink(&quot;$remote(sshfs-cdrom)&quot;);
+		}
+		db_deletemount ($session, @line[1]);
+		rmdir (@line[1]);
 	}
-        #print &quot;$session \&quot;@line[1]\&quot;\n&quot;; 
-	db_deletemount ($session, @line[1]);
-        rmdir (@line[1]);
-    }
-cont:    
+cont:
 }
 
diff --git a/x2goserver/lib/x2godbwrapper.pm b/x2goserver/lib/x2godbwrapper.pm
index be84bc8..b30185b 100644
--- a/x2goserver/lib/x2godbwrapper.pm
+++ b/x2goserver/lib/x2godbwrapper.pm
@@ -21,8 +21,8 @@
 package x2godbwrapper;
 
 use strict;
-use Config::Simple;   
-use DBI;   
+use Config::Simple;
+use DBI;
 
 use POSIX;
 
@@ -39,285 +39,274 @@ my $dbpass;
 my $dbuser;
 my $sslmode;
 
-if($backend ne 'postgres' &amp;&amp; $backend ne 'sqlite')
+if ($backend ne 'postgres' &amp;&amp; $backend ne 'sqlite')
 {
-  die &quot;unknown backend $backend&quot;;
+	die &quot;unknown backend $backend&quot;;
 }
 
-if($backend eq 'postgres')
+if ($backend eq 'postgres')
 {
-  $host=$Config-&gt;param(&quot;postgres.host&quot;);
-  $port=$Config-&gt;param(&quot;postgres.port&quot;);
-  if(!$host)
-  {
-    $host='localhost';
-  }
-  if(!$port)
-  {
-    $port='5432';
-  }
-  my $passfile;
-  if($uname eq 'root')
-  {
-    $dbuser='x2godbuser';
-    $passfile=&quot;/etc/x2go/x2gosql/passwords/x2goadmin&quot;;
-  }
-  else
-  {
-    $dbuser=&quot;x2gouser_$uname&quot;;
-    $passfile=&quot;$homedir/.x2go/sqlpass&quot;;
-  }
-  $sslmode=$Config-&gt;param(&quot;postgres.ssl&quot;);
-  if(!$sslmode)
-  {
-         $sslmode=&quot;prefer&quot;;
-  }
-  open (FL,&quot;&lt; $passfile&quot;) or die &quot;Can't read password file $passfile&lt;br&gt;&lt;b&gt;Use x2godbadmin on server to configure database access for user $uname&lt;/b&gt;&lt;br&gt;&quot;;
-  $dbpass=&lt;FL&gt;;
-  close(FL);
-  chomp($dbpass);
+	$host=$Config-&gt;param(&quot;postgres.host&quot;);
+	$port=$Config-&gt;param(&quot;postgres.port&quot;);
+	if (!$host)
+	{
+		$host='localhost';
+	}
+	if (!$port)
+	{
+		$port='5432';
+	}
+	my $passfile;
+	if ($uname eq 'root')
+	{
+		$dbuser='x2godbuser';
+		$passfile=&quot;/etc/x2go/x2gosql/passwords/x2goadmin&quot;;
+	}
+	else
+	{
+		$dbuser=&quot;x2gouser_$uname&quot;;
+		$passfile=&quot;$homedir/.x2go/sqlpass&quot;;
+	}
+	$sslmode=$Config-&gt;param(&quot;postgres.ssl&quot;);
+	if (!$sslmode)
+	{
+		$sslmode=&quot;prefer&quot;;
+	}
+	open (FL,&quot;&lt; $passfile&quot;) or die &quot;Can't read password file $passfile&lt;br&gt;&lt;b&gt;Use x2godbadmin on server to configure database access for user $uname&lt;/b&gt;&lt;br&gt;&quot;;
+	$dbpass=&lt;FL&gt;;
+	close(FL);
+	chomp($dbpass);
 }
 
 use base 'Exporter';
 
 our @EXPORT=('db_listsessions','db_listsessions_all', 'db_getservers', 'db_getagent', 'db_resume', 'db_changestatus', 
-	     'db_getdisplays', 'db_insertsession', 'db_getports', 'db_insertport', 'db_createsession', 'db_insertmount', 
-	     'db_getmounts', 'db_deletemount', 'db_getdisplay', 'dbsys_getmounts', 'dbsys_listsessionsroot', 
-	     'dbsys_listsessionsroot_all', 'dbsys_rmsessionsroot');
+             'db_getdisplays', 'db_insertsession', 'db_getports', 'db_insertport', 'db_createsession', 'db_insertmount', 
+             'db_getmounts', 'db_deletemount', 'db_getdisplay', 'dbsys_getmounts', 'dbsys_listsessionsroot', 
+             'dbsys_listsessionsroot_all', 'dbsys_rmsessionsroot');
 
-	     
-	     
-	     
- 
 sub dbsys_rmsessionsroot
 {
-       my $sid=shift or die &quot;argument \&quot;session_id\&quot; missed&quot;;
-       if($backend eq 'postgres')
-       {
-	       my $dbh=DBI-&gt;connect(&quot;dbi:Pg:dbname=$db;host=$host;port=$port;sslmode=$sslmode&quot;, 
-	       &quot;$dbuser&quot;, &quot;$dbpass&quot;,{AutoCommit =&gt; 1}) or die $_;
-	       
-	       my $sth=$dbh-&gt;prepare(&quot;delete from sessions  where session_id='$sid'&quot;);
-               $sth-&gt;execute()or die;
-       }
-       if($backend eq 'sqlite')
-       {
-	   `x2gosqlitewrapper rmsessionsroot $sid`;
-       }
+	my $sid=shift or die &quot;argument \&quot;session_id\&quot; missed&quot;;
+	if($backend eq 'postgres')
+	{
+		my $dbh=DBI-&gt;connect(&quot;dbi:Pg:dbname=$db;host=$host;port=$port;sslmode=$sslmode&quot;, 
+		                     &quot;$dbuser&quot;, &quot;$dbpass&quot;,{AutoCommit =&gt; 1}) or die $_;
+
+		my $sth=$dbh-&gt;prepare(&quot;delete from sessions  where session_id='$sid'&quot;);
+		$sth-&gt;execute() or die;
+	}
+	if($backend eq 'sqlite')
+	{
+		`x2gosqlitewrapper rmsessionsroot $sid`;
+	}
 }
 
 sub dbsys_listsessionsroot
 {
-       my $server=shift or die &quot;argument \&quot;server\&quot; missed&quot;;
-       if($backend eq 'postgres')
-       {
-       my @strings;
-	       my $dbh=DBI-&gt;connect(&quot;dbi:Pg:dbname=$db;host=$host;port=$port;sslmode=$sslmode&quot;, 
-	       &quot;$dbuser&quot;, &quot;$dbpass&quot;,{AutoCommit =&gt; 1}) or die $_;
-	       
-	       my $sth=$dbh-&gt;prepare(&quot;select agent_pid, session_id, display, server, status,
-				     to_char(init_time,'DD.MM.YY*HH24:MI:SS'),cookie,client,gr_port,
-				     sound_port,to_char(last_time,'DD.MM.YY*HH24:MI:SS'),uname,
-				     to_char(now()-init_time,'SSSS'),fs_port  from  sessions
-				     where server='$server'  order by status desc&quot;);
-               $sth-&gt;execute()or die;
-               my @data;
-	       my $i=0;
-               while (@data = $sth-&gt;fetchrow_array) 
-               {
-		   @strings[$i++]=join('|'<A HREF="https://lists.berlios.de/mailman/listinfo/x2go-commits">, at data</A>);
-               }
-	       $sth-&gt;finish();
-	       $dbh-&gt;disconnect();
-       return @strings;
-       }
-       if($backend eq 'sqlite')
-       {
-	   return split(&quot;\n&quot;,`x2gosqlitewrapper listsessionsroot $server`);
-       }
+	my $server=shift or die &quot;argument \&quot;server\&quot; missed&quot;;
+	if ($backend eq 'postgres')
+	{
+		my @strings;
+		my $dbh=DBI-&gt;connect(&quot;dbi:Pg:dbname=$db;host=$host;port=$port;sslmode=$sslmode&quot;, 
+		                     &quot;$dbuser&quot;, &quot;$dbpass&quot;,{AutoCommit =&gt; 1}) or die $_;
+
+		my $sth=$dbh-&gt;prepare(&quot;select agent_pid, session_id, display, server, status,
+		                      to_char(init_time,'DD.MM.YY*HH24:MI:SS'),cookie,client,gr_port,
+		                      sound_port,to_char(last_time,'DD.MM.YY*HH24:MI:SS'),uname,
+		                      to_char(now()-init_time,'SSSS'),fs_port  from  sessions
+		                      where server='$server'  order by status desc&quot;);
+		$sth-&gt;execute()or die;
+		my @data;
+		my $i=0;
+		while (@data = $sth-&gt;fetchrow_array) 
+		{
+			@strings[$i++]=join('|'<A HREF="https://lists.berlios.de/mailman/listinfo/x2go-commits">, at data</A>);
+		}
+		$sth-&gt;finish();
+		$dbh-&gt;disconnect();
+		return @strings;
+	}
+	if($backend eq 'sqlite')
+	{
+		return split(&quot;\n&quot;,`x2gosqlitewrapper listsessionsroot $server`);
+	}
 }
 
 sub dbsys_listsessionsroot_all
 {
-       if($backend eq 'postgres')
-       {
-       my @strings;
-	       my $dbh=DBI-&gt;connect(&quot;dbi:Pg:dbname=$db;host=$host;port=$port;sslmode=$sslmode&quot;, &quot;$dbuser&quot;, &quot;$dbpass&quot;,{AutoCommit =&gt; 1}) or die $_;
-	       
-	       my $sth=$dbh-&gt;prepare(&quot;select agent_pid, session_id, display, server, status,
-				     to_char(init_time,'DD.MM.YY*HH24:MI:SS'),cookie,client,gr_port,
-				     sound_port,to_char(last_time,'DD.MM.YY*HH24:MI:SS'),uname,
-				     to_char(now()-init_time,'SSSS'),fs_port  from  sessions
-				     order by status desc&quot;);
-               $sth-&gt;execute()or die;
-               my @data;
-	       my $i=0;
-               while (@data = $sth-&gt;fetchrow_array) 
-               {
-		   @strings[$i++]=join('|'<A HREF="https://lists.berlios.de/mailman/listinfo/x2go-commits">, at data</A>);
-               }
-	       $sth-&gt;finish();
-	       $dbh-&gt;disconnect();
-       return @strings;
-       }
-       if($backend eq 'sqlite')
-       {
-	   return split(&quot;\n&quot;,`x2gosqlitewrapper listsessionsroot_all`);
-       }
+	if ($backend eq 'postgres')
+	{
+		my @strings;
+		my $dbh=DBI-&gt;connect(&quot;dbi:Pg:dbname=$db;host=$host;port=$port;sslmode=$sslmode&quot;, &quot;$dbuser&quot;, &quot;$dbpass&quot;,{AutoCommit =&gt; 1}) or die $;
+		my $sth=$dbh-&gt;prepare(&quot;select agent_pid, session_id, display, server, status,
+		                      to_char(init_time,'DD.MM.YY*HH24:MI:SS'),cookie,client,gr_port,
+		                      sound_port,to_char(last_time,'DD.MM.YY*HH24:MI:SS'),uname,
+		                      to_char(now()-init_time,'SSSS'),fs_port  from  sessions
+		                      order by status desc&quot;);
+		$sth-&gt;execute()or die;
+		my @data;
+		my $i=0;
+		while (@data = $sth-&gt;fetchrow_array) 
+		{
+			@strings[$i++]=join('|'<A HREF="https://lists.berlios.de/mailman/listinfo/x2go-commits">, at data</A>);
+		}
+		$sth-&gt;finish();
+		$dbh-&gt;disconnect();
+		return @strings;
+	}
+	if ($backend eq 'sqlite')
+	{
+		return split(&quot;\n&quot;,`x2gosqlitewrapper listsessionsroot_all`);
+	}
 }
 
-	     
 sub dbsys_getmounts
 {
-       my $sid=shift or die &quot;argument \&quot;session_id\&quot; missed&quot;;
-       if($backend eq 'postgres')
-       {
-       my @strings;
-	       my $dbh=DBI-&gt;connect(&quot;dbi:Pg:dbname=$db;host=$host;port=$port;sslmode=$sslmode&quot;, &quot;$dbuser&quot;, &quot;$dbpass&quot;,{AutoCommit =&gt; 1}) or die $_;
-	       my $sth=$dbh-&gt;prepare(&quot;select client, path from mounts where session_id='$sid'&quot;);
-               $sth-&gt;execute()or die;
-               my @data;
-	       my $i=0;
-               while (@data = $sth-&gt;fetchrow_array) 
-               {
-		   @strings[$i++]=join(&quot;|&quot;<A HREF="https://lists.berlios.de/mailman/listinfo/x2go-commits">, at data</A>);
-               }
-	       $sth-&gt;finish();
-	       $dbh-&gt;disconnect();
-       return @strings;
-       }
-       if($backend eq 'sqlite')
-       {
-	   return split(&quot;\n&quot;,`x2gosqlitewrapper getmounts $sid`);
-       }
-
+	my $sid=shift or die &quot;argument \&quot;session_id\&quot; missed&quot;;
+	if ($backend eq 'postgres')
+	{
+		my @strings;
+		my $dbh=DBI-&gt;connect(&quot;dbi:Pg:dbname=$db;host=$host;port=$port;sslmode=$sslmode&quot;, &quot;$dbuser&quot;, &quot;$dbpass&quot;,{AutoCommit =&gt; 1}) or die $_;
+		my $sth=$dbh-&gt;prepare(&quot;select client, path from mounts where session_id='$sid'&quot;);
+		$sth-&gt;execute()or die;
+		my @data;
+		my $i=0;
+		while (@data = $sth-&gt;fetchrow_array) 
+		{
+			@strings[$i++]=join(&quot;|&quot;<A HREF="https://lists.berlios.de/mailman/listinfo/x2go-commits">, at data</A>);
+		}
+		$sth-&gt;finish();
+		$dbh-&gt;disconnect();
+		return @strings;
+	}
+	if ($backend eq 'sqlite')
+	{
+		return split(&quot;\n&quot;,`x2gosqlitewrapper getmounts $sid`);
+	}
 }
 
 sub db_getmounts
 {
-       my $sid=shift or die &quot;argument \&quot;session_id\&quot; missed&quot;;
-       if($backend eq 'postgres')
-       {
-       my @strings;
-	       my $dbh=DBI-&gt;connect(&quot;dbi:Pg:dbname=$db;host=$host;port=$port;sslmode=$sslmode&quot;, &quot;$dbuser&quot;, &quot;$dbpass&quot;,{AutoCommit =&gt; 1}) or die $_;
-	       my $sth=$dbh-&gt;prepare(&quot;select client, path from mounts_view where session_id='$sid'&quot;);
-               $sth-&gt;execute()or die;
-               my @data;
-	       my $i=0;
-               while (@data = $sth-&gt;fetchrow_array) 
-               {
-		   @strings[$i++]=join(&quot;|&quot;<A HREF="https://lists.berlios.de/mailman/listinfo/x2go-commits">, at data</A>);
-               }
-	       $sth-&gt;finish();
-	       $dbh-&gt;disconnect();
-       return @strings;
-       }
-       if($backend eq 'sqlite')
-       {
-	   return split(&quot;\n&quot;,`x2gosqlitewrapper getmounts $sid`);
-       }
+	my $sid=shift or die &quot;argument \&quot;session_id\&quot; missed&quot;;
+	if($backend eq 'postgres')
+	{
+		my @strings;
+		my $dbh=DBI-&gt;connect(&quot;dbi:Pg:dbname=$db;host=$host;port=$port;sslmode=$sslmode&quot;, &quot;$dbuser&quot;, &quot;$dbpass&quot;,{AutoCommit =&gt; 1}) or die $_;
+		my $sth=$dbh-&gt;prepare(&quot;select client, path from mounts_view where session_id='$sid'&quot;);
+		$sth-&gt;execute()or die;
+		my @data;
+		my $i=0;
+		while (@data = $sth-&gt;fetchrow_array) 
+		{
+			@strings[$i++]=join(&quot;|&quot;<A HREF="https://lists.berlios.de/mailman/listinfo/x2go-commits">, at data</A>);
+		}
+		$sth-&gt;finish();
+		$dbh-&gt;disconnect();
+		return @strings;
+	}
+	if ($backend eq 'sqlite')
+	{
+		return split(&quot;\n&quot;,`x2gosqlitewrapper getmounts $sid`);
+	}
 }
-	     
+
 sub db_deletemount
 {
-       my $sid=shift or die &quot;argument \&quot;session_id\&quot; missed&quot;;
-       my $path=shift or die &quot;argument \&quot;path\&quot; missed&quot;;
-       if($backend eq 'postgres')
-       {
-	       my $dbh=DBI-&gt;connect(&quot;dbi:Pg:dbname=$db;host=$host;port=$port;sslmode=$sslmode&quot;, &quot;$dbuser&quot;, &quot;$dbpass&quot;,{AutoCommit =&gt; 1}) or die $_;	       
-	       my $sth=$dbh-&gt;prepare(&quot;delete from mounts_view where session_id='$sid' and path='$path'&quot;);
-               $sth-&gt;execute();
-               $sth-&gt;finish();
-	       $dbh-&gt;disconnect();
-       }
-       if($backend eq 'sqlite')
-       {
-	   `x2gosqlitewrapper deletemount $sid \&quot;$path\&quot;`;
-       }
-
+	my $sid=shift or die &quot;argument \&quot;session_id\&quot; missed&quot;;
+	my $path=shift or die &quot;argument \&quot;path\&quot; missed&quot;;
+	if ($backend eq 'postgres')
+	{
+		my $dbh=DBI-&gt;connect(&quot;dbi:Pg:dbname=$db;host=$host;port=$port;sslmode=$sslmode&quot;, &quot;$dbuser&quot;, &quot;$dbpass&quot;,{AutoCommit =&gt; 1}) or die $_;	       
+		my $sth=$dbh-&gt;prepare(&quot;delete from mounts_view where session_id='$sid' and path='$path'&quot;);
+		$sth-&gt;execute();
+		$sth-&gt;finish();
+		$dbh-&gt;disconnect();
+	}
+	if ($backend eq 'sqlite')
+	{
+		`x2gosqlitewrapper deletemount $sid \&quot;$path\&quot;`;
+	}
 }
 
 sub db_insertmount
 {
-       my $sid=shift or die &quot;argument \&quot;session_id\&quot; missed&quot;;
-       my $path=shift or die &quot;argument \&quot;path\&quot; missed&quot;;
-       my $client=shift or die &quot;argument \&quot;client\&quot; missed&quot;;
-       my $res_ok=1;
-       if($backend eq 'postgres')
-       {
-	       my $dbh=DBI-&gt;connect(&quot;dbi:Pg:dbname=$db;host=$host;port=$port;sslmode=$sslmode&quot;, &quot;$dbuser&quot;, &quot;$dbpass&quot;,{AutoCommit =&gt; 1}) or die $_;	       
-	       my $sth=$dbh-&gt;prepare(&quot;insert into mounts (session_id,path,client) values  ('$sid','$path','$client')&quot;);
-               $sth-&gt;execute();
-	       if(!$sth-&gt;err())
-	       {
-		 $res_ok=1;
-	       }
-               $sth-&gt;finish();
-	       $dbh-&gt;disconnect();
-       }
-       if($backend eq 'sqlite')
-       {
-	   if( `x2gosqlitewrapper insertmount $sid \&quot;$path\&quot; $client` eq &quot;ok&quot;)
-	   {
-	     $res_ok=1;
-	   }
-       }
-       return $res_ok;
+	my $sid=shift or die &quot;argument \&quot;session_id\&quot; missed&quot;;
+	my $path=shift or die &quot;argument \&quot;path\&quot; missed&quot;;
+	my $client=shift or die &quot;argument \&quot;client\&quot; missed&quot;;
+	my $res_ok=1;
+	if ($backend eq 'postgres')
+	{
+		my $dbh=DBI-&gt;connect(&quot;dbi:Pg:dbname=$db;host=$host;port=$port;sslmode=$sslmode&quot;, &quot;$dbuser&quot;, &quot;$dbpass&quot;,{AutoCommit =&gt; 1}) or die $_;	       
+		my $sth=$dbh-&gt;prepare(&quot;insert into mounts (session_id,path,client) values  ('$sid','$path','$client')&quot;);
+		$sth-&gt;execute();
+		if (!$sth-&gt;err())
+		{
+			$res_ok=1;
+		}
+		$sth-&gt;finish();
+		$dbh-&gt;disconnect();
+	}
+	if ($backend eq 'sqlite')
+	{
+		if( `x2gosqlitewrapper insertmount $sid \&quot;$path\&quot; $client` eq &quot;ok&quot;)
+		{
+			$res_ok=1;
+		}
+	}
+	return $res_ok;
 }
 
-	     
 sub db_insertsession
 {
 	my $display=shift or die &quot;argument \&quot;display\&quot; missed&quot;;
 	my $server=shift or die &quot;argument \&quot;server\&quot; missed&quot;;
-        my $sid=shift or die &quot;argument \&quot;session_id\&quot; missed&quot;;
-       if($backend eq 'postgres')
-       {
-	       my $dbh=DBI-&gt;connect(&quot;dbi:Pg:dbname=$db;host=$host;port=$port;sslmode=$sslmode&quot;, &quot;$dbuser&quot;, &quot;$dbpass&quot;,{AutoCommit =&gt; 1}) or die $_;	       
-	       my $sth=$dbh-&gt;prepare(&quot;insert into sessions (display,server,uname,session_id) values ('$display','$server','$uname','$sid')&quot;);
-               $sth-&gt;execute()or die $_;
-               $sth-&gt;finish();
-	       $dbh-&gt;disconnect();
-       }
-       if($backend eq 'sqlite')
-       {
-	   my $err=`x2gosqlitewrapper insertsession $display $server $sid`;
-	   if($err ne &quot;ok&quot;)
-	   {
-	     die &quot;$err: x2gosqlitewrapper insertsession $display $server $sid&quot;;
-	   }
-       }
-
+	my $sid=shift or die &quot;argument \&quot;session_id\&quot; missed&quot;;
+	if ($backend eq 'postgres')
+	{
+		my $dbh=DBI-&gt;connect(&quot;dbi:Pg:dbname=$db;host=$host;port=$port;sslmode=$sslmode&quot;, &quot;$dbuser&quot;, &quot;$dbpass&quot;,{AutoCommit =&gt; 1}) or die $_;	       
+		my $sth=$dbh-&gt;prepare(&quot;insert into sessions (display,server,uname,session_id) values ('$display','$server','$uname','$sid')&quot;);
+		$sth-&gt;execute()or die $_;
+		$sth-&gt;finish();
+		$dbh-&gt;disconnect();
+	}
+	if ($backend eq 'sqlite')
+	{
+		my $err=`x2gosqlitewrapper insertsession $display $server $sid`;
+		if ($err ne &quot;ok&quot;)
+		{
+			die &quot;$err: x2gosqlitewrapper insertsession $display $server $sid&quot;;
+		}
+	}
 }
 
 sub db_createsession
 {
-       my $cookie=shift or die&quot;argument \&quot;cookie\&quot; missed&quot;;
-       my $pid=shift or die&quot;argument \&quot;pid\&quot; missed&quot;;
-       my $client=shift or die&quot;argument \&quot;client\&quot; missed&quot;;
-       my $gr_port=shift or die&quot;argument \&quot;gr_port\&quot; missed&quot;;
-       my $snd_port=shift or die&quot;argument \&quot;snd_port\&quot; missed&quot;;
-       my $fs_port=shift or die&quot;argument \&quot;fs_port\&quot; missed&quot;;
-       my $sid=shift or die &quot;argument \&quot;session_id\&quot; missed&quot;;
-       if($backend eq 'postgres')
-       {
-	       my $dbh=DBI-&gt;connect(&quot;dbi:Pg:dbname=$db;host=$host;port=$port;sslmode=$sslmode&quot;, &quot;$dbuser&quot;, &quot;$dbpass&quot;,{AutoCommit =&gt; 1}) or die $_;	       
-	       my $sth=$dbh-&gt;prepare(&quot;update sessions_view set status='R',last_time=now(),
-				     cookie='$cookie',agent_pid='$pid',client='$client',gr_port='$gr_port',
-				     sound_port='$snd_port',fs_port='$fs_port' where session_id='$sid'&quot;);
-               $sth-&gt;execute()or die;
-	       $sth-&gt;finish();
-	       $dbh-&gt;disconnect();
-       }
-       if($backend eq 'sqlite')
-       {
-	   my $err= `x2gosqlitewrapper createsession $cookie $pid $client $gr_port $snd_port $fs_port $sid`;
-	   if($err ne &quot;ok&quot;)
-	   {
-	     die $err;
-	   }
-       }
-
+	my $cookie=shift or die&quot;argument \&quot;cookie\&quot; missed&quot;;
+	my $pid=shift or die&quot;argument \&quot;pid\&quot; missed&quot;;
+	my $client=shift or die&quot;argument \&quot;client\&quot; missed&quot;;
+	my $gr_port=shift or die&quot;argument \&quot;gr_port\&quot; missed&quot;;
+	my $snd_port=shift or die&quot;argument \&quot;snd_port\&quot; missed&quot;;
+	my $fs_port=shift or die&quot;argument \&quot;fs_port\&quot; missed&quot;;
+	my $sid=shift or die &quot;argument \&quot;session_id\&quot; missed&quot;;
+	if ($backend eq 'postgres')
+	{
+		my $dbh=DBI-&gt;connect(&quot;dbi:Pg:dbname=$db;host=$host;port=$port;sslmode=$sslmode&quot;, &quot;$dbuser&quot;, &quot;$dbpass&quot;,{AutoCommit =&gt; 1}) or die $_;	       
+		my $sth=$dbh-&gt;prepare(&quot;update sessions_view set status='R',last_time=now(),
+		                      cookie='$cookie',agent_pid='$pid',client='$client',gr_port='$gr_port',
+		                      sound_port='$snd_port',fs_port='$fs_port' where session_id='$sid'&quot;);
+		$sth-&gt;execute()or die;
+		$sth-&gt;finish();
+		$dbh-&gt;disconnect();
+	}
+	if ($backend eq 'sqlite')
+	{
+		my $err= `x2gosqlitewrapper createsession $cookie $pid $client $gr_port $snd_port $fs_port $sid`;
+		if ($err ne &quot;ok&quot;)
+		{
+			die $err;
+		}
+	}
 }
 
 sub db_insertport
@@ -325,252 +314,239 @@ sub db_insertport
 	my $server=shift or die &quot;argument \&quot;server\&quot; missed&quot;;
 	my $sid=shift or die &quot;argument \&quot;session_id\&quot; missed&quot;;
 	my $sshport=shift or die &quot;argument \&quot;port\&quot; missed&quot;;
-       if($backend eq 'postgres')
-       {
-	       my $dbh=DBI-&gt;connect(&quot;dbi:Pg:dbname=$db;host=$host;port=$port;sslmode=$sslmode&quot;, &quot;$dbuser&quot;, &quot;$dbpass&quot;,{AutoCommit =&gt; 1}) or die $_;	       
-	       my $sth=$dbh-&gt;prepare(&quot;insert into used_ports (server,session_id,port) values  ('$server','$sid','$sshport')&quot;);
-               $sth-&gt;execute()or die;
-	       $sth-&gt;finish();
-	       $dbh-&gt;disconnect();
-       }
-       if($backend eq 'sqlite')
-       {
-	   `x2gosqlitewrapper insertport $server $sid $sshport`;
-       }
-
+	if ($backend eq 'postgres')
+	{
+		my $dbh=DBI-&gt;connect(&quot;dbi:Pg:dbname=$db;host=$host;port=$port;sslmode=$sslmode&quot;, &quot;$dbuser&quot;, &quot;$dbpass&quot;,{AutoCommit =&gt; 1}) or die $_;	       
+		my $sth=$dbh-&gt;prepare(&quot;insert into used_ports (server,session_id,port) values  ('$server','$sid','$sshport')&quot;);
+		$sth-&gt;execute()or die;
+		$sth-&gt;finish();
+		$dbh-&gt;disconnect();
+	}
+	if ($backend eq 'sqlite')
+	{
+		`x2gosqlitewrapper insertport $server $sid $sshport`;
+	}
 }
 
-	     
 sub db_resume
 {
-       my $client=shift or die &quot;argument \&quot;client\&quot; missed&quot;;
-       my $sid=shift or die &quot;argument \&quot;session_id\&quot; missed&quot;;       
-       if($backend eq 'postgres')
-       {
-	       my $dbh=DBI-&gt;connect(&quot;dbi:Pg:dbname=$db;host=$host;port=$port;sslmode=$sslmode&quot;, &quot;$dbuser&quot;, &quot;$dbpass&quot;,{AutoCommit =&gt; 1}) or die $_;	       
-	       my $sth=$dbh-&gt;prepare(&quot;update sessions_view set last_time=now(),status='R',client='$client' where session_id = '$sid'&quot;);
-               $sth-&gt;execute()or die;
-	       $sth-&gt;finish();
-	       $dbh-&gt;disconnect();
-       }
-       if($backend eq 'sqlite')
-       {
-	   `x2gosqlitewrapper resume $client $sid`;
-       }
-
+	my $client=shift or die &quot;argument \&quot;client\&quot; missed&quot;;
+	my $sid=shift or die &quot;argument \&quot;session_id\&quot; missed&quot;;       
+	if ($backend eq 'postgres')
+	{
+		my $dbh=DBI-&gt;connect(&quot;dbi:Pg:dbname=$db;host=$host;port=$port;sslmode=$sslmode&quot;, &quot;$dbuser&quot;, &quot;$dbpass&quot;,{AutoCommit =&gt; 1}) or die $_;	       
+		my $sth=$dbh-&gt;prepare(&quot;update sessions_view set last_time=now(),status='R',client='$client' where session_id = '$sid'&quot;);
+		$sth-&gt;execute()or die;
+		$sth-&gt;finish();
+		$dbh-&gt;disconnect();
+	}
+	if ($backend eq 'sqlite')
+	{
+		`x2gosqlitewrapper resume $client $sid`;
+	}
 }
 
 sub db_changestatus
 {
-       my $status=shift or die &quot;argument \&quot;status\&quot; missed&quot;;
-       my $sid=shift or die &quot;argument \&quot;session_id\&quot; missed&quot;;       
-       if($backend eq 'postgres')
-       {
-	       my $dbh=DBI-&gt;connect(&quot;dbi:Pg:dbname=$db;host=$host;port=$port;sslmode=$sslmode&quot;, &quot;$dbuser&quot;, &quot;$dbpass&quot;,{AutoCommit =&gt; 1}) or die $_;	       
-	       my $sth=$dbh-&gt;prepare(&quot;update sessions_view set last_time=now(),status='$status' where session_id = '$sid'&quot;);
-               $sth-&gt;execute()or die;
-	       $sth-&gt;finish();
-	       $dbh-&gt;disconnect();
-       }
-       if($backend eq 'sqlite')
-       {
-	   `x2gosqlitewrapper changestatus $status $sid`;
-       }
-
+	my $status=shift or die &quot;argument \&quot;status\&quot; missed&quot;;
+	my $sid=shift or die &quot;argument \&quot;session_id\&quot; missed&quot;;       
+	if ($backend eq 'postgres')
+	{
+		my $dbh=DBI-&gt;connect(&quot;dbi:Pg:dbname=$db;host=$host;port=$port;sslmode=$sslmode&quot;, &quot;$dbuser&quot;, &quot;$dbpass&quot;,{AutoCommit =&gt; 1}) or die $_;	       
+		my $sth=$dbh-&gt;prepare(&quot;update sessions_view set last_time=now(),status='$status' where session_id = '$sid'&quot;);
+		$sth-&gt;execute()or die;
+		$sth-&gt;finish();
+		$dbh-&gt;disconnect();
+	}
+	if ($backend eq 'sqlite')
+	{
+	`x2gosqlitewrapper changestatus $status $sid`;
+	}
 }
 
 sub db_getdisplays
 {
-       #ignore $server
-       my $server=shift or die &quot;argument \&quot;server\&quot; missed&quot;;         
-       if($backend eq 'postgres')
-       {
-       my @strings;
-	       my $dbh=DBI-&gt;connect(&quot;dbi:Pg:dbname=$db;host=$host;port=$port;sslmode=$sslmode&quot;, &quot;$dbuser&quot;, &quot;$dbpass&quot;,{AutoCommit =&gt; 1}) or die $_;
-	       my $sth=$dbh-&gt;prepare(&quot;select display from servers_view&quot;);
-               $sth-&gt;execute()or die;
-               my @data;
-	       my $i=0;
-               while (@data = $sth-&gt;fetchrow_array) 
-               {
-		   @strings[$i++]='|'<A HREF="https://lists.berlios.de/mailman/listinfo/x2go-commits">. at data</A>[0].'|';
-               }
-	       $sth-&gt;finish();
-	       $dbh-&gt;disconnect();
-       return @strings;
-       }
-       if($backend eq 'sqlite')
-       {
-	   return split(&quot;\n&quot;,`x2gosqlitewrapper getdisplays $server`);
-       }
-
+	#ignore $server
+	my $server=shift or die &quot;argument \&quot;server\&quot; missed&quot;;         
+	if ($backend eq 'postgres')
+	{
+		my @strings;
+		my $dbh=DBI-&gt;connect(&quot;dbi:Pg:dbname=$db;host=$host;port=$port;sslmode=$sslmode&quot;, &quot;$dbuser&quot;, &quot;$dbpass&quot;,{AutoCommit =&gt; 1}) or die $_;
+		my $sth=$dbh-&gt;prepare(&quot;select display from servers_view&quot;);
+		$sth-&gt;execute()or die;
+		my @data;
+		my $i=0;
+		while (@data = $sth-&gt;fetchrow_array) 
+		{
+			@strings[$i++]='|'<A HREF="https://lists.berlios.de/mailman/listinfo/x2go-commits">. at data</A>[0].'|';
+		}
+		$sth-&gt;finish();
+		$dbh-&gt;disconnect();
+		return @strings;
+	}
+	if ($backend eq 'sqlite')
+	{
+		return split(&quot;\n&quot;,`x2gosqlitewrapper getdisplays $server`);
+	}
 }
 
 sub db_getports
 {
-       #ignore $server
-       my $server=shift or die &quot;argument \&quot;server\&quot; missed&quot;;         
-       if($backend eq 'postgres')
-       {
-       my @strings;
-	       my $dbh=DBI-&gt;connect(&quot;dbi:Pg:dbname=$db;host=$host;port=$port;sslmode=$sslmode&quot;, &quot;$dbuser&quot;, &quot;$dbpass&quot;,{AutoCommit =&gt; 1}) or die $_;
-	       my $sth=$dbh-&gt;prepare(&quot;select port from ports_view&quot;);
-               $sth-&gt;execute()or die;
-               my @data;
-	       my $i=0;
-               while (@data = $sth-&gt;fetchrow_array) 
-               {
-		   @strings[$i++]='|'<A HREF="https://lists.berlios.de/mailman/listinfo/x2go-commits">. at data</A>[0].'|';
-               }
-	       $sth-&gt;finish();
-	       $dbh-&gt;disconnect();
-       return @strings;
-       }
-       if($backend eq 'sqlite')
-       {
-	   return split(&quot;\n&quot;,`x2gosqlitewrapper getports $server`);
-       }
-
+	#ignore $server
+	my $server=shift or die &quot;argument \&quot;server\&quot; missed&quot;;         
+	if ($backend eq 'postgres')
+	{
+		my @strings;
+		my $dbh=DBI-&gt;connect(&quot;dbi:Pg:dbname=$db;host=$host;port=$port;sslmode=$sslmode&quot;, &quot;$dbuser&quot;, &quot;$dbpass&quot;,{AutoCommit =&gt; 1}) or die $_;
+		my $sth=$dbh-&gt;prepare(&quot;select port from ports_view&quot;);
+		$sth-&gt;execute()or die;
+		my @data;
+		my $i=0;
+		while (@data = $sth-&gt;fetchrow_array) 
+		{
+			@strings[$i++]='|'<A HREF="https://lists.berlios.de/mailman/listinfo/x2go-commits">. at data</A>[0].'|';
+		}
+		$sth-&gt;finish();
+		$dbh-&gt;disconnect();
+		return @strings;
+	}
+	if ($backend eq 'sqlite')
+	{
+		return split(&quot;\n&quot;,`x2gosqlitewrapper getports $server`);
+	}
 }
 
 sub db_getservers
 {
-       if($backend eq 'postgres')
-       {
-       my @strings;
-	       my $dbh=DBI-&gt;connect(&quot;dbi:Pg:dbname=$db;host=$host;port=$port;sslmode=$sslmode&quot;, &quot;$dbuser&quot;, &quot;$dbpass&quot;,{AutoCommit =&gt; 1}) or die $_;
-	       
-	       my $sth=$dbh-&gt;prepare(&quot;select server,count(*) from servers_view where status != 'F' group by server&quot;);
-               $sth-&gt;execute()or die;
-               my @data;
-	       my $i=0;
-               while (@data = $sth-&gt;fetchrow_array) 
-               {
-		   @strings[$i++]=@data[0].&quot; &quot;<A HREF="https://lists.berlios.de/mailman/listinfo/x2go-commits">. at data</A>[1];
-               }
-	       $sth-&gt;finish();
-	       $dbh-&gt;disconnect();
-       return @strings;
-       }
-              if($backend eq 'sqlite')
-       {
-	   return split(&quot;\n&quot;,`x2gosqlitewrapper getservers`);
-       }
-
+	if ($backend eq 'postgres')
+	{
+		my @strings;
+		my $dbh=DBI-&gt;connect(&quot;dbi:Pg:dbname=$db;host=$host;port=$port;sslmode=$sslmode&quot;, &quot;$dbuser&quot;, &quot;$dbpass&quot;,{AutoCommit =&gt; 1}) or die $_;
+		my $sth=$dbh-&gt;prepare(&quot;select server,count(*) from servers_view where status != 'F' group by server&quot;);
+		$sth-&gt;execute()or die;
+		my @data;
+		my $i=0;
+		while (@data = $sth-&gt;fetchrow_array) 
+		{
+			@strings[$i++]=@data[0].&quot; &quot;<A HREF="https://lists.berlios.de/mailman/listinfo/x2go-commits">. at data</A>[1];
+		}
+		$sth-&gt;finish();
+		$dbh-&gt;disconnect();
+		return @strings;
+	}
+		if ($backend eq 'sqlite')
+	{
+		return split(&quot;\n&quot;,`x2gosqlitewrapper getservers`);
+	}
 }
 
 sub db_getagent
 {
-       my $sid=shift or die &quot;argument \&quot;session_id\&quot; missed&quot;;
-       my $agent;
-       if($backend eq 'postgres')
-       {
-	       my $dbh=DBI-&gt;connect(&quot;dbi:Pg:dbname=$db;host=$host;port=$port;sslmode=$sslmode&quot;, &quot;$dbuser&quot;, &quot;$dbpass&quot;,{AutoCommit =&gt; 1}) or die $_;
-	       
-	       my $sth=$dbh-&gt;prepare(&quot;select agent_pid from sessions_view
-				      where session_id ='$sid'&quot;);
-               $sth-&gt;execute()or die;
-               my @data;
-	       my $i=0;
-               if(@data = $sth-&gt;fetchrow_array) 
-               {
-		   $agent=@data[0];
-               }
-               $sth-&gt;finish();
-	       $dbh-&gt;disconnect();
-       }
-       if($backend eq 'sqlite')
-       {
-	   $agent=`x2gosqlitewrapper getagent $sid`;
-       }
-       return $agent;
+	my $sid=shift or die &quot;argument \&quot;session_id\&quot; missed&quot;;
+	my $agent;
+	if ($backend eq 'postgres')
+	{
+		my $dbh=DBI-&gt;connect(&quot;dbi:Pg:dbname=$db;host=$host;port=$port;sslmode=$sslmode&quot;, &quot;$dbuser&quot;, &quot;$dbpass&quot;,{AutoCommit =&gt; 1}) or die $_;
+		my $sth=$dbh-&gt;prepare(&quot;select agent_pid from sessions_view
+		                      where session_id ='$sid'&quot;);
+		$sth-&gt;execute()or die;
+		my @data;
+		my $i=0;
+		if (@data = $sth-&gt;fetchrow_array) 
+		{
+			$agent=@data[0];
+		}
+		$sth-&gt;finish();
+		$dbh-&gt;disconnect();
+	}
+	if($backend eq 'sqlite')
+	{
+		$agent=`x2gosqlitewrapper getagent $sid`;
+	}
+	return $agent;
 }
 
 sub db_getdisplay
 {
-       my $sid=shift or die &quot;argument \&quot;session_id\&quot; missed&quot;;
-       my $display;
-       if($backend eq 'postgres')
-       {
-	       my $dbh=DBI-&gt;connect(&quot;dbi:Pg:dbname=$db;host=$host;port=$port;sslmode=$sslmode&quot;, &quot;$dbuser&quot;, &quot;$dbpass&quot;,{AutoCommit =&gt; 1}) or die $_;
-	       
-	       my $sth=$dbh-&gt;prepare(&quot;select display from sessions_view
-				      where session_id ='$sid'&quot;);
-               $sth-&gt;execute()or die;
-               my @data;
-	       my $i=0;
-               if(@data = $sth-&gt;fetchrow_array) 
-               {
-		   $display=@data[0];
-               }
-               $sth-&gt;finish();
-	       $dbh-&gt;disconnect();
-       }
-       if($backend eq 'sqlite')
-       {
-	   $display=`x2gosqlitewrapper getdisplay $sid`;
-       }
-       return $display;
+	my $sid=shift or die &quot;argument \&quot;session_id\&quot; missed&quot;;
+	my $display;
+	if ($backend eq 'postgres')
+	{
+		my $dbh=DBI-&gt;connect(&quot;dbi:Pg:dbname=$db;host=$host;port=$port;sslmode=$sslmode&quot;, &quot;$dbuser&quot;, &quot;$dbpass&quot;,{AutoCommit =&gt; 1}) or die $_;
+		my $sth=$dbh-&gt;prepare(&quot;select display from sessions_view
+		                      where session_id ='$sid'&quot;);
+		$sth-&gt;execute() or die;
+		my @data;
+		my $i=0;
+		if (@data = $sth-&gt;fetchrow_array) 
+		{
+			$display=@data[0];
+		}
+		$sth-&gt;finish();
+		$dbh-&gt;disconnect();
+	}
+	if ($backend eq 'sqlite')
+	{
+		$display=`x2gosqlitewrapper getdisplay $sid`;
+	}
+	return $display;
 }
+
 sub db_listsessions
 {
-       my $server=shift or die &quot;argument \&quot;server\&quot; missed&quot;;
-       if($backend eq 'postgres')
-       {
-	       my @strings;
-	       my $dbh=DBI-&gt;connect(&quot;dbi:Pg:dbname=$db;host=$host;port=$port;sslmode=$sslmode&quot;, &quot;$dbuser&quot;, &quot;$dbpass&quot;,{AutoCommit =&gt; 1}) or die $_;
-	       
-	       my $sth=$dbh-&gt;prepare(&quot;select agent_pid, session_id, display, server, status,
-				     to_char(init_time,'DD.MM.YY*HH24:MI:SS'), cookie, client, gr_port,
-				     sound_port, to_char( last_time, 'DD.MM.YY*HH24:MI:SS'), uname,
-				     to_char(now()- init_time,'SSSS'), fs_port from  sessions_view
-				      where status !='F' and server='$server' and  
-				      (  session_id not like '%XSHAD%') order by status desc&quot;);
-               $sth-&gt;execute()or die;
-               my @data;
-	       my $i=0;
-               while (@data = $sth-&gt;fetchrow_array) 
-               {
-		   @strings[$i++]=join('|'<A HREF="https://lists.berlios.de/mailman/listinfo/x2go-commits">, at data</A>);
-               }
-	       $sth-&gt;finish();
-	       $dbh-&gt;disconnect();
-               return @strings;
-       }
-       if($backend eq 'sqlite')
-       {
-	   return split(&quot;\n&quot;,`x2gosqlitewrapper listsessions $server`);
-       }
-
+	my $server=shift or die &quot;argument \&quot;server\&quot; missed&quot;;
+	if ($backend eq 'postgres')
+	{
+		my @strings;
+		my $dbh=DBI-&gt;connect(&quot;dbi:Pg:dbname=$db;host=$host;port=$port;sslmode=$sslmode&quot;, &quot;$dbuser&quot;, &quot;$dbpass&quot;,{AutoCommit =&gt; 1}) or die $_;
+		my $sth=$dbh-&gt;prepare(&quot;select agent_pid, session_id, display, server, status,
+		                      to_char(init_time,'DD.MM.YY*HH24:MI:SS'), cookie, client, gr_port,
+		                      sound_port, to_char( last_time, 'DD.MM.YY*HH24:MI:SS'), uname,
+		                      to_char(now()- init_time,'SSSS'), fs_port from  sessions_view
+		                      where status !='F' and server='$server' and  
+		                      (session_id not like '%XSHAD%') order by status desc&quot;);
+		$sth-&gt;execute() or die;
+		my @data;
+		my $i=0;
+		while (@data = $sth-&gt;fetchrow_array) 
+		{
+			@strings[$i++]=join('|'<A HREF="https://lists.berlios.de/mailman/listinfo/x2go-commits">, at data</A>);
+		}
+		$sth-&gt;finish();
+		$dbh-&gt;disconnect();
+		return @strings;
+	}
+	if ($backend eq 'sqlite')
+	{
+		return split(&quot;\n&quot;,`x2gosqlitewrapper listsessions $server`);
+	}
 }
 
 sub db_listsessions_all
 {
-       if($backend eq 'postgres')
-       {
-	       my @strings;
-	       my $dbh=DBI-&gt;connect(&quot;dbi:Pg:dbname=$db;host=$host;port=$port;sslmode=$sslmode&quot;, &quot;$dbuser&quot;, &quot;$dbpass&quot;,{AutoCommit =&gt; 1}) or die $_;
-	       
-	       my $sth=$dbh-&gt;prepare(&quot;select agent_pid, session_id, display, server, status,
-				     to_char(init_time,'DD.MM.YY*HH24:MI:SS'), cookie, client, gr_port,
-				     sound_port, to_char( last_time, 'DD.MM.YY*HH24:MI:SS'), uname,
-				     to_char(now()- init_time,'SSSS'), fs_port from  sessions_view
-				      where status !='F'  and  
-				      (  session_id not like '%XSHAD%') order by status desc&quot;);
-               $sth-&gt;execute()or die;
-               my @data;
-	       my $i=0;
-               while (@data = $sth-&gt;fetchrow_array) 
-               {
-		   @strings[$i++]=join('|'<A HREF="https://lists.berlios.de/mailman/listinfo/x2go-commits">, at data</A>);
-               }
-	       $sth-&gt;finish();
-	       $dbh-&gt;disconnect();
-	       return @strings;
-       }
-       if($backend eq 'sqlite')
-       {
-	   return split(&quot;\n&quot;,`x2gosqlitewrapper listsessions_all`);
-       }
-
+	if($backend eq 'postgres')
+	{
+		my @strings;
+		my $dbh=DBI-&gt;connect(&quot;dbi:Pg:dbname=$db;host=$host;port=$port;sslmode=$sslmode&quot;, &quot;$dbuser&quot;, &quot;$dbpass&quot;,{AutoCommit =&gt; 1}) or die $_;
+		my $sth=$dbh-&gt;prepare(&quot;select agent_pid, session_id, display, server, status,
+		                      to_char(init_time,'DD.MM.YY*HH24:MI:SS'), cookie, client, gr_port,
+		                      sound_port, to_char( last_time, 'DD.MM.YY*HH24:MI:SS'), uname,
+		                      to_char(now()- init_time,'SSSS'), fs_port from  sessions_view
+		                      where status !='F'  and  
+		                      (session_id not like '%XSHAD%') order by status desc&quot;);
+		$sth-&gt;execute()or die;
+		my @data;
+		my $i=0;
+		while (@data = $sth-&gt;fetchrow_array) 
+		{
+			@strings[$i++]=join('|'<A HREF="https://lists.berlios.de/mailman/listinfo/x2go-commits">, at data</A>);
+		}
+		$sth-&gt;finish();
+		$dbh-&gt;disconnect();
+		return @strings;
+	}
+	if ($backend eq 'sqlite')
+	{
+		return split(&quot;\n&quot;,`x2gosqlitewrapper listsessions_all`);
+	}
 }
diff --git a/x2goserver/lib/x2golistsessions_root b/x2goserver/lib/x2golistsessions_root
index daf7a79..1e60493 100755
--- a/x2goserver/lib/x2golistsessions_root
+++ b/x2goserver/lib/x2golistsessions_root
@@ -23,27 +23,25 @@
 use Sys::Hostname;
 use strict;
 
-
 sub check_stat
 {
-   my $sess=shift;
-   my $user=shift;
-   my $log=&quot;~$user/.x2go/C-$sess/session.log&quot;;
-   my $text=`tail -1 $log`;
-   if($text =~ m/Session suspended/)
-   {
-       return 0;
-   }
-   return 1;
+	my $sess=shift;
+	my $user=shift;
+	my $log=&quot;~$user/.x2go/C-$sess/session.log&quot;;
+	my $text=`tail -1 $log`;
+	if ($text =~ m/Session suspended/)
+	{
+		return 0;
+	}
+	return 1;
 }
 
-
 my $uname;
 
 my $serv=shift;
-if( ! $serv)
+if ( ! $serv)
 {
-   $serv=hostname;
+	$serv=hostname;
 }
 
 my $outp=`x2golistsessions_sql $serv 2&gt;/dev/null`;
@@ -51,23 +49,23 @@ my $outp=`x2golistsessions_sql $serv 2&gt;/dev/null`;
 
 my @outp=split(&quot;\n&quot;,&quot;$outp&quot;);
 
-for(my $i=0;$i&lt;@outp;$i++)
+for (my $i=0;$i&lt;@outp;$i++)
 {
-     my @sinfo=split('\\|',&quot;@outp[$i]&quot;);
-     if(@sinfo[4]eq 'F')
-     {
-           print &quot;@outp[$i]\n&quot;;
-     }       
-     else
-     { 
-       if(@sinfo[4]eq 'R')
-       {
-           if(!check_stat(@sinfo[1]<A HREF="https://lists.berlios.de/mailman/listinfo/x2go-commits">, at sinfo</A>[11]))
-           {
-               system(&quot;su - @sinfo[11] -c \&quot;x2gochangestatus 'S' @sinfo[1]\&quot; &gt; /dev/null&quot;);
-               @outp[$i] =~ s/\|R\|/\|S\|/;
-           }
-       }       
-       print &quot;@outp[$i]\n&quot;;
-     }
+	my @sinfo=split('\\|',&quot;@outp[$i]&quot;);
+	if (@sinfo[4]eq 'F')
+	{
+		print &quot;@outp[$i]\n&quot;;
+	}
+	else
+	{ 
+		if (@sinfo[4]eq 'R')
+		{
+			if (!check_stat(@sinfo[1]<A HREF="https://lists.berlios.de/mailman/listinfo/x2go-commits">, at sinfo</A>[11]))
+			{
+				system(&quot;su - @sinfo[11] -c \&quot;x2gochangestatus 'S' @sinfo[1]\&quot; &gt; /dev/null&quot;);
+				@outp[$i] =~ s/\|R\|/\|S\|/;
+			}
+		}
+		print &quot;@outp[$i]\n&quot;;
+	}
 }
diff --git a/x2goserver/lib/x2golistsessions_sql b/x2goserver/lib/x2golistsessions_sql
index 4f1abdc..ffaa3c6 100755
--- a/x2goserver/lib/x2golistsessions_sql
+++ b/x2goserver/lib/x2golistsessions_sql
@@ -25,25 +25,23 @@ use strict;
 use lib &quot;/usr/lib/x2go&quot;;
 use x2godbwrapper; 
 
-
-
 my $serv=shift;
 my @array;
 if($serv eq &quot;--all-servers&quot;)
 {
-    @array=dbsys_listsessionsroot_all();
+	@array=dbsys_listsessionsroot_all();
 }
 else
 {
-    @array=dbsys_listsessionsroot ($serv);
+	@array=dbsys_listsessionsroot ($serv);
 }
 my $i;
 for ( $i=0;$i&lt;@array;$i++) 
 {
-       my @ln=split('\|'<A HREF="https://lists.berlios.de/mailman/listinfo/x2go-commits">, at array</A>[$i]);
-       if(@ln[4] eq &quot;F&quot;)
-       {
-          dbsys_rmsessionsroot( @ln[1]);
-       }
-       print &quot;@array[$i]\n&quot;;
+	my @ln=split('\|'<A HREF="https://lists.berlios.de/mailman/listinfo/x2go-commits">, at array</A>[$i]);
+	if (@ln[4] eq &quot;F&quot;)
+	{
+		dbsys_rmsessionsroot( @ln[1]);
+	}
+	print &quot;@array[$i]\n&quot;;
 }
diff --git a/x2goserver/lib/x2gosessionlimit b/x2goserver/lib/x2gosessionlimit
index 36b275c..3878c82 100755
--- a/x2goserver/lib/x2gosessionlimit
+++ b/x2goserver/lib/x2gosessionlimit
@@ -29,20 +29,20 @@ $Config-&gt;read('/etc/x2go/x2goserver.conf' );
 
 sub getGroupLimit
 {
-    my $group=shift;
-    my $strlimit=$Config-&gt;param(&quot;limit groups.$group&quot;);
-    if($strlimit ne &quot;&quot;)
-    {
-            if($strlimit == 0)
-            {
-                    print &quot;0\n&quot;;
-                    exit 0;
-            }
-            if($strlimit &gt; $maxlimit)
-            {
-                   $maxlimit=$strlimit;
-            }
-    }
+	my $group=shift;
+	my $strlimit=$Config-&gt;param(&quot;limit groups.$group&quot;);
+	if ($strlimit ne &quot;&quot;)
+	{
+		if ($strlimit == 0)
+		{
+			print &quot;0\n&quot;;
+			exit 0;
+		}
+		if ($strlimit &gt; $maxlimit)
+		{
+			$maxlimit=$strlimit;
+		}
+	}
 }
 
 my $uname;
@@ -56,18 +56,18 @@ my $strlimit=$Config-&gt;param(&quot;limit users.$uname&quot;);
 
 if($strlimit ne &quot;&quot;)
 {
-    if($strlimit == 0)
-    {
-         print &quot;0\n&quot;;
-         exit 0;
-    }
-    if($strlimit &lt;= $scount)
-    {
-        print &quot;$strlimit\n&quot;;
-        exit 0;
-    }
-    print &quot;$strlimit\n&quot;;
-    exit 0;
+	if ($strlimit == 0)
+	{
+		print &quot;0\n&quot;;
+		exit 0;
+	}
+	if ($strlimit &lt;= $scount)
+	{
+		print &quot;$strlimit\n&quot;;
+		exit 0;
+	}
+	print &quot;$strlimit\n&quot;;
+	exit 0;
 }
 
 
@@ -75,23 +75,23 @@ my ($name, $pass, $uid, $pgid, $quota, $comment, $gcos, $dir, $shell, $expire) =
 
 while (my ($name, $passwd, $gid, $members)  = getgrent()) 
 {
-       if( $pgid eq $gid)
-       {
-              getGroupLimit $name;
-       }
-       my @memebers=split(&quot; &quot;,$members);
-       foreach my $member (@memebers) 
-       {
-           if($uname eq $member  )
-           {
-                getGroupLimit $name;
-           }
-       }
+	if ( $pgid eq $gid)
+	{
+		getGroupLimit $name;
+	}
+	my @memebers=split(&quot; &quot;,$members);
+	foreach my $member (@memebers) 
+	{
+		if ($uname eq $member  )
+		{
+			getGroupLimit $name;
+		}
+	}
 }
 
-if($maxlimit &lt;= $scount)
+if ($maxlimit &lt;= $scount)
 {
-        print &quot;$maxlimit\n&quot;;
-        exit 0;
+	print &quot;$maxlimit\n&quot;;
+	exit 0;
 }
 print &quot;$maxlimit\n&quot;;


hooks/post-receive
-- 
x2goserver.git (X2Go Server)

This is an automated email from the git hooks/post-receive script. It was
generated because a ref change was pushed to the repository containing
the project &quot;x2goserver.git&quot; (X2Go Server).

</PRE>

















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="019222.html">[X2Go-Commits] x2goserver.git - build-baikal (branch) updated:	3.0.99-2-79-g1f1ea43
</A></li>
	<LI>Next message: <A HREF="019248.html">[X2Go-Commits] x2goserver.git - build-baikal (branch) updated:	3.0.99-2-78-g5c60ad1
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19226">[ date ]</a>
              <a href="thread.html#19226">[ thread ]</a>
              <a href="subject.html#19226">[ subject ]</a>
              <a href="author.html#19226">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/x2go-commits">More information about the X2Go-commits
mailing list</a><br>
</body></html>
