<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [X2go-Commits] python-x2go.git - release/0.1.1.x (branch) updated:	0.1.1.6-7-g3b26a38
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/x2go-commits/2011-September/index.html" >
   <LINK REL="made" HREF="mailto:x2go-commits%40lists.berlios.de?Subject=Re%3A%20%5BX2go-Commits%5D%20python-x2go.git%20-%20release/0.1.1.x%20%28branch%29%20updated%3A%0A%090.1.1.6-7-g3b26a38&In-Reply-To=%3C20110920082326.43A775DD10%40ymir%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001511.html">
   <LINK REL="Next"  HREF="001513.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[X2go-Commits] python-x2go.git - release/0.1.1.x (branch) updated:	0.1.1.6-7-g3b26a38</H1>
    <B>X2go dev team</B> 
    <A HREF="mailto:x2go-commits%40lists.berlios.de?Subject=Re%3A%20%5BX2go-Commits%5D%20python-x2go.git%20-%20release/0.1.1.x%20%28branch%29%20updated%3A%0A%090.1.1.6-7-g3b26a38&In-Reply-To=%3C20110920082326.43A775DD10%40ymir%3E"
       TITLE="[X2go-Commits] python-x2go.git - release/0.1.1.x (branch) updated:	0.1.1.6-7-g3b26a38">git-admin at x2go.org
       </A><BR>
    <I>Tue Sep 20 10:23:26 CEST 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="001511.html">[X2go-Commits] x2goclient.git - master (branch) updated:	3.99.0.0-11-gd52a469
</A></li>
        <LI>Next message: <A HREF="001513.html">[X2go-Commits] python-x2go.git - master (branch) updated:	0.1.1.4-37-geeb2212
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1512">[ date ]</a>
              <a href="thread.html#1512">[ thread ]</a>
              <a href="subject.html#1512">[ subject ]</a>
              <a href="author.html#1512">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>The branch, release/0.1.1.x has been updated
       via  3b26a3812c88d578e75e0d15e372bccc5e4e1f49 (commit)
       via  35cc30107306bb97af7b25b1f8ab9dfb9a32a801 (commit)
       via  3a4e5e374bbe43c4ebbbe56bd4ad526fac57a61c (commit)
      from  535521affad151325cfa4fe452542d358e974745 (commit)

Those revisions listed above that are new to this repository have
not appeared on any other notification email; so we list those
revisions in full, below.

- Log -----------------------------------------------------------------
commit 3b26a3812c88d578e75e0d15e372bccc5e4e1f49
Author: Mike Gabriel &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/x2go-commits">mike.gabriel at das-netzwerkteam.de</A>&gt;
Date:   Tue Sep 20 10:20:46 2011 +0200

    Use TCP_NODELAY option for audio rev forwarding tunnels.

commit 35cc30107306bb97af7b25b1f8ab9dfb9a32a801
Author: Mike Gabriel &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/x2go-commits">mike.gabriel at das-netzwerkteam.de</A>&gt;
Date:   Mon Sep 19 15:27:46 2011 +0200

    Differentiate between spool folders and data folders when unsharing all folders, return exitcode from X2goTerminalSessionSTDOUT.unshare_* methods.

commit 3a4e5e374bbe43c4ebbbe56bd4ad526fac57a61c
Author: Dick Kniep &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/x2go-commits">dick.kniep at lindix.nl</A>&gt;
Date:   Mon Sep 19 14:57:15 2011 +0200

    Typo in utils.py (true instead of True).

-----------------------------------------------------------------------

Summary of changes:
 debian/changelog                  |   11 ++++++++++-
 x2go/backends/terminal/_stdout.py |    4 ++++
 x2go/rforward.py                  |    1 +
 x2go/session.py                   |   17 ++++++++++++++---
 x2go/utils.py                     |    3 ++-
 5 files changed, 31 insertions(+), 5 deletions(-)

The diff of changes is:
diff --git a/debian/changelog b/debian/changelog
index 9145492..59f1692 100644
--- a/debian/changelog
+++ b/debian/changelog
@@ -1,9 +1,18 @@
 python-x2go (0.1.1.7-0~x2go1) UNRELEASED; urgency=low
 
+  [ Mike Gabriel ]
   * New upstream version (0.1.1.7), bugfix release for 0.1.1.x series:
     - Add support for x2goumount-session calls.
+    - Differentiate between spool folders and data folders when unsharing
+      all folders, return exitcode from X2goTerminalSessionSTDOUT.unshare_*
+      methods.
+    - Use TCP_NODELAY option for audio rev forwarding tunnels.
 
- -- Mike Gabriel &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/x2go-commits">mike.gabriel at das-netzwerkteam.de</A>&gt;  Wed, 14 Sep 2011 21:43:55 +0200
+  [ Dick Kniep ]
+  * Fix for upstream version 0.1.1.7:
+    - Typo in utils.py (true instead of True).
+
+ -- Mike Gabriel &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/x2go-commits">mike.gabriel at das-netzwerkteam.de</A>&gt;  Wed, 14 Sep 2011 21:35:54 +0200
 
 python-x2go (0.1.1.6-0~x2go1) unstable; urgency=low
 
diff --git a/x2go/backends/terminal/_stdout.py b/x2go/backends/terminal/_stdout.py
index 0196281..af8212c 100644
--- a/x2go/backends/terminal/_stdout.py
+++ b/x2go/backends/terminal/_stdout.py
@@ -700,8 +700,10 @@ class X2goTerminalSessionSTDOUT(object):
         (stdin, stdout, stderr) = self.control_session._x2go_exec_command(cmd_line)
         if not stderr.read():
             self.logger('x2goumount-session (all mounts) for session %s has been successful' % self.session_info, log.loglevel_NOTICE)
+            return True
         else:
             self.logger('x2goumount-session (all mounts) for session %s failed' % self.session_info, log.loglevel_ERROR)
+            return False
 
     def unshare_local_folder(self, local_path):
         &quot;&quot;&quot;\
@@ -722,8 +724,10 @@ class X2goTerminalSessionSTDOUT(object):
         (stdin, stdout, stderr) = self.control_session._x2go_exec_command(cmd_line)
         if not stderr.read():
             self.logger('x2goumount-session (%s) for session %s has been successful' % (local_path, self.session_info, ), log.loglevel_NOTICE)
+            return True
         else:
             self.logger('x2goumount-session (%s) for session %s failed' % (local_path, self.session_info, ), log.loglevel_ERROR)
+            return False
 
     def color_depth(self):
         &quot;&quot;&quot;\
diff --git a/x2go/rforward.py b/x2go/rforward.py
index 0388b85..8dfa805 100644
--- a/x2go/rforward.py
+++ b/x2go/rforward.py
@@ -300,6 +300,7 @@ def x2go_rev_forward_channel_handler(chan=None, addr='', port=0, parent_thread=N
 
     &quot;&quot;&quot;
     fw_socket = socket.socket()
+    fw_socket.setsockopt(socket.IPPROTO_TCP, socket.TCP_NODELAY, 1)
     if logger is None:
         def _dummy_logger(msg, l):
             pass
diff --git a/x2go/session.py b/x2go/session.py
index 62752de..c74e1dc 100644
--- a/x2go/session.py
+++ b/x2go/session.py
@@ -1418,10 +1418,14 @@ class X2goSession(object):
             raise X2goSessionException('this X2goSession object does not have any associated terminal')
     __share_local_folder = share_local_folder
 
-    def unshare_all_local_folders(self):
+    def unshare_all_local_folders(self, force_all=False):
         &quot;&quot;&quot;\
         Unshare all local folders mounted within this X2go session.
 
+        @param force_all: Really unmount _all_ shared folders, including the print spool folder and
+            the MIME box spool dir (not recommended).
+        @type force_all: C{bool}
+
         @return: returns C{True} if all local folders could be successfully unmounted
             inside this X2go session
         @rtype: C{bool}
@@ -1429,8 +1433,15 @@ class X2goSession(object):
         &quot;&quot;&quot;
         if self.has_terminal_session():
             if self.allow_share_local_folders:
-                self.shared_folders = []
-                return self.terminal_session.unshare_all_local_folders()
+                if force_all:
+                    self.shared_folders = []
+                    return self.terminal_session.unshare_all_local_folders()
+                else:
+                    retval = 0
+                    for _shared_folder in self.shared_folders:
+                        retval = retval | self.terminal_session.unshare_local_folder(_shared_folder)
+                    self.shared_folders = []
+                    return retval
             else:
                 self.logger('local folder sharing is disabled for this session profile', loglevel=log.loglevel_WARN)
         else:
diff --git a/x2go/utils.py b/x2go/utils.py
index 5d023d9..9f92c36 100644
--- a/x2go/utils.py
+++ b/x2go/utils.py
@@ -444,5 +444,6 @@ def is_color_depth_ok(depth_session, depth_local):
     if depth_session == depth_local:
         return True
     if ( ( depth_session == 24 or depth_session == 32 ) and ( depth_local == 24 or depth_local == 32 ) ):
-        return true;
+        return True;
     return False
+


hooks/post-receive
-- 
python-x2go.git (Python X2go Client API)

This is an automated email from the git hooks/post-receive script. It was
generated because a ref change was pushed to the repository containing
the project &quot;python-x2go.git&quot; (Python X2go Client API).


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001511.html">[X2go-Commits] x2goclient.git - master (branch) updated:	3.99.0.0-11-gd52a469
</A></li>
	<LI>Next message: <A HREF="001513.html">[X2go-Commits] python-x2go.git - master (branch) updated:	0.1.1.4-37-geeb2212
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1512">[ date ]</a>
              <a href="thread.html#1512">[ thread ]</a>
              <a href="subject.html#1512">[ subject ]</a>
              <a href="author.html#1512">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/x2go-commits">More information about the X2go-commits
mailing list</a><br>
</body></html>
