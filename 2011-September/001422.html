<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [X2go-Commits] x2goserver.git - master (branch) updated:	3.0.99-2-223-g49887e8
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/x2go-commits/2011-September/index.html" >
   <LINK REL="made" HREF="mailto:x2go-commits%40lists.berlios.de?Subject=Re%3A%20%5BX2go-Commits%5D%20x2goserver.git%20-%20master%20%28branch%29%20updated%3A%0A%093.0.99-2-223-g49887e8&In-Reply-To=%3C20110909134741.90E335DB1B%40ymir%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001421.html">
   <LINK REL="Next"  HREF="001423.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[X2go-Commits] x2goserver.git - master (branch) updated:	3.0.99-2-223-g49887e8</H1>
    <B>X2go dev team</B> 
    <A HREF="mailto:x2go-commits%40lists.berlios.de?Subject=Re%3A%20%5BX2go-Commits%5D%20x2goserver.git%20-%20master%20%28branch%29%20updated%3A%0A%093.0.99-2-223-g49887e8&In-Reply-To=%3C20110909134741.90E335DB1B%40ymir%3E"
       TITLE="[X2go-Commits] x2goserver.git - master (branch) updated:	3.0.99-2-223-g49887e8">git-admin at x2go.org
       </A><BR>
    <I>Fri Sep  9 15:47:41 CEST 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="001421.html">[X2go-Commits] python-x2go.git - release/0.1.1.x (branch) updated:	0.1.1.4-23-gaaea664
</A></li>
        <LI>Next message: <A HREF="001423.html">[X2go-Commits] cups-x2go.git - master (branch) updated:	3.0.0.2-26-g247294d
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1422">[ date ]</a>
              <a href="thread.html#1422">[ thread ]</a>
              <a href="subject.html#1422">[ subject ]</a>
              <a href="author.html#1422">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>The branch, master has been updated
       via  49887e82635ea1b030636cb276152fdd8656cef2 (commit)
       via  d63a839c23b8f470aa30b32d3b37be66e2d412aa (commit)
      from  79bb217bd5b5ee6775607c75f91241613ed3cbdb (commit)

Those revisions listed above that are new to this repository have
not appeared on any other notification email; so we list those
revisions in full, below.

- Log -----------------------------------------------------------------
commit 49887e82635ea1b030636cb276152fdd8656cef2
Author: Mike Gabriel &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/x2go-commits">mike.gabriel at das-netzwerkteam.de</A>&gt;
Date:   Fri Sep 9 15:48:47 2011 +0200

    Initialize Syslog module for all Perl scripts in x2goserver package.

commit d63a839c23b8f470aa30b32d3b37be66e2d412aa
Author: Mike Gabriel &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/x2go-commits">mike.gabriel at das-netzwerkteam.de</A>&gt;
Date:   Fri Sep 9 15:37:45 2011 +0200

    Change x2gologlevel script into a Perl module (and a script that calls it). Using x2gologlevel function in x2goprint to set loglevel mask.

-----------------------------------------------------------------------

Summary of changes:
 debian/changelog                                 |    3 ++
 x2goserver/bin/x2golistdesktops                  |    8 ++++++
 x2goserver/bin/x2golistsessions                  |    7 +++++-
 x2goserver/bin/x2gomountdirs                     |    6 +++++
 x2goserver/bin/x2goprint                         |   10 +++++---
 x2goserver/bin/x2gosessionlimit                  |    8 ++++++
 x2goserver/bin/x2goshowblocks                    |    5 ++++
 x2goserver/bin/x2goumount-session                |    9 +++++--
 x2goserver/lib/x2gochangestatus                  |    7 +++++-
 x2goserver/lib/x2gocreatesession                 |    5 ++++
 x2goserver/lib/x2gogetagent                      |    6 +++++
 x2goserver/lib/x2gogetdisplays                   |    6 +++++
 x2goserver/lib/x2gogetports                      |    8 ++++++-
 x2goserver/lib/x2gogetservers                    |    6 +++++
 x2goserver/lib/x2goinsertport                    |    6 +++++
 x2goserver/lib/x2goinsertsession                 |    6 +++++
 x2goserver/lib/x2golistsessions_root             |   10 +++++++-
 x2goserver/lib/x2golistsessions_sql              |    6 +++++
 x2goserver/lib/x2gologlevel                      |   19 ++-------------
 x2goserver/lib/{x2gologlevel =&gt; x2gologlevel.pm} |   26 +++++++++++++--------
 x2goserver/lib/x2goresume                        |    6 +++++
 x2goserver/lib/x2gosessionlimit                  |    8 ++++++
 x2goserver/lib/x2gosuspend-agent                 |    9 +++++++
 x2goserver/sbin/x2gocleansessions                |    7 ++++++
 x2goserver/sbin/x2godbadmin                      |    8 ++++++-
 x2goserver/sbin/x2golistsessions_root            |   10 +++++++-
 26 files changed, 176 insertions(+), 39 deletions(-)
 copy x2goserver/lib/{x2gologlevel =&gt; x2gologlevel.pm} (65%)
 mode change 100755 =&gt; 100644

The diff of changes is:
diff --git a/debian/changelog b/debian/changelog
index 4356498..4df4777 100644
--- a/debian/changelog
+++ b/debian/changelog
@@ -38,6 +38,9 @@ x2goserver (3.0.99.5-0~x2go3) UNRELEASED; urgency=low
   * Fix x2goprint, add syslogging, add inline comments.
   * Add script lib/x2gologlevel: introduce [log] section in x2goserver.conf
     with only parameter ,,loglevel''.
+  * Change x2gologlevel script into a Perl module (and a script that calls it).
+    Using x2gologlevel function in x2goprint to set loglevel mask.
+  * Initialize Syslog module for all Perl scripts in x2goserver package.
 
   [ Martin Oehler ]
   * Removes old debug code fragment, fixes x2golistsessions parsing.
diff --git a/x2goserver/bin/x2golistdesktops b/x2goserver/bin/x2golistdesktops
index 2679d6a..5642271 100755
--- a/x2goserver/bin/x2golistdesktops
+++ b/x2goserver/bin/x2golistdesktops
@@ -22,6 +22,14 @@
 
 use strict;
 use Sys::Hostname;
+use Sys::Syslog qw( :DEFAULT );
+
+use lib `echo -n \$(x2gobasepath)/lib/x2go`;
+use x2gologlevel;
+
+openlog($0,'cons,pid','user');
+setlogmask( LOG_UPTO(x2gologlevel()) );
+
 
 my $serv=shift;
 if( ! $serv)
diff --git a/x2goserver/bin/x2golistsessions b/x2goserver/bin/x2golistsessions
index a9ac4cf..56a943f 100755
--- a/x2goserver/bin/x2golistsessions
+++ b/x2goserver/bin/x2golistsessions
@@ -20,11 +20,16 @@
 # Copyright (C) 2007-2011  Oleksandr Shneyder &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/x2go-commits">oleksandr.shneyder at obviously-nice.de</A>&gt;
 # Copyright (C) 2007-2011  Heinz-Markus Graesing &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/x2go-commits">heinz-m.graesing at obviously-nice.de</A>&gt;
 
-use Sys::Hostname;
 use strict;
+use Sys::Hostname;
+use Sys::Syslog qw( :DEFAULT );
 
 use lib `echo -n \$(x2gobasepath)/lib/x2go`;
 use x2godbwrapper; 
+use x2gologlevel;
+
+openlog($0,'cons,pid','user');
+setlogmask( LOG_UPTO(x2gologlevel()) );
 
 
 sub check_stat
diff --git a/x2goserver/bin/x2gomountdirs b/x2goserver/bin/x2gomountdirs
index 2194da2..5364664 100755
--- a/x2goserver/bin/x2gomountdirs
+++ b/x2goserver/bin/x2gomountdirs
@@ -21,9 +21,15 @@
 # Copyright (C) 2007-2011  Heinz-Markus Graesing &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/x2go-commits">heinz-m.graesing at obviously-nice.de</A>&gt;
 
 use strict;
+use Sys::Syslog qw( :DEFAULT );
 
 use lib `echo -n \$(x2gobasepath)/lib/x2go`;
 use x2godbwrapper;
+use x2gologlevel;
+
+openlog($0,'cons,pid','user');
+setlogmask( LOG_UPTO(x2gologlevel()) );
+
 
 my $type=shift;
 my $session=shift;
diff --git a/x2goserver/bin/x2goprint b/x2goserver/bin/x2goprint
index 8d0da56..c75b49f 100755
--- a/x2goserver/bin/x2goprint
+++ b/x2goserver/bin/x2goprint
@@ -20,17 +20,19 @@
 # Copyright (C) 2007-2011  Oleksandr Shneyder &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/x2go-commits">oleksandr.shneyder at obviously-nice.de</A>&gt;
 # Copyright (C) 2007-2011  Heinz-Markus Graesing &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/x2go-commits">heinz-m.graesing at obviously-nice.de</A>&gt;
 
+use strict;
 use File::Basename;
 use File::Copy;
 use File::Path;
-use Sys::Syslog qw( :DEFAULT setlogsock);
-use strict;
+use Sys::Syslog qw( :DEFAULT );
 
 use lib `echo -n \$(x2gobasepath)/lib/x2go`;
 use x2godbwrapper;
+use x2gologlevel;
 
-setlogsock('unix');
 openlog($0,'cons,pid','user');
+setlogmask( LOG_UPTO(x2gologlevel()) );
+
 
 sub check_root
 {
@@ -81,7 +83,7 @@ if( -e &quot;$printdir/$titleFile&quot;)
 	close (TITLE);
 	unlink(&quot;$printdir/$titleFile&quot;);
 }
-syslog('info', &quot;x2goprint is processing $printdir/$pdfFile with print job title ,,$title\''&quot;);
+syslog('notice', &quot;x2goprint is processing $printdir/$pdfFile with print job title ,,$title\''&quot;);
 
 # temp location for placing incoming spool files, so that
 # they can can be picked by the session user and further processed
diff --git a/x2goserver/bin/x2gosessionlimit b/x2goserver/bin/x2gosessionlimit
index 3878c82..f2fc78c 100755
--- a/x2goserver/bin/x2gosessionlimit
+++ b/x2goserver/bin/x2gosessionlimit
@@ -22,6 +22,14 @@
 
 use strict;
 use Config::Simple;
+use Sys::Syslog qw( :DEFAULT );
+
+use lib `echo -n \$(x2gobasepath)/lib/x2go`;
+use x2gologlevel;
+
+openlog($0,'cons,pid','user');
+setlogmask( LOG_UPTO(x2gologlevel()) );
+
 
 my $maxlimit=0;
 my $Config = new Config::Simple(syntax=&gt;'ini');
diff --git a/x2goserver/bin/x2goshowblocks b/x2goserver/bin/x2goshowblocks
index 0c15c39..4b898b2 100755
--- a/x2goserver/bin/x2goshowblocks
+++ b/x2goserver/bin/x2goshowblocks
@@ -21,9 +21,14 @@
 # Copyright (C) 2007-2011  Heinz-Markus Graesing &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/x2go-commits">heinz-m.graesing at obviously-nice.de</A>&gt;
 
 use strict;
+use Sys::Syslog qw( :DEFAULT );
 
 use lib `echo -n \$(x2gobasepath)/lib/x2go`;
 use x2godbwrapper; 
+use x2gologlevel;
+
+openlog($0,'cons,pid','user');
+setlogmask( LOG_UPTO(x2gologlevel()) );
 
 
 my $uname=shift;
diff --git a/x2goserver/bin/x2goumount-session b/x2goserver/bin/x2goumount-session
index 81103e2..90c4f58 100755
--- a/x2goserver/bin/x2goumount-session
+++ b/x2goserver/bin/x2goumount-session
@@ -20,17 +20,20 @@
 # Copyright (C) 2007-2011  Oleksandr Shneyder &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/x2go-commits">oleksandr.shneyder at obviously-nice.de</A>&gt;
 # Copyright (C) 2007-2011  Heinz-Markus Graesing &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/x2go-commits">heinz-m.graesing at obviously-nice.de</A>&gt;
 
-use Sys::Hostname;
 use strict;
+use Sys::Hostname;
+use Sys::Syslog qw( :DEFAULT );
 
 use lib `echo -n \$(x2gobasepath)/lib/x2go`;
 use x2godbwrapper; 
+use x2gologlevel;
+
+openlog($0,'cons,pid','user');
+setlogmask( LOG_UPTO(x2gologlevel()) );
 
 
 my $session=shift;
 my $only_path=shift;
-
-
 my $uname=$ENV{'USER'};
 my $serv=hostname;
 
diff --git a/x2goserver/lib/x2gochangestatus b/x2goserver/lib/x2gochangestatus
index 89696ba..216740b 100755
--- a/x2goserver/lib/x2gochangestatus
+++ b/x2goserver/lib/x2gochangestatus
@@ -21,10 +21,15 @@
 # Copyright (C) 2007-2011  Heinz-Markus Graesing &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/x2go-commits">heinz-m.graesing at obviously-nice.de</A>&gt;
 
 use strict;
-
+use Sys::Syslog qw( :DEFAULT );
 
 use lib `echo -n \$(x2gobasepath)/lib/x2go`;
 use x2godbwrapper; 
+use x2gologlevel;
+
+openlog($0,'cons,pid','user');
+setlogmask( LOG_UPTO(x2gologlevel()) );
+
 
 my $status=shift or die;
 my $sid=shift or die;
diff --git a/x2goserver/lib/x2gocreatesession b/x2goserver/lib/x2gocreatesession
index 425a5d0..e43024e 100755
--- a/x2goserver/lib/x2gocreatesession
+++ b/x2goserver/lib/x2gocreatesession
@@ -21,9 +21,14 @@
 # Copyright (C) 2007-2011  Heinz-Markus Graesing &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/x2go-commits">heinz-m.graesing at obviously-nice.de</A>&gt;
 
 use strict;
+use Sys::Syslog qw( :DEFAULT );
 
 use lib `echo -n \$(x2gobasepath)/lib/x2go`;
 use x2godbwrapper; 
+use x2gologlevel;
+
+openlog($0,'cons,pid','user');
+setlogmask( LOG_UPTO(x2gologlevel()) );
 
 
 my $cookie=shift or die;
diff --git a/x2goserver/lib/x2gogetagent b/x2goserver/lib/x2gogetagent
index 5987942..635a731 100755
--- a/x2goserver/lib/x2gogetagent
+++ b/x2goserver/lib/x2gogetagent
@@ -21,9 +21,15 @@
 # Copyright (C) 2007-2011  Heinz-Markus Graesing &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/x2go-commits">heinz-m.graesing at obviously-nice.de</A>&gt;
 
 use strict;
+use Sys::Syslog qw( :DEFAULT );
 
 use lib `echo -n \$(x2gobasepath)/lib/x2go`;
 use x2godbwrapper; 
+use x2gologlevel;
+
+openlog($0,'cons,pid','user');
+setlogmask( LOG_UPTO(x2gologlevel()) );
+
 
 my $sid=shift or die;
 print db_getagent $sid;
diff --git a/x2goserver/lib/x2gogetdisplays b/x2goserver/lib/x2gogetdisplays
index e07b8b1..e6858d4 100755
--- a/x2goserver/lib/x2gogetdisplays
+++ b/x2goserver/lib/x2gogetdisplays
@@ -21,9 +21,15 @@
 # Copyright (C) 2007-2011  Heinz-Markus Graesing &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/x2go-commits">heinz-m.graesing at obviously-nice.de</A>&gt;
 
 use strict;
+use Sys::Syslog qw( :DEFAULT );
 
 use lib `echo -n \$(x2gobasepath)/lib/x2go`;
 use x2godbwrapper; 
+use x2gologlevel;
+
+openlog($0,'cons,pid','user');
+setlogmask( LOG_UPTO(x2gologlevel()) );
+
 
 my $host=shift or die;
 print join(&quot;\n&quot;, db_getdisplays($host));
diff --git a/x2goserver/lib/x2gogetports b/x2goserver/lib/x2gogetports
index 27dc74c..aee7151 100755
--- a/x2goserver/lib/x2gogetports
+++ b/x2goserver/lib/x2gogetports
@@ -21,9 +21,15 @@
 # Copyright (C) 2007-2011  Heinz-Markus Graesing &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/x2go-commits">heinz-m.graesing at obviously-nice.de</A>&gt;
 
 use strict;
+use Sys::Syslog qw( :DEFAULT );
 
-use lib `echo -n \$(x2gobasepath)/lib/x2go`;;
+use lib `echo -n \$(x2gobasepath)/lib/x2go`;
 use x2godbwrapper; 
+use x2gologlevel;
+
+openlog($0,'cons,pid','user');
+setlogmask( LOG_UPTO(x2gologlevel()) );
+
 
 my $host=shift or die;
 print join(&quot;\n&quot;, db_getports($host));
diff --git a/x2goserver/lib/x2gogetservers b/x2goserver/lib/x2gogetservers
index fcc57a8..a776dff 100755
--- a/x2goserver/lib/x2gogetservers
+++ b/x2goserver/lib/x2gogetservers
@@ -21,8 +21,14 @@
 # Copyright (C) 2007-2011  Heinz-Markus Graesing &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/x2go-commits">heinz-m.graesing at obviously-nice.de</A>&gt;
 
 use strict;
+use Sys::Syslog qw( :DEFAULT );
 
 use lib `echo -n \$(x2gobasepath)/lib/x2go`;
 use x2godbwrapper; 
+use x2gologlevel;
+
+openlog($0,'cons,pid','user');
+setlogmask( LOG_UPTO(x2gologlevel()) );
+
 
 print join(&quot;\n&quot;, db_getservers);
diff --git a/x2goserver/lib/x2goinsertport b/x2goserver/lib/x2goinsertport
index 1458348..ae5fc5b 100755
--- a/x2goserver/lib/x2goinsertport
+++ b/x2goserver/lib/x2goinsertport
@@ -21,9 +21,15 @@
 # Copyright (C) 2007-2011  Heinz-Markus Graesing &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/x2go-commits">heinz-m.graesing at obviously-nice.de</A>&gt;
 
 use strict;
+use Sys::Syslog qw( :DEFAULT );
 
 use lib `echo -n \$(x2gobasepath)/lib/x2go`;
 use x2godbwrapper; 
+use x2gologlevel;
+
+openlog($0,'cons,pid','user');
+setlogmask( LOG_UPTO(x2gologlevel()) );
+
 
 my $server=shift or die;
 my $sid=shift or die;
diff --git a/x2goserver/lib/x2goinsertsession b/x2goserver/lib/x2goinsertsession
index 74b0c25..b4fdbfa 100755
--- a/x2goserver/lib/x2goinsertsession
+++ b/x2goserver/lib/x2goinsertsession
@@ -21,9 +21,15 @@
 # Copyright (C) 2007-2011  Heinz-Markus Graesing &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/x2go-commits">heinz-m.graesing at obviously-nice.de</A>&gt;
 
 use strict;
+use Sys::Syslog qw( :DEFAULT );
 
 use lib `echo -n \$(x2gobasepath)/lib/x2go`;
 use x2godbwrapper; 
+use x2gologlevel;
+
+openlog($0,'cons,pid','user');
+setlogmask( LOG_UPTO(x2gologlevel()) );
+
 
 my $display=shift or die;
 my $server=shift or die;
diff --git a/x2goserver/lib/x2golistsessions_root b/x2goserver/lib/x2golistsessions_root
index 1e60493..af64328 100755
--- a/x2goserver/lib/x2golistsessions_root
+++ b/x2goserver/lib/x2golistsessions_root
@@ -20,8 +20,16 @@
 # Copyright (C) 2007-2011  Oleksandr Shneyder &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/x2go-commits">oleksandr.shneyder at obviously-nice.de</A>&gt;
 # Copyright (C) 2007-2011  Heinz-Markus Graesing &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/x2go-commits">heinz-m.graesing at obviously-nice.de</A>&gt;
 
-use Sys::Hostname;
 use strict;
+use Sys::Hostname;
+use Sys::Syslog qw( :DEFAULT );
+
+use lib `echo -n \$(x2gobasepath)/lib/x2go`;
+use x2gologlevel;
+
+openlog($0,'cons,pid','user');
+setlogmask( LOG_UPTO(x2gologlevel()) );
+
 
 sub check_stat
 {
diff --git a/x2goserver/lib/x2golistsessions_sql b/x2goserver/lib/x2golistsessions_sql
index 7ffd2e2..86a9c94 100755
--- a/x2goserver/lib/x2golistsessions_sql
+++ b/x2goserver/lib/x2golistsessions_sql
@@ -21,9 +21,15 @@
 # Copyright (C) 2007-2011  Heinz-Markus Graesing &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/x2go-commits">heinz-m.graesing at obviously-nice.de</A>&gt;
 
 use strict;
+use Sys::Syslog qw( :DEFAULT );
 
 use lib `echo -n \$(x2gobasepath)/lib/x2go`;
 use x2godbwrapper; 
+use x2gologlevel;
+
+openlog($0,'cons,pid','user');
+setlogmask( LOG_UPTO(x2gologlevel()) );
+
 
 my $serv=shift;
 my @array;
diff --git a/x2goserver/lib/x2gologlevel b/x2goserver/lib/x2gologlevel
index 0648f96..970ea15 100755
--- a/x2goserver/lib/x2gologlevel
+++ b/x2goserver/lib/x2gologlevel
@@ -22,21 +22,8 @@
 
 use strict;
 use Config::Simple;
-use Sys::Syslog qw( :standard :macros );
 
-my $Config = new Config::Simple(syntax=&gt;'ini');
-$Config-&gt;read('/etc/x2go/x2goserver.conf' );
+use lib `echo -n \$(x2gobasepath)/lib/x2go`;
+use x2gologlevel;
 
-my $strloglevel = $Config-&gt;param(&quot;log.loglevel&quot;);
-
-my $loglevel = LOG_NOTICE;
-if    ( $strloglevel eq &quot;emerg&quot; )  { $loglevel = LOG_EMERG; }
-elsif ( $strloglevel eq &quot;alert&quot; )  { $loglevel = LOG_ALERT; }
-elsif ( $strloglevel eq &quot;crit&quot; )   { $loglevel = LOG_CRIT; }
-elsif ( $strloglevel eq &quot;err&quot; )    { $loglevel = LOG_ERR; }
-elsif ( $strloglevel eq &quot;warn&quot; )   { $loglevel = LOG_WARNING; }
-elsif ( $strloglevel eq &quot;notice&quot; ) { $loglevel = LOG_NOTICE; }
-elsif ( $strloglevel eq &quot;info&quot; )   { $loglevel = LOG_INFO; }
-elsif ( $strloglevel eq &quot;debug&quot; )  { $loglevel = LOG_DEBUG; }
-
-print &quot;$loglevel&quot;;
+print x2gologlevel();
diff --git a/x2goserver/lib/x2gologlevel b/x2goserver/lib/x2gologlevel.pm
old mode 100755
new mode 100644
similarity index 65%
copy from x2goserver/lib/x2gologlevel
copy to x2goserver/lib/x2gologlevel.pm
index 0648f96..3d904e2
--- a/x2goserver/lib/x2gologlevel
+++ b/x2goserver/lib/x2gologlevel.pm
@@ -24,19 +24,25 @@ use strict;
 use Config::Simple;
 use Sys::Syslog qw( :standard :macros );
 
+use base 'Exporter';
+our @EXPORT = ( 'x2gologlevel' );
+
 my $Config = new Config::Simple(syntax=&gt;'ini');
 $Config-&gt;read('/etc/x2go/x2goserver.conf' );
 
 my $strloglevel = $Config-&gt;param(&quot;log.loglevel&quot;);
 
-my $loglevel = LOG_NOTICE;
-if    ( $strloglevel eq &quot;emerg&quot; )  { $loglevel = LOG_EMERG; }
-elsif ( $strloglevel eq &quot;alert&quot; )  { $loglevel = LOG_ALERT; }
-elsif ( $strloglevel eq &quot;crit&quot; )   { $loglevel = LOG_CRIT; }
-elsif ( $strloglevel eq &quot;err&quot; )    { $loglevel = LOG_ERR; }
-elsif ( $strloglevel eq &quot;warn&quot; )   { $loglevel = LOG_WARNING; }
-elsif ( $strloglevel eq &quot;notice&quot; ) { $loglevel = LOG_NOTICE; }
-elsif ( $strloglevel eq &quot;info&quot; )   { $loglevel = LOG_INFO; }
-elsif ( $strloglevel eq &quot;debug&quot; )  { $loglevel = LOG_DEBUG; }
+sub x2gologlevel {
+	my $loglevel = LOG_NOTICE;
+	if    ( $strloglevel eq &quot;emerg&quot; )  { $loglevel = LOG_EMERG; }
+	elsif ( $strloglevel eq &quot;alert&quot; )  { $loglevel = LOG_ALERT; }
+	elsif ( $strloglevel eq &quot;crit&quot; )   { $loglevel = LOG_CRIT; }
+	elsif ( $strloglevel eq &quot;err&quot; )    { $loglevel = LOG_ERR; }
+	elsif ( $strloglevel eq &quot;warn&quot; )   { $loglevel = LOG_WARNING; }
+	elsif ( $strloglevel eq &quot;notice&quot; ) { $loglevel = LOG_NOTICE; }
+	elsif ( $strloglevel eq &quot;info&quot; )   { $loglevel = LOG_INFO; }
+	elsif ( $strloglevel eq &quot;debug&quot; )  { $loglevel = LOG_DEBUG; }
+	return $loglevel;
+}
 
-print &quot;$loglevel&quot;;
+1;
\ No newline at end of file
diff --git a/x2goserver/lib/x2goresume b/x2goserver/lib/x2goresume
index e21006c..80010e1 100755
--- a/x2goserver/lib/x2goresume
+++ b/x2goserver/lib/x2goresume
@@ -21,9 +21,15 @@
 # Copyright (C) 2007-2011  Heinz-Markus Graesing &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/x2go-commits">heinz-m.graesing at obviously-nice.de</A>&gt;
 
 use strict;
+use Sys::Syslog qw( :DEFAULT );
 
 use lib `echo -n \$(x2gobasepath)/lib/x2go`;
 use x2godbwrapper; 
+use x2gologlevel;
+
+openlog($0,'cons,pid','user');
+setlogmask( LOG_UPTO(x2gologlevel()) );
+
 
 my $client=shift or die;
 my $sid=shift or die;
diff --git a/x2goserver/lib/x2gosessionlimit b/x2goserver/lib/x2gosessionlimit
index 3878c82..f2fc78c 100755
--- a/x2goserver/lib/x2gosessionlimit
+++ b/x2goserver/lib/x2gosessionlimit
@@ -22,6 +22,14 @@
 
 use strict;
 use Config::Simple;
+use Sys::Syslog qw( :DEFAULT );
+
+use lib `echo -n \$(x2gobasepath)/lib/x2go`;
+use x2gologlevel;
+
+openlog($0,'cons,pid','user');
+setlogmask( LOG_UPTO(x2gologlevel()) );
+
 
 my $maxlimit=0;
 my $Config = new Config::Simple(syntax=&gt;'ini');
diff --git a/x2goserver/lib/x2gosuspend-agent b/x2goserver/lib/x2gosuspend-agent
index 272d819..928cec4 100755
--- a/x2goserver/lib/x2gosuspend-agent
+++ b/x2goserver/lib/x2gosuspend-agent
@@ -20,6 +20,15 @@
 # Copyright (C) 2007-2011  Oleksandr Shneyder &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/x2go-commits">oleksandr.shneyder at obviously-nice.de</A>&gt;
 # Copyright (C) 2007-2011  Heinz-Markus Graesing &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/x2go-commits">heinz-m.graesing at obviously-nice.de</A>&gt;
 
+use Sys::Syslog qw( :DEFAULT );
+
+use lib `echo -n \$(x2gobasepath)/lib/x2go`;
+use x2gologlevel;
+
+openlog($0,'cons,pid','user');
+setlogmask( LOG_UPTO(x2gologlevel()) );
+
+
 shift;
 shift;
 shift;
diff --git a/x2goserver/sbin/x2gocleansessions b/x2goserver/sbin/x2gocleansessions
index b82214d..f8675ca 100755
--- a/x2goserver/sbin/x2gocleansessions
+++ b/x2goserver/sbin/x2gocleansessions
@@ -21,9 +21,16 @@
 # Copyright (C) 2007-2011  Heinz-Markus Graesing &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/x2go-commits">heinz-m.graesing at obviously-nice.de</A>&gt;
 
 use Sys::Hostname;
+use Sys::Syslog qw( :DEFAULT );
 use strict;
 
 my $x2go_lib_path=`echo -n \$(x2gobasepath)/lib/x2go`;
+use lib $x2go_lib_path;
+use x2gologlevel;
+
+openlog($0,'cons,pid','user');
+setlogmask( LOG_UPTO(x2gologlevel()) );
+
 
 sub check_pid
 {
diff --git a/x2goserver/sbin/x2godbadmin b/x2goserver/sbin/x2godbadmin
index b03e6aa..a789afd 100755
--- a/x2goserver/sbin/x2godbadmin
+++ b/x2goserver/sbin/x2godbadmin
@@ -21,11 +21,17 @@
 # Copyright (C) 2007-2011  Heinz-Markus Graesing &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/x2go-commits">heinz-m.graesing at obviously-nice.de</A>&gt;
 
 use strict;
-
+use Sys::Syslog qw( :DEFAULT );
 use Getopt::Long;
 use Config::Simple;   
 use DBI;
 
+use lib `echo -n \$(x2gobasepath)/lib/x2go`;
+use x2gologlevel;
+
+openlog($0,'cons,pid','user');
+setlogmask( LOG_UPTO(x2gologlevel()) );
+
 sub show_usage()
 {
 	print &quot;X2Go SQL admin interface. Use it to create x2go database and insert or remove users or groups in x2go database\n&quot;.
diff --git a/x2goserver/sbin/x2golistsessions_root b/x2goserver/sbin/x2golistsessions_root
index df92ff5..24bb5d4 100755
--- a/x2goserver/sbin/x2golistsessions_root
+++ b/x2goserver/sbin/x2golistsessions_root
@@ -19,8 +19,16 @@
 # Copyright (C) 2007-2011  Oleksandr Shneyder &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/x2go-commits">oleksandr.shneyder at obviously-nice.de</A>&gt;
 # Copyright (C) 2007-2011  Heinz-Markus Graesing &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/x2go-commits">heinz-m.graesing at obviously-nice.de</A>&gt;
 
-use Sys::Hostname;
 use strict;
+use Sys::Hostname;
+use Sys::Syslog qw( :DEFAULT );
+
+use lib `echo -n \$(x2gobasepath)/lib/x2go`;
+use x2gologlevel;
+
+openlog($0,'cons,pid','user');
+setlogmask( LOG_UPTO(x2gologlevel()) );
+
 
 sub check_stat
 {


hooks/post-receive
-- 
x2goserver.git (X2go Server)

This is an automated email from the git hooks/post-receive script. It was
generated because a ref change was pushed to the repository containing
the project &quot;x2goserver.git&quot; (X2go Server).


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001421.html">[X2go-Commits] python-x2go.git - release/0.1.1.x (branch) updated:	0.1.1.4-23-gaaea664
</A></li>
	<LI>Next message: <A HREF="001423.html">[X2go-Commits] cups-x2go.git - master (branch) updated:	3.0.0.2-26-g247294d
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1422">[ date ]</a>
              <a href="thread.html#1422">[ thread ]</a>
              <a href="subject.html#1422">[ subject ]</a>
              <a href="author.html#1422">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/x2go-commits">More information about the X2go-commits
mailing list</a><br>
</body></html>
