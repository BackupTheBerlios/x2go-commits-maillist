<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [X2go-Commits] x2gothinclient.git - master (branch) updated:	1.0.1.8-8-gc325184
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/x2go-commits/2012-August/index.html" >
   <LINK REL="made" HREF="mailto:x2go-commits%40lists.berlios.de?Subject=Re%3A%20%5BX2go-Commits%5D%20x2gothinclient.git%20-%20master%20%28branch%29%20updated%3A%0A%091.0.1.8-8-gc325184&In-Reply-To=%3C20120823122052.8CC633BCDF%40ymir%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="003097.html">
   <LINK REL="Next"  HREF="003099.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[X2go-Commits] x2gothinclient.git - master (branch) updated:	1.0.1.8-8-gc325184</H1>
    <B>X2Go dev team</B> 
    <A HREF="mailto:x2go-commits%40lists.berlios.de?Subject=Re%3A%20%5BX2go-Commits%5D%20x2gothinclient.git%20-%20master%20%28branch%29%20updated%3A%0A%091.0.1.8-8-gc325184&In-Reply-To=%3C20120823122052.8CC633BCDF%40ymir%3E"
       TITLE="[X2go-Commits] x2gothinclient.git - master (branch) updated:	1.0.1.8-8-gc325184">git-admin at x2go.org
       </A><BR>
    <I>Thu Aug 23 14:20:52 CEST 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="003097.html">[X2go-Commits] x2gothinclient.git - master (branch) updated:	1.0.1.8-3-ga449f64
</A></li>
        <LI>Next message: <A HREF="003099.html">[X2go-Commits] x2gothinclient.git - master (branch) updated:	1.0.1.8-9-g60d6ff5
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3098">[ date ]</a>
              <a href="thread.html#3098">[ thread ]</a>
              <a href="subject.html#3098">[ subject ]</a>
              <a href="author.html#3098">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>The branch, master has been updated
       via  c325184220284304da96a190b5380db4d590dfdd (commit)
       via  145156970740eaa40ec081ced9a5d047f6f0919d (commit)
       via  12d42ec1454f055391d4039371873a9503705396 (commit)
       via  30e3aac705162504e222e5dc5d0ec0e05270394c (commit)
       via  d7ce549428428b76c605a24c6d117fac2072358c (commit)
      from  a449f64ce0b6054485d90da45092d7b306405cd3 (commit)

Those revisions listed above that are new to this repository have
not appeared on any other notification email; so we list those
revisions in full, below.

- Log -----------------------------------------------------------------
commit c325184220284304da96a190b5380db4d590dfdd
Author: Mike Gabriel &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/x2go-commits">mike.gabriel at das-netzwerkteam.de</A>&gt;
Date:   Thu Aug 23 14:20:13 2012 +0200

    Next upstream version will be 1.0.99.1: Step towards wheezy. Also: enable plymouth boot splash.

commit 145156970740eaa40ec081ced9a5d047f6f0919d
Author: Mike Gabriel &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/x2go-commits">mike.gabriel at das-netzwerkteam.de</A>&gt;
Date:   Thu Aug 23 14:07:17 2012 +0200

    Change method of mounting /proc, /sys and /dev inside of chroots.

commit 12d42ec1454f055391d4039371873a9503705396
Author: Mike Gabriel &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/x2go-commits">mike.gabriel at das-netzwerkteam.de</A>&gt;
Date:   Thu Aug 23 14:01:23 2012 +0200

    Fix x2go_tce_shell.sh script, escape braces.

commit 30e3aac705162504e222e5dc5d0ec0e05270394c
Author: Mike Gabriel &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/x2go-commits">mike.gabriel at das-netzwerkteam.de</A>&gt;
Date:   Thu Aug 23 14:00:18 2012 +0200

    Use sed to patch initramfs configuration (rather than a patch that fails on wheezy). The change is needed for squeeze only.

commit d7ce549428428b76c605a24c6d117fac2072358c
Author: Mike Gabriel &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/x2go-commits">mike.gabriel at das-netzwerkteam.de</A>&gt;
Date:   Thu Aug 23 13:58:12 2012 +0200

    Truncate echo output lines to less than 80 chars.

-----------------------------------------------------------------------

Summary of changes:
 debian/changelog                                   |   10 +++++-
 debian/control                                     |    5 ++-
 .../etc/x2gothinclient_settings                    |   18 ++++++++--
 .../sbin/x2gothinclient_cleanup                    |   16 ++++++---
 .../sbin/x2gothinclient_create                     |   34 ++++++++++++-------
 .../sbin/x2gothinclient_preptftpboot               |    3 +-
 x2gothinclientmanagement/sbin/x2gothinclient_shell |   21 ++++++++----
 .../sbin/x2gothinclient_update                     |    6 ++-
 .../sbin/x2gothinclient_upgrade                    |   19 +++++++---
 9 files changed, 91 insertions(+), 41 deletions(-)

The diff of changes is:
diff --git a/debian/changelog b/debian/changelog
index 2f360a0..4119c32 100644
--- a/debian/changelog
+++ b/debian/changelog
@@ -1,8 +1,14 @@
-x2gothinclient (1.0.1.9-0~x2go1) UNRELEASED; urgency=low
+x2gothinclient (1.0.99.1-0~x2go1) UNRELEASED; urgency=low
 
-  * New upstream version (1.0.1.9):
+  * New upstream version (1.0.99.1):
     - When X2Go TCE has plymouth installed, make sure pressing the
       halt button does not change to the wrong tty.
+    - Truncate echo output lines to less than 80 chars.
+    - Use sed to patch initramfs configuration (rather than a patch
+      that fails on wheezy). The change is needed for squeeze only.
+    - Fix x2go_tce_shell.sh script, escape braces.
+    - Change method of mounting /proc, /sys and /dev inside of chroots.
+    - Step towards wheezy, enable plymouth boot splash.
 
  -- Mike Gabriel &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/x2go-commits">mike.gabriel at das-netzwerkteam.de</A>&gt;  Fri, 10 Aug 2012 14:13:49 +0200
 
diff --git a/debian/control b/debian/control
index 21bf456..c87e6fc 100644
--- a/debian/control
+++ b/debian/control
@@ -50,7 +50,8 @@ Depends:
  x2goclient (&gt;= 3.99.1.1-0~),
  xauth,
  xinit,
- locales
+ locales,
+ plymouth,
 Recommends:
  x2gocdmanager,
  x2gousbmount,
@@ -62,6 +63,8 @@ Recommends:
  mc,
  acpid,
  memtest86+
+Suggests:
+ plymouth-themes-all
 Breaks:
  x2gothinshutdown
 Replaces:
diff --git a/x2gothinclientmanagement/etc/x2gothinclient_settings b/x2gothinclientmanagement/etc/x2gothinclient_settings
index 283a62d..5140599 100644
--- a/x2gothinclientmanagement/etc/x2gothinclient_settings
+++ b/x2gothinclientmanagement/etc/x2gothinclient_settings
@@ -18,6 +18,9 @@
 # Free Software Foundation, Inc.,
 # 51 Franklin St, Fifth Floor, Boston, MA 02110-1301, USA.
 
+# name of this instance of the X2Go TCE (appears during thinclient boot process)
+TC_PRETTY_NAME=&quot;X2Go TCE&quot;
+
 # base path for X2Go thin client files
 TC_BASE=&quot;/opt/x2gothinclient&quot;
 
@@ -33,13 +36,18 @@ TC_SHELL=&quot;bash&quot;
 # Debian package mirror to use...
 TC_DEBMIRROR_URL=&quot;<A HREF="http://ftp.debian.org/debian">http://ftp.debian.org/debian</A>&quot;
 
+# Distro codename to use...
+#TC_DISTRO_CODENAME=&quot;wheezy&quot;
+# or use older Debian squeeze...
+TC_DISTRO_CODENAME=&quot;squeeze&quot;
+
 # Retrieve X2Go packages from this URL
-TC_X2GO_DEBURL=&quot;deb <A HREF="http://packages.x2go.org/debian">http://packages.x2go.org/debian</A> stable main&quot;
+TC_X2GO_DEBURL=&quot;deb <A HREF="http://packages.x2go.org/debian">http://packages.x2go.org/debian</A> $TC_DISTRO_CODENAME main&quot;
 
 # Use a http/ftp proxy during debootstrap (leave empty if direct connections to http/ftp are allowed)
-# TC_HTTP_PROXY=&quot;<A HREF="http://proxy.mydomain.com:8080">http://proxy.mydomain.com:8080</A>&quot;
-# TC_HTTPS_PROXY=&quot;<A HREF="http://proxy.mydomain.com:8080">http://proxy.mydomain.com:8080</A>&quot;
-# TC_FTP_PROXY=&quot;<A HREF="http://proxy.mydomain.com:8080">http://proxy.mydomain.com:8080</A>&quot;
+#TC_HTTP_PROXY=&quot;<A HREF="http://webcache.intern:3128">http://webcache.intern:3128</A>&quot;
+#TC_HTTPS_PROXY=&quot;<A HREF="http://webcache.intern:3128">http://webcache.intern:3128</A>&quot;
+#TC_FTP_PROXY=&quot;<A HREF="http://webcache.intern:3128">http://webcache.intern:3128</A>&quot;
 TC_HTTP_PROXY=&quot;&quot;
 TC_HTTPS_PROXY=&quot;&quot;
 TC_FTP_PROXY=&quot;&quot;
@@ -56,10 +64,12 @@ echo &quot;=============================&quot;
 echo &quot;The X2Go Thin Client Environment is using the following&quot;
 echo &quot;settings:&quot;
 echo
+echo &quot;TC_PRETTY_NAME=$TC_PRETTY_NAME&quot;
 echo &quot;TC_BASE=$TC_BASE&quot;
 echo &quot;TC_CONFIG=$TC_CONFIG&quot;
 echo &quot;TC_CHROOT=$TC_CHROOT&quot;
 echo &quot;TC_SHELL=$TC_SHELL&quot;
+ecjp &quot;TC_DISTRO_CODENAME=$TC_DISTRO_CODENAME&quot;
 echo &quot;TC_DEBMIRROR_URL=$TC_DEBMIRROR_URL&quot;
 echo &quot;TC_X2GO_DEBURL=$TC_X2GO_DEBURL&quot;
 echo &quot;TC_HTTP_PROXY=$TC_HTTP_PROXY&quot;
diff --git a/x2gothinclientmanagement/sbin/x2gothinclient_cleanup b/x2gothinclientmanagement/sbin/x2gothinclient_cleanup
index 98855fd..c17ab19 100755
--- a/x2gothinclientmanagement/sbin/x2gothinclient_cleanup
+++ b/x2gothinclientmanagement/sbin/x2gothinclient_cleanup
@@ -38,14 +38,17 @@ TC_CONFIG=&quot;${TC_CONFIG:-$TC_BASE/etc}&quot;
 TC_TFTP_BOOT=&quot;${TC_TFTP_BOOT:-/srv/tftp}&quot;
 
 [ &quot;x$USER&quot; == &quot;xroot&quot; ] || { 
-    echo &quot;ERROR: X2Go Thin Client management scripts have to run as super-user root.&quot;
+    echo &quot;ERROR: X2Go Thin Client management scripts have to run&quot;
+    echo &quot;as super-user root.&quot;
     exit -2
 }
 
 echo &quot;X2go TCE cleanup...&quot;
 echo &quot;-------------------&quot;
 
-echo &quot;Hit &lt;RETURN&gt; to purge all X2Go TCE related files (chroot, TCE config, PXE boot env)...&quot;
+echo &quot;Hit &lt;RETURN&gt; to purge all X2Go TCE related files (chroot,&quot;
+echo &quot;TCE config, PXE boot env)...&quot;
+echo
 echo &quot;Alternatively, hit STRG-C to cancel the operation now!!!&quot;
 read
 
@@ -54,13 +57,15 @@ test -e &quot;$TC_CHROOT&quot; &amp;&amp; {
     echo &quot;Removing $TC_CHROOT...&quot;
     rm -Rf &quot;${TC_CHROOT}&quot;
 } || {
-    echo &quot;WARNING: X2Go Thin Client chroot does not exist at $TC_CHROOT. No cleanup necessary...&quot;
+    echo &quot;WARNING: X2Go Thin Client chroot does not exist&quot;
+    echo &quot;at $TC_CHROOT. No cleanup necessary...&quot;
 }
 test -e &quot;$TC_CONFIG&quot; &amp;&amp; {
     echo &quot;Removing $TC_CONFIG...&quot;
     rm -Rf &quot;${TC_CONFIG}&quot;
 } || {
-    echo &quot;WARNING: X2Go Thin Client config does not exist at $TC_CONFIG. No cleanup necessary...&quot;
+    echo &quot;WARNING: X2Go Thin Client config does not exist&quot;
+    echo &quot;at $TC_CONFIG. No cleanup necessary...&quot;
 }
 
 ### PXE/Syslinux
@@ -68,7 +73,8 @@ test -e &quot;$TC_TFTP_BOOT/pxelinux.cfg&quot; &amp;&amp; {
     echo &quot;Emptying $TC_TFTP_BOOT...&quot;
     rm -Rf &quot;${TC_TFTP_BOOT}&quot;/*
 } || {
-    echo &quot;WARNING: X2Go PXE/Syslinux boot environment does not exist at $TC_TFTP_BOOT. No cleanup necessary...&quot;
+    echo &quot;WARNING: X2Go PXE/Syslinux boot environment does not exist&quot;
+    echo &quot;at $TC_TFTP_BOOT. No cleanup necessary...&quot;
 }
 
 echo
diff --git a/x2gothinclientmanagement/sbin/x2gothinclient_create b/x2gothinclientmanagement/sbin/x2gothinclient_create
index a14ae17..6da1543 100755
--- a/x2gothinclientmanagement/sbin/x2gothinclient_create
+++ b/x2gothinclientmanagement/sbin/x2gothinclient_create
@@ -38,8 +38,9 @@ source $ETCDIR/x2gothinclient_settings
 TC_BASE=&quot;${TC_BASE:-/opt/x2gothinclient}&quot;
 TC_CHROOT=&quot;${TC_CHROOT:-$TC_BASE/chroot}&quot;
 TC_CONFIG=&quot;${TC_CONFIG:-$TC_BASE/etc}&quot;
+TC_DISTRO_CODENAME=&quot;${IK_DISTRO_CODENAME:-squeeze}&quot;
 TC_DEBMIRROR_URL=&quot;${TC_DEBMIRROR_URL:-'<A HREF="http://ftp.debian.org/debian">http://ftp.debian.org/debian</A>'}&quot;
-TC_X2GO_DEBURL=&quot;${TC_X2GO_DEBURL:-'deb <A HREF="http://packages.x2go.org">http://packages.x2go.org</A> stable main'}&quot;
+TC_X2GO_DEBURL=&quot;${TC_X2GO_DEBURL:-'deb <A HREF="http://packages.x2go.org">http://packages.x2go.org</A> $TC_DISTRO_CODENAME main'}&quot;
 TC_MODULE_BLACKLIST=&quot;${TC_MODULE_BLACKLIST:-'pcspkr'}&quot;
 
 test -e &quot;$TC_CHROOT&quot; &amp;&amp; { 
@@ -53,7 +54,9 @@ test -e &quot;$TC_CHROOT&quot; &amp;&amp; {
     exit -2
 }
 
-echo &quot;Hit &lt;RETURN&gt; to continue with X2Go TCE chroot creation using the above TCE parameters...&quot;
+echo &quot;Hit &lt;RETURN&gt; to continue with X2Go TCE chroot creation using&quot;
+echo &quot;the above TCE parameters...&quot;
+echo
 echo &quot;Alternatively, hit STRG-C to cancel the operation now!!!&quot;
 read
 
@@ -73,7 +76,7 @@ export http_proxy=&quot;$TC_HTTP_PROXY&quot;
 export https_proxy=&quot;$TC_HTTPS_PROXY&quot;
 export ftp_proxy=&quot;$TC_FTP_PROXY&quot;
 
-debootstrap --arch i386 stable $TC_CHROOT/ $TC_DEBMIRROR_URL
+debootstrap --arch i386 $TC_DISTRO_CODENAME $TC_CHROOT/ $TC_DEBMIRROR_URL
 cp /etc/resolv.conf $TC_CHROOT/etc/resolv.conf
 echo &quot;auto lo&quot; &gt;&gt;   $TC_CHROOT/etc/network/interfaces
 echo &quot;iface lo inet loopback&quot; &gt;&gt;   $TC_CHROOT/etc/network/interfaces
@@ -101,8 +104,6 @@ cat &gt; $TC_CHROOT/x2go_tce_install.sh &lt;&lt;EOF
 #!/bin/bash
 
 export LANG=C
-mount /proc
-mount /dev/pts
 export HOME=/root
 export http_proxy=$TC_HTTP_PROXY
 export https_proxy=$TC_HTTPS_PROXY
@@ -143,12 +144,8 @@ chmod +x /sbin/start-stop-daemon
 # Pulsaudio must come afterwards until the thinclient-package is fixed
 [ \$? -eq 0 ] &amp;&amp; apt-get install alsa-base pulseaudio -y
 [ \$? -eq 0 ] &amp;&amp; apt-get install patch -y
-[ \$? -eq 0 ] &amp;&amp; patch /etc/initramfs-tools/initramfs.conf &lt;&lt;PATCH
-39c39
-&lt; BOOT=local
----
-&gt; BOOT=nfs
-PATCH
+[ \$? -eq 0 ] &amp;&amp; sed -e 's/BOOT=local/BOOT=nfs/' -i /etc/initramfs-tools/initramfs.conf
+
 [ \$? -eq 0 ] &amp;&amp; rm -f /etc/udev/rules.d/*-persistent-*.rules
 [ \$? -eq 0 ] &amp;&amp; useradd x2goclient
 [ \$? -eq 0 ] &amp;&amp; adduser x2goclient audio
@@ -165,15 +162,26 @@ PATCH
 [ \$? -eq 0 ] &amp;&amp; rm -f /etc/mtab
 [ \$? -eq 0 ] &amp;&amp; ln -sf /proc/mounts /etc/mtab
 
+# tweak plymouth
+[ \$? -eq 0 ] &amp;&amp; test -e /etc/os-release &amp;&amp; sed -e 's/PRETTY_NAME=.*/PRETTY_NAME=$IK_PRETTY_NAME/' -i /etc/os-release || echo &quot;PRETTY_NAME=$IK_PRETTY_NAME&quot; &gt;&gt; /etc/os-release
+
 # restore start-stop-daemon
 [ \$(stat --format '%s' /sbin/start-stop-daemon) -lt 200 ] &amp;&amp; mv /sbin/start-stop-daemon.keep /sbin/start-stop-daemon
 
-umount -l /proc &amp;&gt;/dev/null
-umount -l /dev/pts &amp;&gt;/dev/null
 EOF
 chmod u+x $TC_CHROOT/x2go_tce_install.sh
+
+mkdir -p $TC_CHROOT/{proc,dev,sys}
+mount --bind /proc $TC_CHROOT/proc
+mount --bind /dev $TC_CHROOT/dev
+mount --bind /sys $TC_CHROOT/sys
+
 chroot $TC_CHROOT /x2go_tce_install.sh
 
+umount $TC_CHROOT/proc
+umount $TC_CHROOT/dev
+umount $TC_CHROOT/sys
+
 rm -f $TC_CHROOT/etc/udev/rules.d/*-persistent-*.rules
 
 x2gothinclient_update
diff --git a/x2gothinclientmanagement/sbin/x2gothinclient_preptftpboot b/x2gothinclientmanagement/sbin/x2gothinclient_preptftpboot
index a011f8b..1dd9101 100755
--- a/x2gothinclientmanagement/sbin/x2gothinclient_preptftpboot
+++ b/x2gothinclientmanagement/sbin/x2gothinclient_preptftpboot
@@ -49,7 +49,8 @@ test -e &quot;$TC_TFTP_BOOT/pxelinux.cfg&quot; &amp;&amp; {
 }
 
 [ &quot;x$USER&quot; == &quot;xroot&quot; ] || { 
-    echo &quot;ERROR: X2Go Thin Client management scripts have to run as super-user root.&quot;
+    echo &quot;ERROR: X2Go Thin Client management scripts have to run&quot;
+    echo &quot;as super-user root.&quot;
     exit -2
 }
 
diff --git a/x2gothinclientmanagement/sbin/x2gothinclient_shell b/x2gothinclientmanagement/sbin/x2gothinclient_shell
index 625bb16..67a8203 100755
--- a/x2gothinclientmanagement/sbin/x2gothinclient_shell
+++ b/x2gothinclientmanagement/sbin/x2gothinclient_shell
@@ -42,14 +42,13 @@ test -e &quot;$TC_CHROOT&quot; || {
 }
 
 [ &quot;x$USER&quot; == &quot;xroot&quot; ] || { 
-    echo &quot;ERROR: X2Go Thin Client management scripts have to run as super-user root.&quot;
+    echo &quot;ERROR: X2Go Thin Client management scripts have to run&quot;
+    echo &quot;as super-user root.&quot;
     exit -2
 }
 
 cat &gt; &quot;$TC_CHROOT/x2go_tce_shell.sh&quot; &lt;&lt;EOF
 #!/bin/bash
-mount /proc &amp;&gt; /dev/null
-mount /dev/pts &amp;&gt; /dev/null
 export HOME=/root
 
 # export the proxy server (if any) to the shell.
@@ -59,7 +58,7 @@ export ftp_proxy=$TC_FTP_PROXY
 
 echo 'This shell has been started in your X2Go Thin Clients chroot environment.'
 echo 'All changes performed here will take effect on your X2Go Thin Clients'
-echo 'after their next (re)boot. So be careful!!!'
+echo 'after their next \(re\)boot. So be careful!!!'
 echo
 echo &quot;To return from this chroot shell hit STRG+D or type ,,exit'' on the&quot;
 echo 'command line...'
@@ -78,12 +77,20 @@ chmod +x /sbin/start-stop-daemon
 # restore start-stop-daemon
 [ \$(stat --format '%s' /sbin/start-stop-daemon) -lt 200 ] &amp;&amp; mv /sbin/start-stop-daemon.keep /sbin/start-stop-daemon
 
-umount -l /proc &amp;&gt; /dev/null
-umount -l /dev/pts &amp;&gt; /dev/null
-
 echo
 echo &quot;X2go Thin Client Shell has exited.&quot;
 echo
 EOF
 chmod u+x &quot;$TC_CHROOT/x2go_tce_shell.sh&quot;
+
+mkdir -p $TC_CHROOT/{proc,dev,sys}
+mount --bind /proc $TC_CHROOT/proc
+mount --bind /dev $TC_CHROOT/dev
+mount --bind /sys $TC_CHROOT/sys
+
 chroot &quot;$TC_CHROOT&quot; /x2go_tce_shell.sh
+
+umount $TC_CHROOT/proc
+umount $TC_CHROOT/dev
+umount $TC_CHROOT/sys
+
diff --git a/x2gothinclientmanagement/sbin/x2gothinclient_update b/x2gothinclientmanagement/sbin/x2gothinclient_update
index 4df9ff3..24f2d8b 100755
--- a/x2gothinclientmanagement/sbin/x2gothinclient_update
+++ b/x2gothinclientmanagement/sbin/x2gothinclient_update
@@ -43,12 +43,14 @@ test -e &quot;$TC_CHROOT&quot; || {
 }
 
 test -e &quot;$TC_CONFIG&quot; || { 
-    echo &quot;ERROR: No X2Go Thin Client configuration found at $TC_CONFIG. Please check...&quot;
+    echo &quot;ERROR: No X2Go Thin Client configuration found&quot;
+    echo &quot;at $TC_CONFIG. Please check...&quot;
     exit -1
 }
 
 [ &quot;x$USER&quot; == &quot;xroot&quot; ] || { 
-    echo &quot;ERROR: X2Go Thin Client management scripts have to run as super-user root.&quot;
+    echo &quot;ERROR: X2Go Thin Client management scripts have to run&quot;
+    echo &quot;as super-user root.&quot;
     exit -2
 }
 
diff --git a/x2gothinclientmanagement/sbin/x2gothinclient_upgrade b/x2gothinclientmanagement/sbin/x2gothinclient_upgrade
index a206837..8f8c61e 100755
--- a/x2gothinclientmanagement/sbin/x2gothinclient_upgrade
+++ b/x2gothinclientmanagement/sbin/x2gothinclient_upgrade
@@ -41,14 +41,13 @@ test -e &quot;$TC_CHROOT&quot; || {
 }
 
 [ &quot;x$USER&quot; == &quot;xroot&quot; ] || { 
-    echo &quot;ERROR: X2Go Thin Client management scripts have to run as super-user root.&quot;
+    echo &quot;ERROR: X2Go Thin Client management scripts have to run&quot;
+    echo &quot;as super-user root.&quot;
     exit -2
 }
 
 cat &gt; &quot;$TC_CHROOT/x2go_tce_upgrade.sh&quot; &lt;&lt;EOF
 #!/bin/bash
-mount /proc &amp;&gt; /dev/null
-mount /dev/pts &amp;&gt; /dev/null
 export HOME=/root
 
 export http_proxy=$TC_HTTP_PROXY
@@ -76,12 +75,20 @@ done
 # restore start-stop-daemon
 [ \$(stat --format '%s' /sbin/start-stop-daemon) -lt 200 ] &amp;&amp; mv /sbin/start-stop-daemon.keep /sbin/start-stop-daemon
 
-umount -l /proc &amp;&gt; /dev/null
-umount -l /dev/pts &amp;&gt; /dev/null
-
 echo
 echo &quot;X2go Thin Client Shell upgrade has finished.&quot;
 echo
 EOF
 chmod u+x &quot;$TC_CHROOT/x2go_tce_upgrade.sh&quot;
+
+mkdir -p $TC_CHROOT/{proc,dev,sys}
+mount --bind /proc $TC_CHROOT/proc
+mount --bind /dev $TC_CHROOT/dev
+mount --bind /sys $TC_CHROOT/sys
+
 chroot &quot;$TC_CHROOT&quot; /x2go_tce_upgrade.sh
+
+umount $TC_CHROOT/proc
+umount $TC_CHROOT/dev
+umount $TC_CHROOT/sys
+


hooks/post-receive
-- 
x2gothinclient.git (X2Go Thin Client Environment)

This is an automated email from the git hooks/post-receive script. It was
generated because a ref change was pushed to the repository containing
the project &quot;x2gothinclient.git&quot; (X2Go Thin Client Environment).

</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="003097.html">[X2go-Commits] x2gothinclient.git - master (branch) updated:	1.0.1.8-3-ga449f64
</A></li>
	<LI>Next message: <A HREF="003099.html">[X2go-Commits] x2gothinclient.git - master (branch) updated:	1.0.1.8-9-g60d6ff5
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3098">[ date ]</a>
              <a href="thread.html#3098">[ thread ]</a>
              <a href="subject.html#3098">[ subject ]</a>
              <a href="author.html#3098">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/x2go-commits">More information about the X2go-commits
mailing list</a><br>
</body></html>
