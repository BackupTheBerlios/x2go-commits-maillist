<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [X2Go-Commits] nx-libs.git - build-baikal (branch) updated:	nxcompshad/3.5.0-2
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/x2go-commits/2013-August/index.html" >
   <LINK REL="made" HREF="mailto:x2go-commits%40lists.berlios.de?Subject=Re%3A%20%5BX2Go-Commits%5D%20nx-libs.git%20-%20build-baikal%20%28branch%29%20updated%3A%0A%09nxcompshad/3.5.0-2&In-Reply-To=%3C20130830142402.C74245DB64%40ymir%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="011715.html">
   <LINK REL="Next"  HREF="011721.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[X2Go-Commits] nx-libs.git - build-baikal (branch) updated:	nxcompshad/3.5.0-2</H1>
    <B>X2Go dev team</B> 
    <A HREF="mailto:x2go-commits%40lists.berlios.de?Subject=Re%3A%20%5BX2Go-Commits%5D%20nx-libs.git%20-%20build-baikal%20%28branch%29%20updated%3A%0A%09nxcompshad/3.5.0-2&In-Reply-To=%3C20130830142402.C74245DB64%40ymir%3E"
       TITLE="[X2Go-Commits] nx-libs.git - build-baikal (branch) updated:	nxcompshad/3.5.0-2">git-admin at x2go.org
       </A><BR>
    <I>Fri Aug 30 16:24:02 CEST 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="011715.html">[X2Go-Commits] nx-libs.git - build-baikal (branch) updated:	nxcompshad/3.3.0-2
</A></li>
        <LI>Next message: <A HREF="011721.html">[X2Go-Commits] nx-libs.git - build-baikal (branch) updated:	nxcompshad/3.4.0-1
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11717">[ date ]</a>
              <a href="thread.html#11717">[ thread ]</a>
              <a href="subject.html#11717">[ subject ]</a>
              <a href="author.html#11717">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>The branch, build-baikal has been updated
       via  bf85c6e696693ef5a277c0334c01493dedf4fadd (commit)
      from  c70adf725d3fea94eabdde467b8b8b106a796c0a (commit)

Those revisions listed above that are new to this repository have
not appeared on any other notification email; so we list those
revisions in full, below.

- Log -----------------------------------------------------------------
-----------------------------------------------------------------------

Summary of changes:
 nxcompshad/CHANGELOG       |   11 ++
 nxcompshad/Core.cpp        |    2 +-
 nxcompshad/Core.h          |    2 +-
 nxcompshad/Input.cpp       |    2 +-
 nxcompshad/Input.h         |    2 +-
 nxcompshad/LICENSE         |    2 +-
 nxcompshad/Logger.cpp      |    2 +-
 nxcompshad/Logger.h        |    2 +-
 nxcompshad/Makefile.in     |    2 +-
 nxcompshad/Manager.cpp     |    2 +-
 nxcompshad/Manager.h       |    2 +-
 nxcompshad/Misc.h          |    2 +-
 nxcompshad/Poller.h        |    2 +-
 nxcompshad/Regions.h       |    2 +-
 nxcompshad/Shadow.cpp      |    2 +-
 nxcompshad/Shadow.cpp.orig |  461 --------------------------------------------
 nxcompshad/Shadow.h        |    2 +-
 nxcompshad/Updater.cpp     |    2 +-
 nxcompshad/Updater.h       |    2 +-
 nxcompshad/VERSION         |    2 +-
 nxcompshad/Win.cpp         |    2 +-
 nxcompshad/Win.h           |    2 +-
 nxcompshad/X11.cpp         |   28 ++-
 nxcompshad/X11.h           |    2 +-
 24 files changed, 50 insertions(+), 492 deletions(-)
 mode change 100755 =&gt; 100644 nxcompshad/Makefile.in
 delete mode 100644 nxcompshad/Shadow.cpp.orig

The diff of changes is:
diff --git a/nxcompshad/CHANGELOG b/nxcompshad/CHANGELOG
index ea1ff45..3472a4a 100644
--- a/nxcompshad/CHANGELOG
+++ b/nxcompshad/CHANGELOG
@@ -1,5 +1,16 @@
 ChangeLog:
 
+nxcompshad-3.5.0-2
+
+- Fixed TR03G02189. Now key combinations involving the Shift keys
+  are recognized correctly.
+
+nxcompshad-3.5.0-1
+
+- Opened the 3.5.0 branch based on nxcompshad-3.4.0-3.
+
+- Updated copyright to year 2011.
+
 nxcompshad-3.4.0-3
 
 - Updated copyright to year 2010.
diff --git a/nxcompshad/Core.cpp b/nxcompshad/Core.cpp
index 6052de6..6f94493 100644
--- a/nxcompshad/Core.cpp
+++ b/nxcompshad/Core.cpp
@@ -1,6 +1,6 @@
 /**************************************************************************/
 /*                                                                        */
-/* Copyright (c) 2001, 2010 NoMachine, <A HREF="http://www.nomachine.com/.">http://www.nomachine.com/.</A>         */
+/* Copyright (c) 2001, 2011 NoMachine, <A HREF="http://www.nomachine.com/.">http://www.nomachine.com/.</A>         */
 /*                                                                        */
 /* NXCOMPSHAD, NX protocol compression and NX extensions to this software */
 /* are copyright of NoMachine. Redistribution and use of the present      */
diff --git a/nxcompshad/Core.h b/nxcompshad/Core.h
index b0a9943..9bc8a64 100644
--- a/nxcompshad/Core.h
+++ b/nxcompshad/Core.h
@@ -1,6 +1,6 @@
 /**************************************************************************/
 /*                                                                        */
-/* Copyright (c) 2001, 2010 NoMachine, <A HREF="http://www.nomachine.com/.">http://www.nomachine.com/.</A>         */
+/* Copyright (c) 2001, 2011 NoMachine, <A HREF="http://www.nomachine.com/.">http://www.nomachine.com/.</A>         */
 /*                                                                        */
 /* NXCOMPSHAD, NX protocol compression and NX extensions to this software */
 /* are copyright of NoMachine. Redistribution and use of the present      */
diff --git a/nxcompshad/Input.cpp b/nxcompshad/Input.cpp
index 09e77a8..f9bf181 100644
--- a/nxcompshad/Input.cpp
+++ b/nxcompshad/Input.cpp
@@ -1,6 +1,6 @@
 /**************************************************************************/
 /*                                                                        */
-/* Copyright (c) 2001, 2010 NoMachine, <A HREF="http://www.nomachine.com/.">http://www.nomachine.com/.</A>         */
+/* Copyright (c) 2001, 2011 NoMachine, <A HREF="http://www.nomachine.com/.">http://www.nomachine.com/.</A>         */
 /*                                                                        */
 /* NXCOMPSHAD, NX protocol compression and NX extensions to this software */
 /* are copyright of NoMachine. Redistribution and use of the present      */
diff --git a/nxcompshad/Input.h b/nxcompshad/Input.h
index 764508e..6250e79 100644
--- a/nxcompshad/Input.h
+++ b/nxcompshad/Input.h
@@ -1,6 +1,6 @@
 /**************************************************************************/
 /*                                                                        */
-/* Copyright (c) 2001, 2010 NoMachine, <A HREF="http://www.nomachine.com/.">http://www.nomachine.com/.</A>         */
+/* Copyright (c) 2001, 2011 NoMachine, <A HREF="http://www.nomachine.com/.">http://www.nomachine.com/.</A>         */
 /*                                                                        */
 /* NXCOMPSHAD, NX protocol compression and NX extensions to this software */
 /* are copyright of NoMachine. Redistribution and use of the present      */
diff --git a/nxcompshad/LICENSE b/nxcompshad/LICENSE
index 99d6e5c..2c7f95a 100644
--- a/nxcompshad/LICENSE
+++ b/nxcompshad/LICENSE
@@ -1,4 +1,4 @@
-Copyright (c) 2001, 2010 NoMachine - <A HREF="http://www.nomachine.com/.">http://www.nomachine.com/.</A>
+Copyright (c) 2001, 2011 NoMachine - <A HREF="http://www.nomachine.com/.">http://www.nomachine.com/.</A>
 
 NXCOMPSHAD and NX extensions to X are copyright of NoMachine.
 
diff --git a/nxcompshad/Logger.cpp b/nxcompshad/Logger.cpp
index 47e5e63..c367c5d 100644
--- a/nxcompshad/Logger.cpp
+++ b/nxcompshad/Logger.cpp
@@ -1,6 +1,6 @@
 /**************************************************************************/
 /*                                                                        */
-/* Copyright (c) 2001, 2010 NoMachine, <A HREF="http://www.nomachine.com/.">http://www.nomachine.com/.</A>         */
+/* Copyright (c) 2001, 2011 NoMachine, <A HREF="http://www.nomachine.com/.">http://www.nomachine.com/.</A>         */
 /*                                                                        */
 /* NXCOMP, NX protocol compression and NX extensions to this software     */
 /* are copyright of NoMachine. Redistribution and use of the present      */
diff --git a/nxcompshad/Logger.h b/nxcompshad/Logger.h
index 0a9cad9..94e4da8 100644
--- a/nxcompshad/Logger.h
+++ b/nxcompshad/Logger.h
@@ -1,6 +1,6 @@
 /**************************************************************************/
 /*                                                                        */
-/* Copyright (c) 2001, 2010 NoMachine, <A HREF="http://www.nomachine.com/.">http://www.nomachine.com/.</A>         */
+/* Copyright (c) 2001, 2011 NoMachine, <A HREF="http://www.nomachine.com/.">http://www.nomachine.com/.</A>         */
 /*                                                                        */
 /* NXCOMP, NX protocol compression and NX extensions to this software     */
 /* are copyright of NoMachine. Redistribution and use of the present      */
diff --git a/nxcompshad/Makefile.in b/nxcompshad/Makefile.in
old mode 100755
new mode 100644
index eaf5cab..1580a35
--- a/nxcompshad/Makefile.in
+++ b/nxcompshad/Makefile.in
@@ -1,6 +1,6 @@
 ############################################################################
 #                                                                          #
-#  Copyright (c) 2001, 2010 NoMachine, <A HREF="http://www.nomachine.com/.">http://www.nomachine.com/.</A>          #
+#  Copyright (c) 2001, 2011 NoMachine, <A HREF="http://www.nomachine.com/.">http://www.nomachine.com/.</A>          #
 #                                                                          #
 #  NXCOMP, NX protocol compression and NX extensions to this software      #
 #  are copyright of NoMachine. Redistribution and use of the present       #
diff --git a/nxcompshad/Manager.cpp b/nxcompshad/Manager.cpp
index 38b92c2..ba9260a 100644
--- a/nxcompshad/Manager.cpp
+++ b/nxcompshad/Manager.cpp
@@ -1,6 +1,6 @@
 /**************************************************************************/
 /*                                                                        */
-/* Copyright (c) 2001, 2010 NoMachine, <A HREF="http://www.nomachine.com/.">http://www.nomachine.com/.</A>         */
+/* Copyright (c) 2001, 2011 NoMachine, <A HREF="http://www.nomachine.com/.">http://www.nomachine.com/.</A>         */
 /*                                                                        */
 /* NXCOMPSHAD, NX protocol compression and NX extensions to this software */
 /* are copyright of NoMachine. Redistribution and use of the present      */
diff --git a/nxcompshad/Manager.h b/nxcompshad/Manager.h
index 6f87cdc..2677549 100644
--- a/nxcompshad/Manager.h
+++ b/nxcompshad/Manager.h
@@ -1,6 +1,6 @@
 /**************************************************************************/
 /*                                                                        */
-/* Copyright (c) 2001, 2010 NoMachine, <A HREF="http://www.nomachine.com/.">http://www.nomachine.com/.</A>         */
+/* Copyright (c) 2001, 2011 NoMachine, <A HREF="http://www.nomachine.com/.">http://www.nomachine.com/.</A>         */
 /*                                                                        */
 /* NXCOMPSHAD, NX protocol compression and NX extensions to this software */
 /* are copyright of NoMachine. Redistribution and use of the present      */
diff --git a/nxcompshad/Misc.h b/nxcompshad/Misc.h
index 3bcb266..6dc8635 100644
--- a/nxcompshad/Misc.h
+++ b/nxcompshad/Misc.h
@@ -1,6 +1,6 @@
 /**************************************************************************/
 /*                                                                        */
-/* Copyright (c) 2001, 2010 NoMachine, <A HREF="http://www.nomachine.com/.">http://www.nomachine.com/.</A>         */
+/* Copyright (c) 2001, 2011 NoMachine, <A HREF="http://www.nomachine.com/.">http://www.nomachine.com/.</A>         */
 /*                                                                        */
 /* NXCOMPSHAD, NX protocol compression and NX extensions to this software */
 /* are copyright of NoMachine. Redistribution and use of the present      */
diff --git a/nxcompshad/Poller.h b/nxcompshad/Poller.h
index 914ba1d..4435b5b 100644
--- a/nxcompshad/Poller.h
+++ b/nxcompshad/Poller.h
@@ -1,6 +1,6 @@
 /**************************************************************************/
 /*                                                                        */
-/* Copyright (c) 2001, 2010 NoMachine, <A HREF="http://www.nomachine.com/.">http://www.nomachine.com/.</A>         */
+/* Copyright (c) 2001, 2011 NoMachine, <A HREF="http://www.nomachine.com/.">http://www.nomachine.com/.</A>         */
 /*                                                                        */
 /* NXCOMPSHAD, NX protocol compression and NX extensions to this software */
 /* are copyright of NoMachine. Redistribution and use of the present      */
diff --git a/nxcompshad/Regions.h b/nxcompshad/Regions.h
index 8ea41ad..b9303dc 100644
--- a/nxcompshad/Regions.h
+++ b/nxcompshad/Regions.h
@@ -1,6 +1,6 @@
 /**************************************************************************/
 /*                                                                        */
-/* Copyright (c) 2001, 2010 NoMachine, <A HREF="http://www.nomachine.com/.">http://www.nomachine.com/.</A>         */
+/* Copyright (c) 2001, 2011 NoMachine, <A HREF="http://www.nomachine.com/.">http://www.nomachine.com/.</A>         */
 /*                                                                        */
 /* NXCOMPSHAD, NX protocol compression and NX extensions to this software */
 /* are copyright of NoMachine. Redistribution and use of the present      */
diff --git a/nxcompshad/Shadow.cpp b/nxcompshad/Shadow.cpp
index 6f2856c..f9525ad 100644
--- a/nxcompshad/Shadow.cpp
+++ b/nxcompshad/Shadow.cpp
@@ -1,6 +1,6 @@
 /**************************************************************************/
 /*                                                                        */
-/* Copyright (c) 2001, 2010 NoMachine, <A HREF="http://www.nomachine.com/.">http://www.nomachine.com/.</A>         */
+/* Copyright (c) 2001, 2011 NoMachine, <A HREF="http://www.nomachine.com/.">http://www.nomachine.com/.</A>         */
 /*                                                                        */
 /* NXCOMPSHAD, NX protocol compression and NX extensions to this software */
 /* are copyright of NoMachine. Redistribution and use of the present      */
diff --git a/nxcompshad/Shadow.cpp.orig b/nxcompshad/Shadow.cpp.orig
deleted file mode 100644
index 206eb2e..0000000
--- a/nxcompshad/Shadow.cpp.orig
+++ /dev/null
@@ -1,461 +0,0 @@
-/**************************************************************************/
-/*                                                                        */
-/* Copyright (c) 2001, 2010 NoMachine, <A HREF="http://www.nomachine.com/.">http://www.nomachine.com/.</A>         */
-/*                                                                        */
-/* NXCOMPSHAD, NX protocol compression and NX extensions to this software */
-/* are copyright of NoMachine. Redistribution and use of the present      */
-/* software is allowed according to terms specified in the file LICENSE   */
-/* which comes in the source distribution.                                */
-/*                                                                        */
-/* Check <A HREF="http://www.nomachine.com/licensing.html">http://www.nomachine.com/licensing.html</A> for applicability.       */
-/*                                                                        */
-/* NX and NoMachine are trademarks of Medialogic S.p.A.                   */
-/*                                                                        */
-/* All rights reserved.                                                   */
-/*                                                                        */
-/**************************************************************************/
-
-#include &lt;signal.h&gt;
-#include &lt;string.h&gt;
-
-#define PANIC
-#define WARNING
-#undef  TEST
-#undef  DEBUG
-
-#include &quot;Logger.h&quot;
-#include &quot;Shadow.h&quot;
-#include &quot;Poller.h&quot;
-#include &quot;Manager.h&quot;
-
-typedef struct {
-    KeySym  *map;
-    KeyCode minKeyCode,
-            maxKeyCode;
-    int     mapWidth;
-} KeySymsRec, *KeySymsPtr;
-
-KeySymsPtr NXShadowKeymap = NULL;
-
-ShadowOptions NXShadowOptions = {1, 1, -1};
-
-static int mirrorException = 0;
-
-static UpdateManager *updateManager;
-static Poller *poller;
-static Input *input;
-
-int NXShadowRemoveAllUpdaters();
-
-inline bool NXShadowNotInitialized()
-{
-  //
-  // updateManager depends on input and poller.
-  // So this test seem redundant.
-  //
-  // return (input == NULL) || (poller == NULL) || (updateManager == NULL);
-  //
-
-  return (updateManager == NULL);
-}
-
-#ifdef NEED_SIGNAL_HANDLER
-static void NXSignalHandler(int signal)
-{
-  logTest(&quot;NXSignalHandler&quot;, &quot;Got signal [%d]&quot;, signal);
-
-  if (signal == SIGINT)
-  {
-    mirrorException = 1;
-  }
-  else if (signal == SIGTERM)
-  {
-    mirrorException = 1;
-  }
-}
-
-static int NXInitSignal()
-{
-  logTrace(&quot;NXInitSignal&quot;);
-
-  struct sigaction sa;
-
-  sa.sa_handler = NXSignalHandler;
-  sigfillset(&amp;sa.sa_mask);
-  sa.sa_flags = 0;
-
-  int res;
-
-  while ((res = sigaction(SIGINT, &amp;sa, NULL)) == -1 &amp;&amp;
-             errno == EINTR);
-
-  if (res == -1)
-  {
-    logError(&quot;NXInitSignal&quot;, EGET());
-
-    return -1;
-  }
-
-  return 1;
-}
-#endif
-
-static void NXHandleException()
-{
-  if (mirrorException)
-  {
-    mirrorException = 0;
-
-    NXShadowRemoveAllUpdaters();
-  }
-}
-
-static int NXCreateInput(char *keymap, char *shadowDisplayName)
-{
-  logTrace(&quot;NXCreateInput&quot;);
-
-  input = new Input;
-
-  if (input == NULL)
-  {
-    logError(&quot;NXCreateInput&quot;, ESET(ENOMEM));
-
-    return -1;
-  }
-
-  input -&gt; setKeymap(keymap);
-
-  input -&gt; setShadowDisplayName(shadowDisplayName);
-
-  return 1;
-}
-
-static int NXCreatePoller(Display *display, Display **shadowDisplay)
-{
-  logTrace(&quot;NXCreatePoller&quot;);
-
-  if (input == NULL)
-  {
-    logError(&quot;NXCreatePoller&quot;, ESET(EBADFD));
-
-    return -1;
-  }
-
-  poller = new Poller(input,display);
-
-  if (poller == NULL)
-  {
-    logError(&quot;NXCreatePoller&quot;, ESET(ENOMEM));
-
-    return -1;
-  }
-
-  if (poller -&gt; init() == -1)
-  {
-    logTest(&quot;NXCreatePoller&quot;, &quot;Failed to initialize poller.&quot;);
-
-    return -1;
-  }
-
-  *shadowDisplay = poller -&gt; getShadowDisplay();
-
-  logTest(&quot;NXCreatePoller&quot;, &quot;Poller geometry [%d, %d], ShadowDisplay[%p].&quot;, poller -&gt; width(),
-              poller -&gt; height(), (Display *) *shadowDisplay);
-
-  return 1;
-}
-
-static int NXCreateUpdateManager()
-{
-  logTrace(&quot;NXCreateUpdateManager&quot;);
-
-  if (input == NULL || poller == NULL)
-  {
-    logError(&quot;NXCreateUpdateManager&quot;, ESET(EBADFD));
-
-    return -1;
-  }
-
-  updateManager = new UpdateManager(poller -&gt; width(), poller -&gt; height(),
-                                        poller -&gt; getFrameBuffer(), input);
-
-  if (updateManager == NULL)
-  {
-    logError(&quot;NXCreateUpdateManager&quot;, ESET(ENOMEM));
-
-    return -1;
-  }
-
-  return 1;
-}
-
-void  NXShadowResetOptions()
-{
-  NXShadowOptions.optionShmExtension = 1;
-  NXShadowOptions.optionDamageExtension = 1;
-}
-
-//
-// Exported functions.
-//
-
-int NXShadowHasUpdaters()
-{
-  logTrace(&quot;NXShadowHasUpdaters&quot;);
-
-  return (updateManager &amp;&amp; updateManager -&gt; numberOfUpdaters()) ? 1 : 0;
-}
-
-int NXShadowRemoveAllUpdaters()
-{
-  logTrace(&quot;NXShadowRemoveAllUpdaters&quot;);
-
-  return updateManager ? updateManager -&gt; removeAllUpdaters() : 0;
-}
-
-int NXShadowRemoveUpdater(UpdaterHandle handle)
-{
-  logTrace(&quot;NXShadowRemoveUpdater&quot;);
-
-  return updateManager ? updateManager -&gt; removeUpdater(handle) : 0;
-}
-
-UpdaterHandle NXShadowAddUpdater(char *displayName)
-{
-  logTrace(&quot;NXShadowAddUpdater&quot;);
-
-  return updateManager ? updateManager -&gt; addUpdater(displayName, NULL) : NULL;
-}
-
-int NXShadowAddUpdaterDisplay(void *dpy, int *w, int *h, unsigned char *d)
-{
-  Display *display = reinterpret_cast&lt;Display*&gt;(dpy);
-
-  logTrace(&quot;NXShadowAddUpdaterDisplay&quot;);
-
-  if ((updateManager ? updateManager -&gt; addUpdater(NULL, display) : NULL) == NULL)
-  {
-    logTest(&quot;NXShadowAddUpdaterDisplay&quot;, &quot;Error&quot;);
-
-    return 0;
-  }
-
-  *w = updateManager -&gt; getWidth();
-  *h = updateManager -&gt; getHeight();
-  *d = poller -&gt; depth();
-
-  return 1;
-}
-
-int NXShadowCreate(void *dpy, char *keymap, char* shadowDisplayName, void **shadowDpy)
-{
-  logTrace(&quot;NXShadowCreate&quot;);
-
-  Display *display = reinterpret_cast&lt;Display*&gt;(dpy);
-  Display **shadowDisplay = reinterpret_cast&lt;Display**&gt;(shadowDpy);
-
-/*  if (NXInitSignal() != 1)
-  {
-    logError(&quot;NXShadowCreate&quot;, EGET());
-
-    return -1;
-  }*/
-
-  if (NXCreateInput(keymap, shadowDisplayName) != 1)
-  {
-    logError(&quot;NXShadowCreate&quot;, EGET());
-
-    return -1;
-  }
-
-  if (NXCreatePoller(display, shadowDisplay) != 1)
-  {
-    logTest(&quot;NXShadowCreate&quot;, &quot;NXCreatePoller failed.&quot;);
-
-    return -1;
-  }
-
-  if (NXCreateUpdateManager() != 1)
-  {
-    logError(&quot;NXShadowCreate&quot;, EGET());
-
-    return -1;
-  }
-
-  return 1;
-}
-
-#if !defined(__CYGWIN32__) &amp;&amp; !defined(WIN32)
-
-void NXShadowSetDisplayUid(int uid)
-{
-  NXShadowOptions.optionShadowDisplayUid = uid;
-}
-
-void NXShadowDisableShm(void)
-{
-  logUser(&quot;NXShadowDisableShm: Disabling SHM.\n&quot;);
-
-  NXShadowOptions.optionShmExtension = 0;
-}
-
-void NXShadowDisableDamage(void)
-{
-  NXShadowOptions.optionDamageExtension = 0;
-}
-
-#endif
-
-void NXShadowDestroy()
-{
-  if (poller)
-  {
-    delete poller;
-
-    poller = NULL;
-  }
-
-  if (updateManager)
-  {
-    delete updateManager;
-
-    updateManager = NULL;
-  }
-
-  if (input)
-  {
-    delete input;
-
-    input = NULL;
-  }
-}
-
-void NXShadowHandleInput()
-{
-  logTrace(&quot;NXShadowHandleInput&quot;);
-
-  if (NXShadowNotInitialized())
-  {
-    logError(&quot;NXShadowHandleInput - NXShadow not properly initialized.&quot;, ESET(EBADFD));
-
-    return;
-  }
-
-  NXHandleException();
-
-  updateManager -&gt; handleInput();
-
-  poller -&gt; handleInput();
-}
-
-int NXShadowHasChanged(int (*callback)(void *), void *arg, int *suspended)
-{
-  int result;
-
-  logTrace(&quot;NXShadowHasChanged&quot;);
-
-  if (NXShadowNotInitialized())
-  {
-    logError(&quot;NXShadowHasChanged - NXShadow not properly initialized.&quot;, ESET(EBADFD));
-
-    return -1;
-  }
-
-  //
-  // FIXME
-  //updateManager -&gt; destroyUpdateManagerRegion();
-  //
-
-  updateManager -&gt; newRegion();
-
-#if !defined(__CYGWIN32__) &amp;&amp; !defined(WIN32)
-  poller -&gt; getEvents();
-#endif
-
-  result = poller -&gt; isChanged(callback, arg, suspended);
-
-  if (result == 1)
-  {
-    updateManager -&gt; addRegion(poller -&gt; lastUpdatedRegion());
-
-    return 1;
-  }
-  else if (result == -1)
-  {
-    logTest(&quot;NXShadowHasChanged&quot;, &quot;Scanline error.&quot;);
-    return -1;
-  }
-
-  return 0;
-}
-
-void NXShadowExportChanges(long *numRects, char **pBox)
-{
-  Region pReg;
-
-  logTrace(&quot;NXShadowExportChanges&quot;);
-
-  if (NXShadowNotInitialized())
-  {
-    logError(&quot;NXShadowExportChanges - NXShadow not properly initialized.&quot;, ESET(EBADFD));
-  }
-
-  updateManager -&gt; update();
-  pReg = updateManager -&gt; getUpdateManagerRegion();
-  *numRects = pReg -&gt; numRects;
-  *pBox = (char *)pReg -&gt; rects;
-
-  logTest(&quot;NXShadowExportChanges&quot;, &quot;numRects [%ld] pBox[%p], pReg-&gt;numRects[%ld], rects[%p], size[%lu]&quot;,
-              *numRects, *pBox, pReg -&gt; numRects, &amp;(pReg -&gt; rects -&gt; x2),
-                  (unsigned long) sizeof(pReg -&gt; rects -&gt; x2));
-}
-
-void NXShadowEvent(Display *display, XEvent event)
-{
-  poller -&gt; handleEvent(display, &amp;event);
-}
-
-void NXShadowWebKeyEvent(KeySym keysym, Bool isKeyPress)
-{
-  poller -&gt; handleWebKeyEvent(keysym, isKeyPress);
-}
-
-#ifdef __CYGWIN32__
-
-int NXShadowCaptureCursor(unsigned int wnd, void *vis)
-{
-  Window window = (Window)wnd;
-  Visual *visual = reinterpret_cast&lt;Visual*&gt;(vis);
-
-  logTrace(&quot;NXShadowCaptureCursor&quot;);
-
-  logTest(&quot;NXShadowCaptureCursor&quot;,&quot;Init&quot;);
-
-  return poller -&gt; updateCursor(window, visual);
-}
-
-#endif
-
-void NXShadowUpdateBuffer(void **buffer)
-{
-  char **fBuffer = reinterpret_cast&lt;char **&gt;(buffer);
-
-  if (*fBuffer != NULL)
-  {
-    poller -&gt; destroyFrameBuffer();
-
-    poller -&gt; init();
-  }
-
-  *fBuffer = poller -&gt; getFrameBuffer();
-
-  logTest(&quot;NXShadowUpdateBuffer&quot;,&quot;New frame buffer [0x%p]&quot;, (void *)*fBuffer);
-}
-
-void NXShadowInitKeymap(void *keysyms)
-{
-  NXShadowKeymap = (KeySymsPtr) keysyms;
-
-  logTest(&quot;NXShadowInitKeymap&quot;,&quot;KeySyms pointer [0x%p] mapWidth [%d]&quot;,
-              (void *)NXShadowKeymap, NXShadowKeymap -&gt; mapWidth);
-}
diff --git a/nxcompshad/Shadow.h b/nxcompshad/Shadow.h
index ef65c0b..e1eddb9 100644
--- a/nxcompshad/Shadow.h
+++ b/nxcompshad/Shadow.h
@@ -1,6 +1,6 @@
 /**************************************************************************/
 /*                                                                        */
-/* Copyright (c) 2001, 2010 NoMachine, <A HREF="http://www.nomachine.com/.">http://www.nomachine.com/.</A>         */
+/* Copyright (c) 2001, 2011 NoMachine, <A HREF="http://www.nomachine.com/.">http://www.nomachine.com/.</A>         */
 /*                                                                        */
 /* NXCOMPSHAD, NX protocol compression and NX extensions to this software */
 /* are copyright of NoMachine. Redistribution and use of the present      */
diff --git a/nxcompshad/Updater.cpp b/nxcompshad/Updater.cpp
index f1761ba..245c6ce 100644
--- a/nxcompshad/Updater.cpp
+++ b/nxcompshad/Updater.cpp
@@ -1,6 +1,6 @@
 /**************************************************************************/
 /*                                                                        */
-/* Copyright (c) 2001, 2010 NoMachine, <A HREF="http://www.nomachine.com/.">http://www.nomachine.com/.</A>         */
+/* Copyright (c) 2001, 2011 NoMachine, <A HREF="http://www.nomachine.com/.">http://www.nomachine.com/.</A>         */
 /*                                                                        */
 /* NXCOMPSHAD, NX protocol compression and NX extensions to this software */
 /* are copyright of NoMachine. Redistribution and use of the present      */
diff --git a/nxcompshad/Updater.h b/nxcompshad/Updater.h
index 4bcaa91..daa26c1 100644
--- a/nxcompshad/Updater.h
+++ b/nxcompshad/Updater.h
@@ -1,6 +1,6 @@
 /**************************************************************************/
 /*                                                                        */
-/* Copyright (c) 2001, 2010 NoMachine, <A HREF="http://www.nomachine.com/.">http://www.nomachine.com/.</A>         */
+/* Copyright (c) 2001, 2011 NoMachine, <A HREF="http://www.nomachine.com/.">http://www.nomachine.com/.</A>         */
 /*                                                                        */
 /* NXCOMPSHAD, NX protocol compression and NX extensions to this software */
 /* are copyright of NoMachine. Redistribution and use of the present      */
diff --git a/nxcompshad/VERSION b/nxcompshad/VERSION
index 1809198..1545d96 100644
--- a/nxcompshad/VERSION
+++ b/nxcompshad/VERSION
@@ -1 +1 @@
-3.4.0
+3.5.0
diff --git a/nxcompshad/Win.cpp b/nxcompshad/Win.cpp
index 3f1e489..481cbca 100644
--- a/nxcompshad/Win.cpp
+++ b/nxcompshad/Win.cpp
@@ -1,6 +1,6 @@
 /**************************************************************************/
 /*                                                                        */
-/* Copyright (c) 2001, 2010 NoMachine, <A HREF="http://www.nomachine.com/.">http://www.nomachine.com/.</A>         */
+/* Copyright (c) 2001, 2011 NoMachine, <A HREF="http://www.nomachine.com/.">http://www.nomachine.com/.</A>         */
 /*                                                                        */
 /* NXCOMPSHAD, NX protocol compression and NX extensions to this software */
 /* are copyright of NoMachine. Redistribution and use of the present      */
diff --git a/nxcompshad/Win.h b/nxcompshad/Win.h
index 72566b8..fe591ff 100644
--- a/nxcompshad/Win.h
+++ b/nxcompshad/Win.h
@@ -1,6 +1,6 @@
 /**************************************************************************/
 /*                                                                        */
-/* Copyright (c) 2001, 2010 NoMachine, <A HREF="http://www.nomachine.com/.">http://www.nomachine.com/.</A>         */
+/* Copyright (c) 2001, 2011 NoMachine, <A HREF="http://www.nomachine.com/.">http://www.nomachine.com/.</A>         */
 /*                                                                        */
 /* NXCOMPSHAD, NX protocol compression and NX extensions to this software */
 /* are copyright of NoMachine. Redistribution and use of the present      */
diff --git a/nxcompshad/X11.cpp b/nxcompshad/X11.cpp
index cb8f55f..2d1140f 100644
--- a/nxcompshad/X11.cpp
+++ b/nxcompshad/X11.cpp
@@ -1,6 +1,6 @@
 /**************************************************************************/
 /*                                                                        */
-/* Copyright (c) 2001, 2010 NoMachine, <A HREF="http://www.nomachine.com/.">http://www.nomachine.com/.</A>         */
+/* Copyright (c) 2001, 2011 NoMachine, <A HREF="http://www.nomachine.com/.">http://www.nomachine.com/.</A>         */
 /*                                                                        */
 /* NXCOMPSHAD, NX protocol compression and NX extensions to this software */
 /* are copyright of NoMachine. Redistribution and use of the present      */
@@ -981,6 +981,7 @@ void Poller::handleKeyboardEvent(Display *display, XEvent *event)
 
   Bool isKeyPress = False;
   Bool isModifier = False;
+  Bool isShiftComb = False;
   Bool skip = False;
 
   if (event -&gt; type == KeyPress)
@@ -1048,19 +1049,26 @@ void Poller::handleKeyboardEvent(Display *display, XEvent *event)
             (!modeSwitchOn &amp;&amp; !level3ShiftOn &amp;&amp; !altROn) &amp;&amp;
                 !skip)
     {
-      keysym = keymapKeycodeToKeysym(event -&gt; xkey.keycode, shadowKeysyms,
-                                         shadowMinKey, shadowMapWidth, 1);
-    }
+      KeySym tempKeysym = keymapKeycodeToKeysym(event -&gt; xkey.keycode, shadowKeysyms,
+                                                    shadowMinKey, shadowMapWidth, 1);
 
-    if ((!leftShiftOn &amp;&amp; !rightShiftOn) &amp;&amp;
-            (modeSwitchOn || level3ShiftOn || altROn))
+      if (tempKeysym == 0)
+      {
+        isShiftComb = True;
+      }
+      else
+      {
+        keysym = tempKeysym;
+      }
+    }
+    else if ((!leftShiftOn &amp;&amp; !rightShiftOn) &amp;&amp;
+                 (modeSwitchOn || level3ShiftOn || altROn))
     {
       keysym = keymapKeycodeToKeysym(event -&gt; xkey.keycode, shadowKeysyms,
                                          shadowMinKey, shadowMapWidth, 2);
     }
-
-    if ((leftShiftOn || rightShiftOn) &amp;&amp;
-            (modeSwitchOn || level3ShiftOn || altROn))
+    else if ((leftShiftOn || rightShiftOn) &amp;&amp;
+                 (modeSwitchOn || level3ShiftOn || altROn))
     {
       keysym = keymapKeycodeToKeysym(event -&gt; xkey.keycode, shadowKeysyms,
                                        shadowMinKey, shadowMapWidth, 3);
@@ -1103,7 +1111,7 @@ void Poller::handleKeyboardEvent(Display *display, XEvent *event)
    * Send fake modifier events.
    */
 
-  if (!isModifier)
+  if (!isModifier &amp;&amp; isShiftComb == False)
   {
     sendFakeModifierEvents(col, ((keysym &gt;&gt; 8) == 0) &amp;&amp; (keysym &gt;= XK_A) &amp;&amp; (keysym &lt;= XK_Z));
   }
diff --git a/nxcompshad/X11.h b/nxcompshad/X11.h
index d34fd3d..2127542 100644
--- a/nxcompshad/X11.h
+++ b/nxcompshad/X11.h
@@ -1,6 +1,6 @@
 /**************************************************************************/
 /*                                                                        */
-/* Copyright (c) 2001, 2010 NoMachine, <A HREF="http://www.nomachine.com/.">http://www.nomachine.com/.</A>         */
+/* Copyright (c) 2001, 2011 NoMachine, <A HREF="http://www.nomachine.com/.">http://www.nomachine.com/.</A>         */
 /*                                                                        */
 /* NXCOMPSHAD, NX protocol compression and NX extensions to this software */
 /* are copyright of NoMachine. Redistribution and use of the present      */


hooks/post-receive
-- 
nx-libs.git (NX (redistributed))

This is an automated email from the git hooks/post-receive script. It was
generated because a ref change was pushed to the repository containing
the project &quot;nx-libs.git&quot; (NX (redistributed)).

</PRE>









<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="011715.html">[X2Go-Commits] nx-libs.git - build-baikal (branch) updated:	nxcompshad/3.3.0-2
</A></li>
	<LI>Next message: <A HREF="011721.html">[X2Go-Commits] nx-libs.git - build-baikal (branch) updated:	nxcompshad/3.4.0-1
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11717">[ date ]</a>
              <a href="thread.html#11717">[ thread ]</a>
              <a href="subject.html#11717">[ subject ]</a>
              <a href="author.html#11717">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/x2go-commits">More information about the X2Go-commits
mailing list</a><br>
</body></html>
